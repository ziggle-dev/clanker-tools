
// Bundled tool: view-file
// Generated on 2025-07-25T13:57:56.199Z

var jf=Object.create;var io=Object.defineProperty;var Uf=Object.getOwnPropertyDescriptor;var Wf=Object.getOwnPropertyNames;var qf=Object.getPrototypeOf,zf=Object.prototype.hasOwnProperty;var x=(r,e)=>()=>(r&&(e=r(r=0)),e);var $i=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),hs=(r,e)=>{for(var t in e)io(r,t,{get:e[t],enumerable:!0})},oc=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Wf(e))!zf.call(r,s)&&s!==t&&io(r,s,{get:()=>e[s],enumerable:!(n=Uf(e,s))||n.enumerable});return r};var j=(r,e,t)=>(t=r!=null?jf(qf(r)):{},oc(e||!r||!r.__esModule?io(t,"default",{value:r,enumerable:!0}):t,r)),Hf=r=>oc(io({},"__esModule",{value:!0}),r);var ao=x(()=>{});function ic(r,e){let t=[];for(let s of r){let o=e[s.name];if(s.required&&o==null){t.push({field:s.name,message:`Required argument '${s.name}' is missing`,expected:s.type});continue}if(o==null)continue;let i=Vf(o,s.type,s.name);if(i){t.push(i);continue}if(s.enum&&!s.enum.includes(o)&&t.push({field:s.name,message:`Value must be one of: ${s.enum.join(", ")}`,expected:s.enum,received:o}),s.validate){let a=s.validate(o);typeof a=="string"?t.push({field:s.name,message:a,received:o}):a===!1&&t.push({field:s.name,message:`Validation failed for '${s.name}'`,received:o})}}let n=new Set(r.map(s=>s.name));for(let s of Object.keys(e))n.has(s)||t.push({field:s,message:`Unknown argument '${s}'`});return{valid:t.length===0,errors:t.length>0?t:void 0}}function Vf(r,e,t){let n=Gf(r);return e==="any"?null:n!==e?e==="number"&&n==="string"&&!isNaN(Number(r))?null:{field:t,message:`Expected ${e} but got ${n}`,expected:e,received:n}:null}function Gf(r){if(r==null)return"any";if(Array.isArray(r))return"array";let e=typeof r;switch(e){case"string":case"number":case"boolean":return e;case"object":return"object";default:return"any"}}var ac,lo=x(()=>{ac={minLength:r=>e=>e.length>=r||`Must be at least ${r} characters`,maxLength:r=>e=>e.length<=r||`Must be at most ${r} characters`,pattern:r=>e=>r.test(e)||"Does not match required pattern",email:()=>r=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)||"Must be a valid email address",url:()=>r=>{try{return new URL(r),!0}catch{return"Must be a valid URL"}},min:r=>e=>e>=r||`Must be at least ${r}`,max:r=>e=>e<=r||`Must be at most ${r}`,integer:()=>r=>Number.isInteger(r)||"Must be an integer",positive:()=>r=>r>0||"Must be positive",minItems:r=>e=>e.length>=r||`Must have at least ${r} items`,maxItems:r=>e=>e.length<=r||`Must have at most ${r} items`,unique:()=>r=>new Set(r).size===r.length||"Items must be unique",combine:(...r)=>e=>{for(let t of r){let n=t(e);if(n!==!0)return n}return!0}}});function lc(r,e,t){let n=e.map(l=>l.id),s=`${r}_${n.join("_")}`,o=`${r} composition of: ${n.join(", ")}`,i;switch(r){case"pipeline":i=Zf(e);break;case"parallel":i=Kf(e);break;case"conditional":i=Jf(e,t);break;case"map":i=Xf(e[0],t);break;case"reduce":i=Yf(e[0],t);break;default:throw new Error(`Unknown composition pattern: ${r}`)}return{id:s,name:s,description:o,category:"composition",composable:!0,pattern:r,tools:n,config:t,execute:i,capabilities:Array.from(new Set(e.flatMap(l=>l.capabilities||[])))}}function Zf(r){return async(e,t)=>{let n=e,s=null;for(let o of r){let i=await t.registry.execute(o.id,n);if(!i.success)return i;n=i.data||i.output||{},s=i}return s||{success:!0}}}function Kf(r){return async(e,t)=>{let n=r.map(i=>t.registry.execute(i.id,e)),s=await Promise.all(n),o=s.filter(i=>!i.success);return o.length>0?{success:!1,error:`${o.length} tools failed: ${o.map(i=>i.error).join(", ")}`}:{success:!0,data:s.map(i=>i.data||i.output)}}}function Jf(r,e){let{condition:t,branches:n}=e;return async(s,o)=>{let i;typeof t=="function"?i=await t(s,o):i=s[t]?"true":"false";let a=n[i];if(a===void 0||a>=r.length)return{success:!1,error:`No tool defined for branch: ${i}`};let l=r[a];return o.registry.execute(l.id,s)}}function Xf(r,e={}){let t=e.concurrency||1,n=e.continueOnError||!1;return async(s,o)=>{let{items:i,...a}=s;if(!Array.isArray(i))return{success:!1,error:'Map requires "items" array in arguments'};let l=[],u=[];if(t===1)for(let c of i){let f={...a,item:c},m=await o.registry.execute(r.id,f);if(m.success)l.push(m.data||m.output);else{if(!n)return m;u.push({item:c,error:m.error})}}else{let c=[];for(let f=0;f<i.length;f+=t)c.push(i.slice(f,f+t));for(let f of c){let m=f.map(v=>{let d={...a,item:v};return o.registry.execute(r.id,d)});(await Promise.all(m)).forEach((v,d)=>{if(v.success)l.push(v.data||v.output);else{if(!n)return v;u.push({item:f[d],error:v.error})}})}}return{success:u.length===0||n,data:l,error:u.length>0?`${u.length} items failed`:void 0}}}function Yf(r,e){let{reducer:t,initialValue:n}=e;return async(s,o)=>{let{items:i,...a}=s;if(!Array.isArray(i))return{success:!1,error:'Reduce requires "items" array in arguments'};let l=n;for(let u=0;u<i.length;u++){let c=i[u],f={...a,item:c,accumulator:l,index:u},m=await o.registry.execute(r.id,f);if(!m.success)return m;typeof t=="function"?l=await t(l,m.data||m.output,u):l=m.data||m.output}return{success:!0,data:l}}}var Ii=x(()=>{ao()});var qg,Qf,cc,uc,ep,dc,fc=x(()=>{qg=Symbol(),Qf=Symbol(),cc=Object.getPrototypeOf,uc=new WeakMap,ep=r=>r&&(uc.has(r)?uc.get(r):cc(r)===Object.prototype||cc(r)===Array.prototype),dc=r=>ep(r)&&r[Qf]||null});function Oi(r={}){if(!Ri(r))throw new Error("object required");let e=fo.get(r);if(e)return e;let t=co[0],n=new Set,s=(p,_=++co[0])=>{t!==_&&(t=_,n.forEach(g=>g(p,_)))},o=co[1],i=(p=++co[1])=>(o!==p&&!n.size&&(o=p,l.forEach(([_])=>{let g=_[1](p);g>t&&(t=g)})),t),a=p=>(_,g)=>{let y=[..._];y[1]=[p,...y[1]],s(y,g)},l=new Map,u=(p,_)=>{let g=!mc.has(_)&&Pi.get(_);if(g){if((uo.env?uo.env.MODE:void 0)!=="production"&&l.has(p))throw new Error("prop listener already exists");if(n.size){let y=g[2](a(p));l.set(p,[g,y])}else l.set(p,[g])}},c=p=>{var _;let g=l.get(p);g&&(l.delete(p),(_=g[1])==null||_.call(g))},f=p=>(n.add(p),n.size===1&&l.forEach(([g,y],b)=>{if((uo.env?uo.env.MODE:void 0)!=="production"&&y)throw new Error("remove already exists");let C=g[2](a(b));l.set(b,[g,C])}),()=>{n.delete(p),n.size===0&&l.forEach(([g,y],b)=>{y&&(y(),l.set(b,[g]))})}),m=!0,h=op(()=>m,u,c,s),v=np(r,h);fo.set(r,v);let d=[r,i,f];return Pi.set(v,d),Reflect.ownKeys(r).forEach(p=>{let _=Object.getOwnPropertyDescriptor(r,p);"value"in _&&_.writable&&(v[p]=r[p])}),m=!1,v}var uo,Ri,tp,rp,Pi,mc,co,fo,pc,np,sp,op,hc=x(()=>{fc();uo={},Ri=r=>typeof r=="object"&&r!==null,tp=r=>Ri(r)&&!mc.has(r)&&(Array.isArray(r)||!(Symbol.iterator in r))&&!(r instanceof WeakMap)&&!(r instanceof WeakSet)&&!(r instanceof Error)&&!(r instanceof Number)&&!(r instanceof Date)&&!(r instanceof String)&&!(r instanceof RegExp)&&!(r instanceof ArrayBuffer)&&!(r instanceof Promise),rp=(r,e,t,n)=>({deleteProperty(s,o){let i=Reflect.get(s,o);t(o);let a=Reflect.deleteProperty(s,o);return a&&n(["delete",[o],i]),a},set(s,o,i,a){let l=!r()&&Reflect.has(s,o),u=Reflect.get(s,o,a);if(l&&(pc(u,i)||fo.has(i)&&pc(u,fo.get(i))))return!0;t(o),Ri(i)&&(i=dc(i)||i);let c=!Pi.has(i)&&sp(i)?Oi(i):i;return e(o,c),Reflect.set(s,o,c,a),n(["set",[o],i,u]),!0}}),Pi=new WeakMap,mc=new WeakSet,co=[1,1],fo=new WeakMap,pc=Object.is,np=(r,e)=>new Proxy(r,e),sp=tp,op=rp});var mr,gc=x(()=>{mr=require("react")});var yc=x(()=>{hc();gc()});var po,D,hr=x(()=>{po=!1,D={log:(...r)=>{po&&console.log("[DEBUG]",...r)},error:(...r)=>{po&&console.error("[DEBUG ERROR]",...r)},warn:(...r)=>{po&&console.warn("[DEBUG WARN]",...r)},info:(...r)=>{po&&console.info("[DEBUG INFO]",...r)}}});var _c=x(()=>{});function N(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t}function w(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}var Ge=x(()=>{});var Fi,Mi=x(()=>{Fi=function(){let{crypto:r}=globalThis;if(r!=null&&r.randomUUID)return Fi=r.randomUUID.bind(r),r.randomUUID();let e=new Uint8Array(1),t=r?()=>r.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^t()&15>>+n/4).toString(16))}});function gs(r){return typeof r=="object"&&r!==null&&("name"in r&&r.name==="AbortError"||"message"in r&&String(r.message).includes("FetchRequestCanceledException"))}var ys,mo=x(()=>{ys=r=>{if(r instanceof Error)return r;if(typeof r=="object"&&r!==null){try{if(Object.prototype.toString.call(r)==="[object Error]"){let e=new Error(r.message,r.cause?{cause:r.cause}:{});return r.stack&&(e.stack=r.stack),r.cause&&!e.cause&&(e.cause=r.cause),r.name&&(e.name=r.name),e}}catch{}try{return new Error(JSON.stringify(r))}catch{}}return new Error(r)}});var F,he,de,qt,zt,ln,cn,un,dn,fn,pn,mn,hn,gn,yn,ut,dt=x(()=>{mo();F=class extends Error{},he=class r extends F{constructor(e,t,n,s){super(`${r.makeMessage(e,t,n)}`),this.status=e,this.headers=s,this.requestID=s==null?void 0:s.get("x-request-id"),this.error=t;let o=t;this.code=o==null?void 0:o.code,this.param=o==null?void 0:o.param,this.type=o==null?void 0:o.type}static makeMessage(e,t,n){let s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,n,s){if(!e||!s)return new qt({message:n,cause:ys(t)});let o=t==null?void 0:t.error;return e===400?new ln(e,o,n,s):e===401?new cn(e,o,n,s):e===403?new un(e,o,n,s):e===404?new dn(e,o,n,s):e===409?new fn(e,o,n,s):e===422?new pn(e,o,n,s):e===429?new mn(e,o,n,s):e>=500?new hn(e,o,n,s):new r(e,o,n,s)}},de=class extends he{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},qt=class extends he{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},zt=class extends qt{constructor({message:e}={}){super({message:e??"Request timed out."})}},ln=class extends he{},cn=class extends he{},un=class extends he{},dn=class extends he{},fn=class extends he{},pn=class extends he{},mn=class extends he{},hn=class extends he{},gn=class extends F{constructor(){super("Could not parse response content as the length limit was reached")}},yn=class extends F{constructor(){super("Could not parse response content as the request was rejected by the content filter")}},ut=class extends Error{constructor(e){super(e)}}});function xc(r){return typeof r!="object"?{}:r??{}}function wc(r){if(!r)return!0;for(let e in r)return!1;return!0}function vc(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function _s(r){return r!=null&&typeof r=="object"&&!Array.isArray(r)}var ap,bc,Ce,Li,Tc,kc,kt=x(()=>{dt();ap=/^[a-z][a-z0-9+.-]*:/i,bc=r=>ap.test(r),Ce=r=>(Ce=Array.isArray,Ce(r)),Li=Ce;Tc=(r,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new F(`${r} must be an integer`);if(e<0)throw new F(`${r} must be a positive integer`);return e},kc=r=>{try{return JSON.parse(r)}catch{return}}});var ft,_n=x(()=>{ft=r=>new Promise(e=>setTimeout(e,r))});var Ht,Di=x(()=>{Ht="5.10.2"});function lp(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}function up(){if(typeof navigator>"u"||!navigator)return null;let r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(let{key:e,pattern:t}of r){let n=t.exec(navigator.userAgent);if(n){let s=n[1]||0,o=n[2]||0,i=n[3]||0;return{browser:e,version:`${s}.${o}.${i}`}}}return null}var Ec,cp,Ac,Sc,Cc,$c,Ni=x(()=>{Di();Ec=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";cp=()=>{var t;let r=lp();if(r==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ht,"X-Stainless-OS":Sc(Deno.build.os),"X-Stainless-Arch":Ac(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ht,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(r==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ht,"X-Stainless-OS":Sc(globalThis.process.platform??"unknown"),"X-Stainless-Arch":Ac(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};let e=up();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ht,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ht,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};Ac=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",Sc=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown"),$c=()=>Cc??(Cc=cp())});function Ic(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Bi(...r){let e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...r)}function ho(r){let e=Symbol.asyncIterator in r?r[Symbol.asyncIterator]():r[Symbol.iterator]();return Bi({start(){},async pull(t){let{done:n,value:s}=await e.next();n?t.close():t.enqueue(s)},async cancel(){var t;await((t=e.return)==null?void 0:t.call(e))}})}function ji(r){if(r[Symbol.asyncIterator])return r;let e=r.getReader();return{async next(){try{let t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){let t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function Pc(r){var n,s;if(r===null||typeof r!="object")return;if(r[Symbol.asyncIterator]){await((s=(n=r[Symbol.asyncIterator]()).return)==null?void 0:s.call(n));return}let e=r.getReader(),t=e.cancel();e.releaseLock(),await t}var bs=x(()=>{});var Rc,Oc=x(()=>{Rc=({headers:r,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)})});var go,Ui,yo,Wi,_o=x(()=>{go="RFC3986",Ui=r=>String(r),yo={RFC1738:r=>String(r).replace(/%20/g,"+"),RFC3986:Ui},Wi="RFC1738"});function Mc(r){return!r||typeof r!="object"?!1:!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))}function zi(r,e){if(Ce(r)){let t=[];for(let n=0;n<r.length;n+=1)t.push(e(r[n]));return t}return e(r)}var bo,pt,qi,Fc,Lc=x(()=>{_o();kt();bo=(r,e)=>(bo=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),bo(r,e)),pt=(()=>{let r=[];for(let e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r})(),qi=1024,Fc=(r,e,t,n,s)=>{if(r.length===0)return r;let o=r;if(typeof r=="symbol"?o=Symbol.prototype.toString.call(r):typeof r!="string"&&(o=String(r)),t==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(a){return"%26%23"+parseInt(a.slice(2),16)+"%3B"});let i="";for(let a=0;a<o.length;a+=qi){let l=o.length>=qi?o.slice(a,a+qi):o,u=[];for(let c=0;c<l.length;++c){let f=l.charCodeAt(c);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||s===Wi&&(f===40||f===41)){u[u.length]=l.charAt(c);continue}if(f<128){u[u.length]=pt[f];continue}if(f<2048){u[u.length]=pt[192|f>>6]+pt[128|f&63];continue}if(f<55296||f>=57344){u[u.length]=pt[224|f>>12]+pt[128|f>>6&63]+pt[128|f&63];continue}c+=1,f=65536+((f&1023)<<10|l.charCodeAt(c)&1023),u[u.length]=pt[240|f>>18]+pt[128|f>>12&63]+pt[128|f>>6&63]+pt[128|f&63]}i+=u.join("")}return i}});function pp(r){return typeof r=="string"||typeof r=="number"||typeof r=="boolean"||typeof r=="symbol"||typeof r=="bigint"}function jc(r,e,t,n,s,o,i,a,l,u,c,f,m,h,v,d,p,_){let g=r,y=_,b=0,C=!1;for(;(y=y.get(Hi))!==void 0&&!C;){let ne=y.get(r);if(b+=1,typeof ne<"u"){if(ne===b)throw new RangeError("Cyclic object value");C=!0}typeof y.get(Hi)>"u"&&(b=0)}if(typeof u=="function"?g=u(e,g):g instanceof Date?g=m==null?void 0:m(g):t==="comma"&&Ce(g)&&(g=zi(g,function(ne){return ne instanceof Date?m==null?void 0:m(ne):ne})),g===null){if(o)return l&&!d?l(e,ge.encoder,p,"key",h):e;g=""}if(pp(g)||Mc(g)){if(l){let ne=d?e:l(e,ge.encoder,p,"key",h);return[(v==null?void 0:v(ne))+"="+(v==null?void 0:v(l(g,ge.encoder,p,"value",h)))]}return[(v==null?void 0:v(e))+"="+(v==null?void 0:v(String(g)))]}let E=[];if(typeof g>"u")return E;let I;if(t==="comma"&&Ce(g))d&&l&&(g=zi(g,l)),I=[{value:g.length>0?g.join(",")||null:void 0}];else if(Ce(u))I=u;else{let ne=Object.keys(g);I=c?ne.sort(c):ne}let K=a?String(e).replace(/\./g,"%2E"):String(e),G=n&&Ce(g)&&g.length===1?K+"[]":K;if(s&&Ce(g)&&g.length===0)return G+"[]";for(let ne=0;ne<I.length;++ne){let X=I[ne],Ut=typeof X=="object"&&typeof X.value<"u"?X.value:g[X];if(i&&Ut===null)continue;let ps=f&&a?X.replace(/\./g,"%2E"):X,to=Ce(g)?typeof t=="function"?t(G,ps):G:G+(f?"."+ps:"["+ps+"]");_.set(r,b);let me=new WeakMap;me.set(Hi,_),Bc(E,jc(Ut,to,t,n,s,o,i,a,t==="comma"&&d&&Ce(g)?null:l,u,c,f,m,h,v,d,p,me))}return E}function mp(r=ge){if(typeof r.allowEmptyArrays<"u"&&typeof r.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof r.encodeDotInKeys<"u"&&typeof r.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(r.encoder!==null&&typeof r.encoder<"u"&&typeof r.encoder!="function")throw new TypeError("Encoder has to be a function.");let e=r.charset||ge.charset;if(typeof r.charset<"u"&&r.charset!=="utf-8"&&r.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=go;if(typeof r.format<"u"){if(!bo(yo,r.format))throw new TypeError("Unknown format option provided.");t=r.format}let n=yo[t],s=ge.filter;(typeof r.filter=="function"||Ce(r.filter))&&(s=r.filter);let o;if(r.arrayFormat&&r.arrayFormat in Nc?o=r.arrayFormat:"indices"in r?o=r.indices?"indices":"repeat":o=ge.arrayFormat,"commaRoundTrip"in r&&typeof r.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");let i=typeof r.allowDots>"u"?r.encodeDotInKeys?!0:ge.allowDots:!!r.allowDots;return{addQueryPrefix:typeof r.addQueryPrefix=="boolean"?r.addQueryPrefix:ge.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof r.allowEmptyArrays=="boolean"?!!r.allowEmptyArrays:ge.allowEmptyArrays,arrayFormat:o,charset:e,charsetSentinel:typeof r.charsetSentinel=="boolean"?r.charsetSentinel:ge.charsetSentinel,commaRoundTrip:!!r.commaRoundTrip,delimiter:typeof r.delimiter>"u"?ge.delimiter:r.delimiter,encode:typeof r.encode=="boolean"?r.encode:ge.encode,encodeDotInKeys:typeof r.encodeDotInKeys=="boolean"?r.encodeDotInKeys:ge.encodeDotInKeys,encoder:typeof r.encoder=="function"?r.encoder:ge.encoder,encodeValuesOnly:typeof r.encodeValuesOnly=="boolean"?r.encodeValuesOnly:ge.encodeValuesOnly,filter:s,format:t,formatter:n,serializeDate:typeof r.serializeDate=="function"?r.serializeDate:ge.serializeDate,skipNulls:typeof r.skipNulls=="boolean"?r.skipNulls:ge.skipNulls,sort:typeof r.sort=="function"?r.sort:null,strictNullHandling:typeof r.strictNullHandling=="boolean"?r.strictNullHandling:ge.strictNullHandling}}function Vi(r,e={}){let t=r,n=mp(e),s,o;typeof n.filter=="function"?(o=n.filter,t=o("",t)):Ce(n.filter)&&(o=n.filter,s=o);let i=[];if(typeof t!="object"||t===null)return"";let a=Nc[n.arrayFormat],l=a==="comma"&&n.commaRoundTrip;s||(s=Object.keys(t)),n.sort&&s.sort(n.sort);let u=new WeakMap;for(let m=0;m<s.length;++m){let h=s[m];n.skipNulls&&t[h]===null||Bc(i,jc(t[h],h,a,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,u))}let c=i.join(n.delimiter),f=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),c.length>0?f+c:""}var Nc,Bc,Dc,ge,Hi,Uc=x(()=>{Lc();_o();kt();Nc={brackets(r){return String(r)+"[]"},comma:"comma",indices(r,e){return String(r)+"["+e+"]"},repeat(r){return String(r)}},Bc=function(r,e){Array.prototype.push.apply(r,Ce(e)?e:[e])},ge={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Fc,encodeValuesOnly:!1,format:go,formatter:Ui,indices:!1,serializeDate(r){return(Dc??(Dc=Function.prototype.call.bind(Date.prototype.toISOString)))(r)},skipNulls:!1,strictNullHandling:!1};Hi={}});var Wc=x(()=>{_o();Uc()});function Hc(r){let e=0;for(let s of r)e+=s.length;let t=new Uint8Array(e),n=0;for(let s of r)t.set(s,n),n+=s.length;return t}function bn(r){let e;return(qc??(e=new globalThis.TextEncoder,qc=e.encode.bind(e)))(r)}function Gi(r){let e;return(zc??(e=new globalThis.TextDecoder,zc=e.decode.bind(e)))(r)}var qc,zc,xo=x(()=>{});function gp(r,e){for(let s=e??0;s<r.length;s++){if(r[s]===10)return{preceding:s,index:s+1,carriage:!1};if(r[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function Vc(r){for(let n=0;n<r.length-1;n++){if(r[n]===10&&r[n+1]===10||r[n]===13&&r[n+1]===13)return n+2;if(r[n]===13&&r[n+1]===10&&n+3<r.length&&r[n+2]===13&&r[n+3]===10)return n+4}return-1}var Ue,We,gr,Gc=x(()=>{Ge();xo();gr=class{constructor(){Ue.set(this,void 0),We.set(this,void 0),N(this,Ue,new Uint8Array,"f"),N(this,We,null,"f")}decode(e){if(e==null)return[];let t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?bn(e):e;N(this,Ue,Hc([w(this,Ue,"f"),t]),"f");let n=[],s;for(;(s=gp(w(this,Ue,"f"),w(this,We,"f")))!=null;){if(s.carriage&&w(this,We,"f")==null){N(this,We,s.index,"f");continue}if(w(this,We,"f")!=null&&(s.index!==w(this,We,"f")+1||s.carriage)){n.push(Gi(w(this,Ue,"f").subarray(0,w(this,We,"f")-1))),N(this,Ue,w(this,Ue,"f").subarray(w(this,We,"f")),"f"),N(this,We,null,"f");continue}let o=w(this,We,"f")!==null?s.preceding-1:s.preceding,i=Gi(w(this,Ue,"f").subarray(0,o));n.push(i),N(this,Ue,w(this,Ue,"f").subarray(s.index),"f"),N(this,We,null,"f")}return n}flush(){return w(this,Ue,"f").length?this.decode(`
`):[]}};Ue=new WeakMap,We=new WeakMap;gr.NEWLINE_CHARS=new Set([`
`,"\r"]);gr.NEWLINE_REGEXP=/\r\n|[\n\r]/g});function xs(){}function wo(r,e,t){return!e||vo[r]>vo[t]?xs:e[r].bind(e)}function ce(r){let e=r.logger,t=r.logLevel??"off";if(!e)return yp;let n=Zc.get(e);if(n&&n[0]===t)return n[1];let s={error:wo("error",e,t),warn:wo("warn",e,t),info:wo("info",e,t),debug:wo("debug",e,t)};return Zc.set(e,[t,s]),s}var vo,Zi,yp,Zc,At,ws=x(()=>{kt();vo={off:0,error:200,warn:300,info:400,debug:500},Zi=(r,e,t)=>{if(r){if(vc(vo,r))return r;ce(t).warn(`${e} was set to ${JSON.stringify(r)}, expected one of ${JSON.stringify(Object.keys(vo))}`)}};yp={error:xs,warn:xs,info:xs,debug:xs},Zc=new WeakMap;At=r=>(r.options&&(r.options={...r.options},delete r.options.headers),r.headers&&(r.headers=Object.fromEntries((r.headers instanceof Headers?[...r.headers]:Object.entries(r.headers)).map(([e,t])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in r&&(r.retryOfRequestLogID&&(r.retryOf=r.retryOfRequestLogID),delete r.retryOfRequestLogID),r)});async function*_p(r,e){if(!r.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new F("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new F("Attempted to iterate over a response with no body");let t=new Ki,n=new gr,s=ji(r.body);for await(let o of bp(s))for(let i of n.decode(o)){let a=t.decode(i);a&&(yield a)}for(let o of n.flush()){let i=t.decode(o);i&&(yield i)}}async function*bp(r){let e=new Uint8Array;for await(let t of r){if(t==null)continue;let n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?bn(t):t,s=new Uint8Array(e.length+n.length);s.set(e),s.set(n,e.length),e=s;let o;for(;(o=Vc(e))!==-1;)yield e.slice(0,o),e=e.slice(o)}e.length>0&&(yield e)}function xp(r,e){let t=r.indexOf(e);return t!==-1?[r.substring(0,t),e,r.substring(t+e.length)]:[r,"",""]}var vs,mt,Ki,Ji=x(()=>{Ge();dt();bs();Gc();bs();mo();xo();ws();dt();mt=class r{constructor(e,t,n){this.iterator=e,vs.set(this,void 0),this.controller=t,N(this,vs,n,"f")}static fromSSEResponse(e,t,n){let s=!1,o=n?ce(n):console;async function*i(){if(s)throw new F("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(let l of _p(e,t))if(!a){if(l.data.startsWith("[DONE]")){a=!0;continue}if(l.event===null||l.event.startsWith("response.")||l.event.startsWith("image_edit.")||l.event.startsWith("image_generation.")||l.event.startsWith("transcript.")){let u;try{u=JSON.parse(l.data)}catch(c){throw o.error("Could not parse message into JSON:",l.data),o.error("From chunk:",l.raw),c}if(u&&u.error)throw new he(void 0,u.error,void 0,e.headers);yield u}else{let u;try{u=JSON.parse(l.data)}catch(c){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),c}if(l.event=="error")throw new he(void 0,u.error,u.message,void 0);yield{event:l.event,data:u}}}a=!0}catch(l){if(gs(l))return;throw l}finally{a||t.abort()}}return new r(i,t,n)}static fromReadableStream(e,t,n){let s=!1;async function*o(){let a=new gr,l=ji(e);for await(let u of l)for(let c of a.decode(u))yield c;for(let u of a.flush())yield u}async function*i(){if(s)throw new F("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(let l of o())a||l&&(yield JSON.parse(l));a=!0}catch(l){if(gs(l))return;throw l}finally{a||t.abort()}}return new r(i,t,n)}[(vs=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){let e=[],t=[],n=this.iterator(),s=o=>({next:()=>{if(o.length===0){let i=n.next();e.push(i),t.push(i)}return o.shift()}});return[new r(()=>s(e),this.controller,w(this,vs,"f")),new r(()=>s(t),this.controller,w(this,vs,"f"))]}toReadableStream(){let e=this,t;return Bi({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{let{value:s,done:o}=await t.next();if(o)return n.close();let i=bn(JSON.stringify(s)+`
`);n.enqueue(i)}catch(s){n.error(s)}},async cancel(){var n;await((n=t.return)==null?void 0:n.call(t))}})}};Ki=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,s]=xp(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}});async function To(r,e){let{response:t,requestLogID:n,retryOfRequestLogID:s,startTime:o}=e,i=await(async()=>{var f;if(e.options.stream)return ce(r).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,r):mt.fromSSEResponse(t,e.controller,r);if(t.status===204)return null;if(e.options.__binaryResponse)return t;let a=t.headers.get("content-type"),l=(f=a==null?void 0:a.split(";")[0])==null?void 0:f.trim();if((l==null?void 0:l.includes("application/json"))||(l==null?void 0:l.endsWith("+json"))){let m=await t.json();return Xi(m,t)}return await t.text()})();return ce(r).debug(`[${n}] response parsed`,At({retryOfRequestLogID:s,url:t.url,status:t.status,body:i,durationMs:Date.now()-o})),i}function Xi(r,e){return!r||typeof r!="object"||Array.isArray(r)?r:Object.defineProperty(r,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var Yi=x(()=>{Ji();ws()});var Ts,yr,ko=x(()=>{Ge();Yi();yr=class r extends Promise{constructor(e,t,n=To){super(s=>{s(null)}),this.responsePromise=t,this.parseResponse=n,Ts.set(this,void 0),N(this,Ts,e,"f")}_thenUnwrap(e){return new r(w(this,Ts,"f"),this.responsePromise,async(t,n)=>Xi(e(await this.parseResponse(t,n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(w(this,Ts,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}};Ts=new WeakMap});var Ao,So,ks,ht,H,se=x(()=>{Ge();dt();Yi();ko();kt();So=class{constructor(e,t,n,s){Ao.set(this,void 0),N(this,Ao,e,"f"),this.options=s,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){let e=this.nextPageRequestOptions();if(!e)throw new F("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await w(this,Ao,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Ao=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}},ks=class extends yr{constructor(e,t,n){super(e,t,async(s,o)=>new n(s,o.response,await To(s,o),o.options))}async*[Symbol.asyncIterator](){let e=await this;for await(let t of e)yield t}},ht=class extends So{constructor(e,t,n,s){super(e,t,n,s),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}},H=class extends So{constructor(e,t,n,s){super(e,t,n,s),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var n;let e=this.getPaginatedItems(),t=(n=e[e.length-1])==null?void 0:n.id;return t?{...this.options,query:{...xc(this.options.query),after:t}}:null}}});function xn(r,e,t){return ea(),new File(r,e??"unknown_file",t)}function As(r){return(typeof r=="object"&&r!==null&&("name"in r&&r.name&&String(r.name)||"url"in r&&r.url&&String(r.url)||"filename"in r&&r.filename&&String(r.filename)||"path"in r&&r.path&&String(r.path))||"").split(/[\\/]/).pop()||void 0}function vp(r){let e=typeof r=="function"?r:r.fetch,t=Kc.get(e);if(t)return t;let n=(async()=>{try{let s="Response"in e?e.Response:(await e("data:,")).constructor,o=new FormData;return o.toString()!==await new s(o).text()}catch{return!0}})();return Kc.set(e,n),n}var ea,ta,qe,Kc,Tp,kp,Qi,St=x(()=>{bs();ea=()=>{var r;if(typeof File>"u"){let{process:e}=globalThis,t=typeof((r=e==null?void 0:e.versions)==null?void 0:r.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};ta=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function",qe=async(r,e)=>({...r,body:await Tp(r.body,e)}),Kc=new WeakMap;Tp=async(r,e)=>{if(!await vp(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let t=new FormData;return await Promise.all(Object.entries(r||{}).map(([n,s])=>Qi(t,n,s))),t},kp=r=>r instanceof Blob&&"name"in r,Qi=async(r,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")r.append(e,String(t));else if(t instanceof Response)r.append(e,xn([await t.blob()],As(t)));else if(ta(t))r.append(e,xn([await new Response(ho(t)).blob()],As(t)));else if(kp(t))r.append(e,t,As(t));else if(Array.isArray(t))await Promise.all(t.map(n=>Qi(r,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,s])=>Qi(r,`${e}[${n}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}}});async function Co(r,e,t){if(ea(),r=await r,Ap(r))return r instanceof File?r:xn([await r.arrayBuffer()],r.name);if(Sp(r)){let s=await r.blob();return e||(e=new URL(r.url).pathname.split(/[\\/]/).pop()),xn(await ra(s),e,t)}let n=await ra(r);if(e||(e=As(r)),!(t!=null&&t.type)){let s=n.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof s=="string"&&(t={...t,type:s})}return xn(n,e,t)}async function ra(r){var t;let e=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)e.push(r);else if(Jc(r))e.push(r instanceof Blob?r:await r.arrayBuffer());else if(ta(r))for await(let n of r)e.push(...await ra(n));else{let n=(t=r==null?void 0:r.constructor)==null?void 0:t.name;throw new Error(`Unexpected data type: ${typeof r}${n?`; constructor: ${n}`:""}${Cp(r)}`)}return e}function Cp(r){return typeof r!="object"||r===null?"":`; props: [${Object.getOwnPropertyNames(r).map(t=>`"${t}"`).join(", ")}]`}var Jc,Ap,Sp,Xc=x(()=>{St();St();Jc=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function",Ap=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&Jc(r),Sp=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function"});var na=x(()=>{Xc()});var S,W=x(()=>{S=class{constructor(e){this._client=e}}});function Qc(r){return r.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}var Yc,$p,k,te=x(()=>{dt();Yc=Object.freeze(Object.create(null)),$p=(r=Qc)=>function(t,...n){if(t.length===1)return t[0];let s=!1,o=[],i=t.reduce((c,f,m)=>{var d;/[?#]/.test(f)&&(s=!0);let h=n[m],v=(s?encodeURIComponent:r)(""+h);return m!==n.length&&(h==null||typeof h=="object"&&h.toString===((d=Object.getPrototypeOf(Object.getPrototypeOf(h.hasOwnProperty??Yc)??Yc))==null?void 0:d.toString))&&(v=h+"",o.push({start:c.length+f.length,length:v.length,error:`Value of type ${Object.prototype.toString.call(h).slice(8,-1)} is not a valid path parameter`})),c+f+(m===n.length?"":v)},""),a=i.split(/[?#]/,1)[0],l=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi,u;for(;(u=l.exec(a))!==null;)o.push({start:u.index,length:u[0].length,error:`Value "${u[0]}" can't be safely passed as a path parameter`});if(o.sort((c,f)=>c.start-f.start),o.length>0){let c=0,f=o.reduce((m,h)=>{let v=" ".repeat(h.start-c),d="^".repeat(h.length);return c=h.start+h.length,m+v+d},"");throw new F(`Path parameters result in path with invalid segments:
${o.map(m=>m.error).join(`
`)}
${i}
${f}`)}return i},k=$p(Qc)});var _r,Eo=x(()=>{W();se();te();_r=class extends S{list(e,t={},n){return this._client.getAPIList(k`/chat/completions/${e}/messages`,H,{query:t,...n})}}});var tt=x(()=>{dt()});function eu(r){return typeof r.parse=="function"}var sa=x(()=>{});var wn,oa,ia=x(()=>{wn=r=>(r==null?void 0:r.role)==="assistant",oa=r=>(r==null?void 0:r.role)==="tool"});var aa,$o,Io,Ss,Cs,Po,Es,Ct,$s,Ro,Oo,vn,tu,Vt,Fo=x(()=>{Ge();tt();Vt=class{constructor(){aa.add(this),this.controller=new AbortController,$o.set(this,void 0),Io.set(this,()=>{}),Ss.set(this,()=>{}),Cs.set(this,void 0),Po.set(this,()=>{}),Es.set(this,()=>{}),Ct.set(this,{}),$s.set(this,!1),Ro.set(this,!1),Oo.set(this,!1),vn.set(this,!1),N(this,$o,new Promise((e,t)=>{N(this,Io,e,"f"),N(this,Ss,t,"f")}),"f"),N(this,Cs,new Promise((e,t)=>{N(this,Po,e,"f"),N(this,Es,t,"f")}),"f"),w(this,$o,"f").catch(()=>{}),w(this,Cs,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},w(this,aa,"m",tu).bind(this))},0)}_connected(){this.ended||(w(this,Io,"f").call(this),this._emit("connect"))}get ended(){return w(this,$s,"f")}get errored(){return w(this,Ro,"f")}get aborted(){return w(this,Oo,"f")}abort(){this.controller.abort()}on(e,t){return(w(this,Ct,"f")[e]||(w(this,Ct,"f")[e]=[])).push({listener:t}),this}off(e,t){let n=w(this,Ct,"f")[e];if(!n)return this;let s=n.findIndex(o=>o.listener===t);return s>=0&&n.splice(s,1),this}once(e,t){return(w(this,Ct,"f")[e]||(w(this,Ct,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{N(this,vn,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){N(this,vn,!0,"f"),await w(this,Cs,"f")}_emit(e,...t){if(w(this,$s,"f"))return;e==="end"&&(N(this,$s,!0,"f"),w(this,Po,"f").call(this));let n=w(this,Ct,"f")[e];if(n&&(w(this,Ct,"f")[e]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...t))),e==="abort"){let s=t[0];!w(this,vn,"f")&&!(n!=null&&n.length)&&Promise.reject(s),w(this,Ss,"f").call(this,s),w(this,Es,"f").call(this,s),this._emit("end");return}if(e==="error"){let s=t[0];!w(this,vn,"f")&&!(n!=null&&n.length)&&Promise.reject(s),w(this,Ss,"f").call(this,s),w(this,Es,"f").call(this,s),this._emit("end")}}_emitFinal(){}};$o=new WeakMap,Io=new WeakMap,Ss=new WeakMap,Cs=new WeakMap,Po=new WeakMap,Es=new WeakMap,Ct=new WeakMap,$s=new WeakMap,Ro=new WeakMap,Oo=new WeakMap,vn=new WeakMap,aa=new WeakSet,tu=function(e){if(N(this,Ro,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new de),e instanceof de)return N(this,Oo,!0,"f"),this._emit("abort",e);if(e instanceof F)return this._emit("error",e);if(e instanceof Error){let t=new F(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new F(String(e)))}});function Is(r){return(r==null?void 0:r.$brand)==="auto-parseable-response-format"}function br(r){return(r==null?void 0:r.$brand)==="auto-parseable-tool"}function ru(r,e){return!e||!la(e)?{...r,choices:r.choices.map(t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:Ps(r,e)}function Ps(r,e){let t=r.choices.map(n=>{var s;if(n.finish_reason==="length")throw new gn;if(n.finish_reason==="content_filter")throw new yn;return{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:((s=n.message.tool_calls)==null?void 0:s.map(o=>Op(e,o)))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?Rp(e,n.message.content):null}}});return{...r,choices:t}}function Rp(r,e){var t,n;return((t=r.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=r.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in r.response_format?r.response_format.$parseRaw(e):JSON.parse(e):null}function Op(r,e){var n;let t=(n=r.tools)==null?void 0:n.find(s=>{var o;return((o=s.function)==null?void 0:o.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:br(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function nu(r,e){var n;if(!r)return!1;let t=(n=r.tools)==null?void 0:n.find(s=>{var o;return((o=s.function)==null?void 0:o.name)===e.function.name});return br(t)||(t==null?void 0:t.function.strict)||!1}function la(r){var e;return Is(r.response_format)?!0:((e=r.tools)==null?void 0:e.some(t=>br(t)||t.type==="function"&&t.function.strict===!0))??!1}function su(r){for(let e of r??[]){if(e.type!=="function")throw new F(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new F(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Rs=x(()=>{tt()});var Re,ca,Mo,ua,da,fa,ou,iu,Fp,Tn,pa=x(()=>{Ge();tt();sa();ia();Fo();Rs();Fp=10,Tn=class extends Vt{constructor(){super(...arguments),Re.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);let t=(n=e.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),oa(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(wn(e)&&e.tool_calls)for(let n of e.tool_calls)n.type==="function"&&this._emit("functionToolCall",n.function)}}async finalChatCompletion(){await this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new F("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),w(this,Re,"m",ca).call(this)}async finalMessage(){return await this.done(),w(this,Re,"m",Mo).call(this)}async finalFunctionToolCall(){return await this.done(),w(this,Re,"m",ua).call(this)}async finalFunctionToolCallResult(){return await this.done(),w(this,Re,"m",da).call(this)}async totalUsage(){return await this.done(),w(this,Re,"m",fa).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let t=w(this,Re,"m",Mo).call(this);t&&this._emit("finalMessage",t);let n=w(this,Re,"m",ca).call(this);n&&this._emit("finalContent",n);let s=w(this,Re,"m",ua).call(this);s&&this._emit("finalFunctionToolCall",s);let o=w(this,Re,"m",da).call(this);o!=null&&this._emit("finalFunctionToolCallResult",o),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",w(this,Re,"m",fa).call(this))}async _createChatCompletion(e,t,n){let s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),w(this,Re,"m",ou).call(this,t);let o=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Ps(o,t))}async _runChatCompletion(e,t,n){for(let s of t.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,t,n)}async _runTools(e,t,n){var h,v,d;let s="tool",{tool_choice:o="auto",stream:i,...a}=t,l=typeof o!="string"&&((h=o==null?void 0:o.function)==null?void 0:h.name),{maxChatCompletions:u=Fp}=n||{},c=t.tools.map(p=>{if(br(p)){if(!p.$callback)throw new F("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:p.$callback,name:p.function.name,description:p.function.description||"",parameters:p.function.parameters,parse:p.$parseRaw,strict:!0}}}return p}),f={};for(let p of c)p.type==="function"&&(f[p.function.name||p.function.function.name]=p.function);let m="tools"in t?c.map(p=>p.type==="function"?{type:"function",function:{name:p.function.name||p.function.function.name,parameters:p.function.parameters,description:p.function.description,strict:p.function.strict}}:p):void 0;for(let p of t.messages)this._addMessage(p,!1);for(let p=0;p<u;++p){let g=(v=(await this._createChatCompletion(e,{...a,tool_choice:o,tools:m,messages:[...this.messages]},n)).choices[0])==null?void 0:v.message;if(!g)throw new F("missing message in ChatCompletion response");if(!((d=g.tool_calls)!=null&&d.length))return;for(let y of g.tool_calls){if(y.type!=="function")continue;let b=y.id,{name:C,arguments:E}=y.function,I=f[C];if(I){if(l&&l!==C){let X=`Invalid tool_call: ${JSON.stringify(C)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,tool_call_id:b,content:X});continue}}else{let X=`Invalid tool_call: ${JSON.stringify(C)}. Available options are: ${Object.keys(f).map(Ut=>JSON.stringify(Ut)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:b,content:X});continue}let K;try{K=eu(I)?await I.parse(E):E}catch(X){let Ut=X instanceof Error?X.message:String(X);this._addMessage({role:s,tool_call_id:b,content:Ut});continue}let G=await I.function(K,this),ne=w(this,Re,"m",iu).call(this,G);if(this._addMessage({role:s,tool_call_id:b,content:ne}),l)return}}}};Re=new WeakSet,ca=function(){return w(this,Re,"m",Mo).call(this).content??null},Mo=function(){let e=this.messages.length;for(;e-- >0;){let t=this.messages[e];if(wn(t))return{...t,content:t.content??null,refusal:t.refusal??null}}throw new F("stream ended without producing a ChatCompletionMessage with role=assistant")},ua=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){let s=this.messages[n];if(wn(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(t=s.tool_calls.at(-1))==null?void 0:t.function}},da=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(oa(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var s;return n.role==="assistant"&&((s=n.tool_calls)==null?void 0:s.some(o=>o.type==="function"&&o.id===t.tool_call_id))}))return t.content}},fa=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},ou=function(e){if(e.n!=null&&e.n>1)throw new F("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},iu=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)}});var Os,ma=x(()=>{pa();ia();Os=class r extends Tn{static runTools(e,t,n){let s=new r,o={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,o)),s}_addMessage(e,t=!0){super._addMessage(e,t),wn(e)&&e.content&&this._emit("content",e.content)}}});var ha=x(()=>{Ji()});function Mp(r,e=ve.ALL){if(typeof r!="string")throw new TypeError(`expecting str, got ${typeof r}`);if(!r.trim())throw new Error(`${r} is empty`);return Lp(r.trim(),e)}var ve,ga,ya,Lp,_a,au=x(()=>{ve={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,INF:384,SPECIAL:496,ATOM:499,COLLECTION:12,ALL:511},ga=class extends Error{},ya=class extends Error{};Lp=(r,e)=>{let t=r.length,n=0,s=m=>{throw new ga(`${m} at position ${n}`)},o=m=>{throw new ya(`${m} at position ${n}`)},i=()=>(f(),n>=t&&s("Unexpected end of input"),r[n]==='"'?a():r[n]==="{"?l():r[n]==="["?u():r.substring(n,n+4)==="null"||ve.NULL&e&&t-n<4&&"null".startsWith(r.substring(n))?(n+=4,null):r.substring(n,n+4)==="true"||ve.BOOL&e&&t-n<4&&"true".startsWith(r.substring(n))?(n+=4,!0):r.substring(n,n+5)==="false"||ve.BOOL&e&&t-n<5&&"false".startsWith(r.substring(n))?(n+=5,!1):r.substring(n,n+8)==="Infinity"||ve.INFINITY&e&&t-n<8&&"Infinity".startsWith(r.substring(n))?(n+=8,1/0):r.substring(n,n+9)==="-Infinity"||ve.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(r.substring(n))?(n+=9,-1/0):r.substring(n,n+3)==="NaN"||ve.NAN&e&&t-n<3&&"NaN".startsWith(r.substring(n))?(n+=3,NaN):c()),a=()=>{let m=n,h=!1;for(n++;n<t&&(r[n]!=='"'||h&&r[n-1]==="\\");)h=r[n]==="\\"?!h:!1,n++;if(r.charAt(n)=='"')try{return JSON.parse(r.substring(m,++n-Number(h)))}catch(v){o(String(v))}else if(ve.STR&e)try{return JSON.parse(r.substring(m,n-Number(h))+'"')}catch{return JSON.parse(r.substring(m,r.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},l=()=>{n++,f();let m={};try{for(;r[n]!=="}";){if(f(),n>=t&&ve.OBJ&e)return m;let h=a();f(),n++;try{let v=i();Object.defineProperty(m,h,{value:v,writable:!0,enumerable:!0,configurable:!0})}catch(v){if(ve.OBJ&e)return m;throw v}f(),r[n]===","&&n++}}catch{if(ve.OBJ&e)return m;s("Expected '}' at end of object")}return n++,m},u=()=>{n++;let m=[];try{for(;r[n]!=="]";)m.push(i()),f(),r[n]===","&&n++}catch{if(ve.ARR&e)return m;s("Expected ']' at end of array")}return n++,m},c=()=>{if(n===0){r==="-"&&ve.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(r)}catch(h){if(ve.NUM&e)try{return r[r.length-1]==="."?JSON.parse(r.substring(0,r.lastIndexOf("."))):JSON.parse(r.substring(0,r.lastIndexOf("e")))}catch{}o(String(h))}}let m=n;for(r[n]==="-"&&n++;r[n]&&!",]}".includes(r[n]);)n++;n==t&&!(ve.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(r.substring(m,n))}catch{r.substring(m,n)==="-"&&ve.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(r.substring(m,r.lastIndexOf("e")))}catch(v){o(String(v))}}},f=()=>{for(;n<t&&` 
\r	`.includes(r[n]);)n++};return i()},_a=r=>Mp(r,ve.ALL^ve.NUM)});function Dp(r,e){let{id:t,choices:n,created:s,model:o,system_fingerprint:i,...a}=r,l={...a,id:t,choices:n.map(({message:u,finish_reason:c,index:f,logprobs:m,...h})=>{if(!c)throw new F(`missing finish_reason for choice ${f}`);let{content:v=null,function_call:d,tool_calls:p,..._}=u,g=u.role;if(!g)throw new F(`missing role for choice ${f}`);if(d){let{arguments:y,name:b}=d;if(y==null)throw new F(`missing function_call.arguments for choice ${f}`);if(!b)throw new F(`missing function_call.name for choice ${f}`);return{...h,message:{content:v,function_call:{arguments:y,name:b},role:g,refusal:u.refusal??null},finish_reason:c,index:f,logprobs:m}}return p?{...h,index:f,finish_reason:c,logprobs:m,message:{..._,role:g,content:v,refusal:u.refusal??null,tool_calls:p.map((y,b)=>{let{function:C,type:E,id:I,...K}=y,{arguments:G,name:ne,...X}=C||{};if(I==null)throw new F(`missing choices[${f}].tool_calls[${b}].id
${No(r)}`);if(E==null)throw new F(`missing choices[${f}].tool_calls[${b}].type
${No(r)}`);if(ne==null)throw new F(`missing choices[${f}].tool_calls[${b}].function.name
${No(r)}`);if(G==null)throw new F(`missing choices[${f}].tool_calls[${b}].function.arguments
${No(r)}`);return{...K,id:I,type:E,function:{...X,name:ne,arguments:G}}})}}:{...h,message:{..._,content:v,role:g,refusal:u.refusal??null},finish_reason:c,index:f,logprobs:m}}),created:s,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return ru(l,e)}function No(r){return JSON.stringify(r)}var ye,Et,kn,Gt,ba,Lo,xa,wa,va,Do,Ta,lu,xr,Bo=x(()=>{Ge();tt();pa();ha();Rs();au();xr=class r extends Tn{constructor(e){super(),ye.add(this),Et.set(this,void 0),kn.set(this,void 0),Gt.set(this,void 0),N(this,Et,e,"f"),N(this,kn,[],"f")}get currentChatCompletionSnapshot(){return w(this,Gt,"f")}static fromReadableStream(e){let t=new r(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){let s=new r(t);return s._run(()=>s._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,t,n){var i;super._createChatCompletion;let s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),w(this,ye,"m",ba).call(this);let o=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(let a of o)w(this,ye,"m",xa).call(this,a);if((i=o.controller.signal)!=null&&i.aborted)throw new de;return this._addChatCompletion(w(this,ye,"m",Do).call(this))}async _fromReadableStream(e,t){var i;let n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),w(this,ye,"m",ba).call(this),this._connected();let s=mt.fromReadableStream(e,this.controller),o;for await(let a of s)o&&o!==a.id&&this._addChatCompletion(w(this,ye,"m",Do).call(this)),w(this,ye,"m",xa).call(this,a),o=a.id;if((i=s.controller.signal)!=null&&i.aborted)throw new de;return this._addChatCompletion(w(this,ye,"m",Do).call(this))}[(Et=new WeakMap,kn=new WeakMap,Gt=new WeakMap,ye=new WeakSet,ba=function(){this.ended||N(this,Gt,void 0,"f")},Lo=function(t){let n=w(this,kn,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},w(this,kn,"f")[t.index]=n,n)},xa=function(t){var s,o,i,a,l,u,c,f,m,h,v,d,p,_,g;if(this.ended)return;let n=w(this,ye,"m",lu).call(this,t);this._emit("chunk",t,n);for(let y of t.choices){let b=n.choices[y.index];y.delta.content!=null&&((s=b.message)==null?void 0:s.role)==="assistant"&&((o=b.message)!=null&&o.content)&&(this._emit("content",y.delta.content,b.message.content),this._emit("content.delta",{delta:y.delta.content,snapshot:b.message.content,parsed:b.message.parsed})),y.delta.refusal!=null&&((i=b.message)==null?void 0:i.role)==="assistant"&&((a=b.message)!=null&&a.refusal)&&this._emit("refusal.delta",{delta:y.delta.refusal,snapshot:b.message.refusal}),((l=y.logprobs)==null?void 0:l.content)!=null&&((u=b.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(c=y.logprobs)==null?void 0:c.content,snapshot:((f=b.logprobs)==null?void 0:f.content)??[]}),((m=y.logprobs)==null?void 0:m.refusal)!=null&&((h=b.message)==null?void 0:h.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(v=y.logprobs)==null?void 0:v.refusal,snapshot:((d=b.logprobs)==null?void 0:d.refusal)??[]});let C=w(this,ye,"m",Lo).call(this,b);b.finish_reason&&(w(this,ye,"m",va).call(this,b),C.current_tool_call_index!=null&&w(this,ye,"m",wa).call(this,b,C.current_tool_call_index));for(let E of y.delta.tool_calls??[])C.current_tool_call_index!==E.index&&(w(this,ye,"m",va).call(this,b),C.current_tool_call_index!=null&&w(this,ye,"m",wa).call(this,b,C.current_tool_call_index)),C.current_tool_call_index=E.index;for(let E of y.delta.tool_calls??[]){let I=(p=b.message.tool_calls)==null?void 0:p[E.index];I!=null&&I.type&&((I==null?void 0:I.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(_=I.function)==null?void 0:_.name,index:E.index,arguments:I.function.arguments,parsed_arguments:I.function.parsed_arguments,arguments_delta:((g=E.function)==null?void 0:g.arguments)??""}):(I==null||I.type,void 0))}}},wa=function(t,n){var i,a,l;if(w(this,ye,"m",Lo).call(this,t).done_tool_calls.has(n))return;let o=(i=t.message.tool_calls)==null?void 0:i[n];if(!o)throw new Error("no tool call snapshot");if(!o.type)throw new Error("tool call snapshot missing `type`");if(o.type==="function"){let u=(l=(a=w(this,Et,"f"))==null?void 0:a.tools)==null?void 0:l.find(c=>c.type==="function"&&c.function.name===o.function.name);this._emit("tool_calls.function.arguments.done",{name:o.function.name,index:n,arguments:o.function.arguments,parsed_arguments:br(u)?u.$parseRaw(o.function.arguments):u!=null&&u.function.strict?JSON.parse(o.function.arguments):null})}else o.type},va=function(t){var s,o;let n=w(this,ye,"m",Lo).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;let i=w(this,ye,"m",Ta).call(this);this._emit("content.done",{content:t.message.content,parsed:i?i.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(s=t.logprobs)!=null&&s.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(o=t.logprobs)!=null&&o.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Do=function(){if(this.ended)throw new F("stream has ended, this shouldn't happen");let t=w(this,Gt,"f");if(!t)throw new F("request ended without sending any chunks");return N(this,Gt,void 0,"f"),N(this,kn,[],"f"),Dp(t,w(this,Et,"f"))},Ta=function(){var n;let t=(n=w(this,Et,"f"))==null?void 0:n.response_format;return Is(t)?t:null},lu=function(t){var n,s,o,i;let a=w(this,Gt,"f"),{choices:l,...u}=t;a?Object.assign(a,u):a=N(this,Gt,{...u,choices:[]},"f");for(let{delta:c,finish_reason:f,index:m,logprobs:h=null,...v}of t.choices){let d=a.choices[m];if(d||(d=a.choices[m]={finish_reason:f,index:m,message:{},logprobs:h,...v}),h)if(!d.logprobs)d.logprobs=Object.assign({},h);else{let{content:E,refusal:I,...K}=h;Object.assign(d.logprobs,K),E&&((n=d.logprobs).content??(n.content=[]),d.logprobs.content.push(...E)),I&&((s=d.logprobs).refusal??(s.refusal=[]),d.logprobs.refusal.push(...I))}if(f&&(d.finish_reason=f,w(this,Et,"f")&&la(w(this,Et,"f")))){if(f==="length")throw new gn;if(f==="content_filter")throw new yn}if(Object.assign(d,v),!c)continue;let{content:p,refusal:_,function_call:g,role:y,tool_calls:b,...C}=c;if(Object.assign(d.message,C),_&&(d.message.refusal=(d.message.refusal||"")+_),y&&(d.message.role=y),g&&(d.message.function_call?(g.name&&(d.message.function_call.name=g.name),g.arguments&&((o=d.message.function_call).arguments??(o.arguments=""),d.message.function_call.arguments+=g.arguments)):d.message.function_call=g),p&&(d.message.content=(d.message.content||"")+p,!d.message.refusal&&w(this,ye,"m",Ta).call(this)&&(d.message.parsed=_a(d.message.content))),b){d.message.tool_calls||(d.message.tool_calls=[]);for(let{index:E,id:I,type:K,function:G,...ne}of b){let X=(i=d.message.tool_calls)[E]??(i[E]={});Object.assign(X,ne),I&&(X.id=I),K&&(X.type=K),G&&(X.function??(X.function={name:G.name??"",arguments:""})),G!=null&&G.name&&(X.function.name=G.name),G!=null&&G.arguments&&(X.function.arguments+=G.arguments,nu(w(this,Et,"f"),X)&&(X.function.parsed_arguments=_a(X.function.arguments)))}}}return a},Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("chunk",s=>{let o=t.shift();o?o.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(let s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{n=!0;for(let o of t)o.reject(s);t.length=0}),this.on("error",s=>{n=!0;for(let o of t)o.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((o,i)=>t.push({resolve:o,reject:i})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new mt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}});var Fs,ka=x(()=>{Bo();Fs=class r extends xr{static fromReadableStream(e){let t=new r(null);return t._run(()=>t._fromReadableStream(e)),t}static runTools(e,t,n){let s=new r(t),o={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,o)),s}}});var $t,Ms=x(()=>{W();Eo();Eo();se();te();ma();ka();Bo();Rs();ka();sa();Bo();ma();$t=class extends S{constructor(){super(...arguments),this.messages=new _r(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(k`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(k`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return this._client.getAPIList("/chat/completions",H,{query:e,...t})}delete(e,t){return this._client.delete(k`/chat/completions/${e}`,t)}parse(e,t){return su(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(n=>Ps(n,e))}runTools(e,t){return e.stream?Fs.runTools(this._client,e,t):Os.runTools(this._client,e,t)}stream(e,t){return xr.createChatCompletion(this._client,e,t)}};$t.Messages=_r});var Zt,Aa=x(()=>{W();Ms();Ms();Zt=class extends S{constructor(){super(...arguments),this.completions=new $t(this._client)}};Zt.Completions=$t});var cu=x(()=>{Ms();Ms();Eo()});var uu=x(()=>{Aa();cu()});var du=x(()=>{});function*Bp(r){if(!r)return;if(fu in r){let{values:n,nulls:s}=r;yield*n.entries();for(let o of s)yield[o,null];return}let e=!1,t;r instanceof Headers?t=r.entries():Li(r)?t=r:(e=!0,t=Object.entries(r??{}));for(let n of t){let s=n[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");let o=Li(n[1])?n[1]:[n[1]],i=!1;for(let a of o)a!==void 0&&(e&&!i&&(i=!0,yield[s,null]),yield[s,a])}}var fu,P,fe=x(()=>{kt();fu=Symbol("brand.privateNullableHeaders");P=r=>{let e=new Headers,t=new Set;for(let n of r){let s=new Set;for(let[o,i]of Bp(n)){let a=o.toLowerCase();s.has(a)||(e.delete(o),s.add(a)),i===null?(e.delete(o),t.add(a)):(e.append(o,i),t.delete(a))}}return{[fu]:!0,values:e,nulls:t}}});var An,Sa=x(()=>{W();fe();An=class extends S{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:P([{Accept:"application/octet-stream"},t==null?void 0:t.headers]),__binaryResponse:!0})}}});var Sn,Ca=x(()=>{W();St();Sn=class extends S{create(e,t){return this._client.post("/audio/transcriptions",qe({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}});var Cn,Ea=x(()=>{W();St();Cn=class extends S{create(e,t){return this._client.post("/audio/translations",qe({body:e,...t,__metadata:{model:e.model}},this._client))}}});var gt,$a=x(()=>{W();Sa();Sa();Ca();Ca();Ea();Ea();gt=class extends S{constructor(){super(...arguments),this.transcriptions=new Sn(this._client),this.translations=new Cn(this._client),this.speech=new An(this._client)}};gt.Transcriptions=Sn;gt.Translations=Cn;gt.Speech=An});var wr,Ia=x(()=>{W();se();te();wr=class extends S{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(k`/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/batches",H,{query:e,...t})}cancel(e,t){return this._client.post(k`/batches/${e}/cancel`,t)}}});var En,Pa=x(()=>{W();se();fe();te();En=class extends S{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}retrieve(e,t){return this._client.get(k`/assistants/${e}`,{...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}update(e,t,n){return this._client.post(k`/assistants/${e}`,{body:t,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e={},t){return this._client.getAPIList("/assistants",H,{query:e,...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}delete(e,t){return this._client.delete(k`/assistants/${e}`,{...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}}});var $n,Ra=x(()=>{W();fe();$n=class extends S{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}}});var In,Oa=x(()=>{W();fe();In=class extends S{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}}});var Kt,Fa=x(()=>{W();Ra();Ra();Oa();Oa();Kt=class extends S{constructor(){super(...arguments),this.sessions=new $n(this._client),this.transcriptionSessions=new In(this._client)}};Kt.Sessions=$n;Kt.TranscriptionSessions=In});var Pn,Ma=x(()=>{W();se();fe();te();Pn=class extends S{create(e,t,n){return this._client.post(k`/threads/${e}/messages`,{body:t,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,t,n){let{thread_id:s}=t;return this._client.get(k`/threads/${s}/messages/${e}`,{...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,t,n){let{thread_id:s,...o}=t;return this._client.post(k`/threads/${s}/messages/${e}`,{body:o,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e,t={},n){return this._client.getAPIList(k`/threads/${e}/messages`,H,{query:t,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,t,n){let{thread_id:s}=t;return this._client.delete(k`/threads/${s}/messages/${e}`,{...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}});var Rn,La=x(()=>{W();se();fe();te();Rn=class extends S{retrieve(e,t,n){let{thread_id:s,run_id:o,...i}=t;return this._client.get(k`/threads/${s}/runs/${o}/steps/${e}`,{query:i,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e,t,n){let{thread_id:s,...o}=t;return this._client.getAPIList(k`/threads/${s}/runs/${e}/steps`,H,{query:o,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}});var pu,mu=x(()=>{dt();xo();pu=r=>{if(typeof Buffer<"u"){let e=Buffer.from(r,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{let e=atob(r),t=e.length,n=new Uint8Array(t);for(let s=0;s<t;s++)n[s]=e.charCodeAt(s);return Array.from(new Float32Array(n.buffer))}}});var Jt,Da=x(()=>{Jt=r=>{var e,t,n,s,o;if(typeof globalThis.process<"u")return((t=(e=globalThis.process.env)==null?void 0:e[r])==null?void 0:t.trim())??void 0;if(typeof globalThis.Deno<"u")return(o=(s=(n=globalThis.Deno.env)==null?void 0:n.get)==null?void 0:s.call(n,r))==null?void 0:o.trim()}});var Ls=x(()=>{kt();mu();Da();ws();Mi();_n()});var ke,Tr,Na,yt,jo,rt,kr,On,vr,qo,ze,Uo,Wo,Bs,Ds,Ns,hu,gu,yu,_u,bu,xu,wu,It,Ba=x(()=>{Ge();ha();tt();Fo();Ls();It=class extends Vt{constructor(){super(...arguments),ke.add(this),Na.set(this,[]),yt.set(this,{}),jo.set(this,{}),rt.set(this,void 0),kr.set(this,void 0),On.set(this,void 0),vr.set(this,void 0),qo.set(this,void 0),ze.set(this,void 0),Uo.set(this,void 0),Wo.set(this,void 0),Bs.set(this,void 0)}[(Na=new WeakMap,yt=new WeakMap,jo=new WeakMap,rt=new WeakMap,kr=new WeakMap,On=new WeakMap,vr=new WeakMap,qo=new WeakMap,ze=new WeakMap,Uo=new WeakMap,Wo=new WeakMap,Bs=new WeakMap,ke=new WeakSet,Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("event",s=>{let o=t.shift();o?o.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(let s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{n=!0;for(let o of t)o.reject(s);t.length=0}),this.on("error",s=>{n=!0;for(let o of t)o.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((o,i)=>t.push({resolve:o,reject:i})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){let t=new Tr;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var o;let n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();let s=mt.fromReadableStream(e,this.controller);for await(let i of s)w(this,ke,"m",Ds).call(this,i);if((o=s.controller.signal)!=null&&o.aborted)throw new de;return this._addRun(w(this,ke,"m",Ns).call(this))}toReadableStream(){return new mt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,s){let o=new Tr;return o._run(()=>o._runToolAssistantStream(e,t,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,t,n,s){var l;let o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));let i={...n,stream:!0},a=await e.submitToolOutputs(t,i,{...s,signal:this.controller.signal});this._connected();for await(let u of a)w(this,ke,"m",Ds).call(this,u);if((l=a.controller.signal)!=null&&l.aborted)throw new de;return this._addRun(w(this,ke,"m",Ns).call(this))}static createThreadAssistantStream(e,t,n){let s=new Tr;return s._run(()=>s._threadAssistantStream(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,t,n,s){let o=new Tr;return o._run(()=>o._runAssistantStream(e,t,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),o}currentEvent(){return w(this,Uo,"f")}currentRun(){return w(this,Wo,"f")}currentMessageSnapshot(){return w(this,rt,"f")}currentRunStepSnapshot(){return w(this,Bs,"f")}async finalRunSteps(){return await this.done(),Object.values(w(this,yt,"f"))}async finalMessages(){return await this.done(),Object.values(w(this,jo,"f"))}async finalRun(){if(await this.done(),!w(this,kr,"f"))throw Error("Final run was not received.");return w(this,kr,"f")}async _createThreadAssistantStream(e,t,n){var a;let s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let o={...t,stream:!0},i=await e.createAndRun(o,{...n,signal:this.controller.signal});this._connected();for await(let l of i)w(this,ke,"m",Ds).call(this,l);if((a=i.controller.signal)!=null&&a.aborted)throw new de;return this._addRun(w(this,ke,"m",Ns).call(this))}async _createAssistantStream(e,t,n,s){var l;let o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));let i={...n,stream:!0},a=await e.create(t,i,{...s,signal:this.controller.signal});this._connected();for await(let u of a)w(this,ke,"m",Ds).call(this,u);if((l=a.controller.signal)!=null&&l.aborted)throw new de;return this._addRun(w(this,ke,"m",Ns).call(this))}static accumulateDelta(e,t){for(let[n,s]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=s;continue}let o=e[n];if(o==null){e[n]=s;continue}if(n==="index"||n==="type"){e[n]=s;continue}if(typeof o=="string"&&typeof s=="string")o+=s;else if(typeof o=="number"&&typeof s=="number")o+=s;else if(_s(o)&&_s(s))o=this.accumulateDelta(o,s);else if(Array.isArray(o)&&Array.isArray(s)){if(o.every(i=>typeof i=="string"||typeof i=="number")){o.push(...s);continue}for(let i of s){if(!_s(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);let a=i.index;if(a==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof a!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${a}`);let l=o[a];l==null?o.push(i):o[a]=this.accumulateDelta(l,i)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${s}, accValue: ${o}`);e[n]=o}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,s){return await this._createAssistantStream(t,e,n,s)}async _runToolAssistantStream(e,t,n,s){return await this._createToolAssistantStream(t,e,n,s)}};Tr=It,Ds=function(e){if(!this.ended)switch(N(this,Uo,e,"f"),w(this,ke,"m",yu).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":w(this,ke,"m",wu).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":w(this,ke,"m",gu).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":w(this,ke,"m",hu).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier");default:}},Ns=function(){if(this.ended)throw new F("stream has ended, this shouldn't happen");if(!w(this,kr,"f"))throw Error("Final run has not been received");return w(this,kr,"f")},hu=function(e){let[t,n]=w(this,ke,"m",bu).call(this,e,w(this,rt,"f"));N(this,rt,t,"f"),w(this,jo,"f")[t.id]=t;for(let s of n){let o=t.content[s.index];(o==null?void 0:o.type)=="text"&&this._emit("textCreated",o.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(let s of e.data.delta.content){if(s.type=="text"&&s.text){let o=s.text,i=t.content[s.index];if(i&&i.type=="text")this._emit("textDelta",o,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=w(this,On,"f")){if(w(this,vr,"f"))switch(w(this,vr,"f").type){case"text":this._emit("textDone",w(this,vr,"f").text,w(this,rt,"f"));break;case"image_file":this._emit("imageFileDone",w(this,vr,"f").image_file,w(this,rt,"f"));break}N(this,On,s.index,"f")}N(this,vr,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(w(this,On,"f")!==void 0){let s=e.data.content[w(this,On,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,w(this,rt,"f"));break;case"text":this._emit("textDone",s.text,w(this,rt,"f"));break}}w(this,rt,"f")&&this._emit("messageDone",e.data),N(this,rt,void 0,"f")}},gu=function(e){let t=w(this,ke,"m",_u).call(this,e);switch(N(this,Bs,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(let o of n.step_details.tool_calls)o.index==w(this,qo,"f")?this._emit("toolCallDelta",o,t.step_details.tool_calls[o.index]):(w(this,ze,"f")&&this._emit("toolCallDone",w(this,ze,"f")),N(this,qo,o.index,"f"),N(this,ze,t.step_details.tool_calls[o.index],"f"),w(this,ze,"f")&&this._emit("toolCallCreated",w(this,ze,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":N(this,Bs,void 0,"f"),e.data.step_details.type=="tool_calls"&&w(this,ze,"f")&&(this._emit("toolCallDone",w(this,ze,"f")),N(this,ze,void 0,"f")),this._emit("runStepDone",e.data,t);break;case"thread.run.step.in_progress":break}},yu=function(e){w(this,Na,"f").push(e),this._emit("event",e)},_u=function(e){switch(e.event){case"thread.run.step.created":return w(this,yt,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=w(this,yt,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){let s=Tr.accumulateDelta(t,n.delta);w(this,yt,"f")[e.data.id]=s}return w(this,yt,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":w(this,yt,"f")[e.data.id]=e.data;break}if(w(this,yt,"f")[e.data.id])return w(this,yt,"f")[e.data.id];throw new Error("No snapshot available")},bu=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(let o of s.delta.content)if(o.index in t.content){let i=t.content[o.index];t.content[o.index]=w(this,ke,"m",xu).call(this,o,i)}else t.content[o.index]=o,n.push(o);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},xu=function(e,t){return Tr.accumulateDelta(t,e)},wu=function(e){switch(N(this,Wo,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":N(this,kr,e.data,"f"),w(this,ze,"f")&&(this._emit("toolCallDone",w(this,ze,"f")),N(this,ze,void 0,"f"));break;case"thread.run.cancelling":break}}});var Ar,ja=x(()=>{W();La();La();se();fe();Ba();_n();te();Ar=class extends S{constructor(){super(...arguments),this.steps=new Rn(this._client)}create(e,t,n){let{include:s,...o}=t;return this._client.post(k`/threads/${e}/runs`,{query:{include:s},body:o,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:t.stream??!1})}retrieve(e,t,n){let{thread_id:s}=t;return this._client.get(k`/threads/${s}/runs/${e}`,{...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,t,n){let{thread_id:s,...o}=t;return this._client.post(k`/threads/${s}/runs/${e}`,{body:o,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e,t={},n){return this._client.getAPIList(k`/threads/${e}/runs`,H,{query:t,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}cancel(e,t,n){let{thread_id:s}=t;return this._client.post(k`/threads/${s}/runs/${e}/cancel`,{...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}async createAndPoll(e,t,n){let s=await this.create(e,t,n);return await this.poll(s.id,{thread_id:e},n)}createAndStream(e,t,n){return It.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){var o;let s=P([n==null?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((o=n==null?void 0:n.pollIntervalMs)==null?void 0:o.toString())??void 0}]);for(;;){let{data:i,response:a}=await this.retrieve(e,t,{...n,headers:{...n==null?void 0:n.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(n!=null&&n.pollIntervalMs)l=n.pollIntervalMs;else{let u=a.headers.get("openai-poll-after-ms");if(u){let c=parseInt(u);isNaN(c)||(l=c)}}await ft(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,t,n){return It.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n){let{thread_id:s,...o}=t;return this._client.post(k`/threads/${s}/runs/${e}/submit_tool_outputs`,{body:o,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:t.stream??!1})}async submitToolOutputsAndPoll(e,t,n){let s=await this.submitToolOutputs(e,t,n);return await this.poll(s.id,t,n)}submitToolOutputsStream(e,t,n){return It.createToolAssistantStream(e,this._client.beta.threads.runs,t,n)}};Ar.Steps=Rn});var Xt,Ua=x(()=>{W();Ma();Ma();ja();ja();fe();Ba();te();Xt=class extends S{constructor(){super(...arguments),this.runs=new Ar(this._client),this.messages=new Pn(this._client)}create(e={},t){return this._client.post("/threads",{body:e,...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}retrieve(e,t){return this._client.get(k`/threads/${e}`,{...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}update(e,t,n){return this._client.post(k`/threads/${e}`,{body:t,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,t){return this._client.delete(k`/threads/${e}`,{...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers]),stream:e.stream??!1})}async createAndRunPoll(e,t){let n=await this.createAndRun(e,t);return await this.runs.poll(n.id,{thread_id:n.thread_id},t)}createAndRunStream(e,t){return It.createThreadAssistantStream(e,this._client.beta.threads,t)}};Xt.Runs=Ar;Xt.Messages=Pn});var _t,Wa=x(()=>{W();Pa();Pa();Fa();Fa();Ua();Ua();_t=class extends S{constructor(){super(...arguments),this.realtime=new Kt(this._client),this.assistants=new En(this._client),this.threads=new Xt(this._client)}};_t.Realtime=Kt;_t.Assistants=En;_t.Threads=Xt});var Sr,qa=x(()=>{W();Sr=class extends S{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}});var Fn,za=x(()=>{W();fe();te();Fn=class extends S{retrieve(e,t,n){let{container_id:s}=t;return this._client.get(k`/containers/${s}/files/${e}/content`,{...n,headers:P([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0})}}});var Cr,Ha=x(()=>{W();za();za();se();fe();St();te();Cr=class extends S{constructor(){super(...arguments),this.content=new Fn(this._client)}create(e,t,n){return this._client.post(k`/containers/${e}/files`,qe({body:t,...n},this._client))}retrieve(e,t,n){let{container_id:s}=t;return this._client.get(k`/containers/${s}/files/${e}`,n)}list(e,t={},n){return this._client.getAPIList(k`/containers/${e}/files`,H,{query:t,...n})}delete(e,t,n){let{container_id:s}=t;return this._client.delete(k`/containers/${s}/files/${e}`,{...n,headers:P([{Accept:"*/*"},n==null?void 0:n.headers])})}};Cr.Content=Fn});var Yt,Va=x(()=>{W();Ha();Ha();se();fe();te();Yt=class extends S{constructor(){super(...arguments),this.files=new Cr(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(k`/containers/${e}`,t)}list(e={},t){return this._client.getAPIList("/containers",H,{query:e,...t})}delete(e,t){return this._client.delete(k`/containers/${e}`,{...t,headers:P([{Accept:"*/*"},t==null?void 0:t.headers])})}};Yt.Files=Cr});var Er,Ga=x(()=>{W();Ls();Er=class extends S{create(e,t){let n=!!e.encoding_format,s=n?e.encoding_format:"base64";n&&ce(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);let o=this._client.post("/embeddings",{body:{...e,encoding_format:s},...t});return n?o:(ce(this._client).debug("embeddings/decoding base64 embeddings from base64"),o._thenUnwrap(i=>(i&&i.data&&i.data.forEach(a=>{let l=a.embedding;a.embedding=pu(l)}),i)))}}});var Mn,Za=x(()=>{W();se();te();Mn=class extends S{retrieve(e,t,n){let{eval_id:s,run_id:o}=t;return this._client.get(k`/evals/${s}/runs/${o}/output_items/${e}`,n)}list(e,t,n){let{eval_id:s,...o}=t;return this._client.getAPIList(k`/evals/${s}/runs/${e}/output_items`,H,{query:o,...n})}}});var $r,Ka=x(()=>{W();Za();Za();se();te();$r=class extends S{constructor(){super(...arguments),this.outputItems=new Mn(this._client)}create(e,t,n){return this._client.post(k`/evals/${e}/runs`,{body:t,...n})}retrieve(e,t,n){let{eval_id:s}=t;return this._client.get(k`/evals/${s}/runs/${e}`,n)}list(e,t={},n){return this._client.getAPIList(k`/evals/${e}/runs`,H,{query:t,...n})}delete(e,t,n){let{eval_id:s}=t;return this._client.delete(k`/evals/${s}/runs/${e}`,n)}cancel(e,t,n){let{eval_id:s}=t;return this._client.post(k`/evals/${s}/runs/${e}`,n)}};$r.OutputItems=Mn});var Qt,Ja=x(()=>{W();Ka();Ka();se();te();Qt=class extends S{constructor(){super(...arguments),this.runs=new $r(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(k`/evals/${e}`,t)}update(e,t,n){return this._client.post(k`/evals/${e}`,{body:t,...n})}list(e={},t){return this._client.getAPIList("/evals",H,{query:e,...t})}delete(e,t){return this._client.delete(k`/evals/${e}`,t)}};Qt.Runs=$r});var Ir,Xa=x(()=>{W();se();fe();_n();tt();St();te();Ir=class extends S{create(e,t){return this._client.post("/files",qe({body:e,...t},this._client))}retrieve(e,t){return this._client.get(k`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",H,{query:e,...t})}delete(e,t){return this._client.delete(k`/files/${e}`,t)}content(e,t){return this._client.get(k`/files/${e}/content`,{...t,headers:P([{Accept:"application/binary"},t==null?void 0:t.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=1800*1e3}={}){let s=new Set(["processed","error","deleted"]),o=Date.now(),i=await this.retrieve(e);for(;!i.status||!s.has(i.status);)if(await ft(t),i=await this.retrieve(e),Date.now()-o>n)throw new zt({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return i}}});var Ln,Ya=x(()=>{W();Ln=class extends S{}});var Dn,Qa=x(()=>{W();Dn=class extends S{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}}});var Pr,el=x(()=>{W();Qa();Qa();Pr=class extends S{constructor(){super(...arguments),this.graders=new Dn(this._client)}};Pr.Graders=Dn});var Nn,tl=x(()=>{W();se();te();Nn=class extends S{create(e,t,n){return this._client.getAPIList(k`/fine_tuning/checkpoints/${e}/permissions`,ht,{body:t,method:"post",...n})}retrieve(e,t={},n){return this._client.get(k`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...n})}delete(e,t,n){let{fine_tuned_model_checkpoint:s}=t;return this._client.delete(k`/fine_tuning/checkpoints/${s}/permissions/${e}`,n)}}});var Rr,rl=x(()=>{W();tl();tl();Rr=class extends S{constructor(){super(...arguments),this.permissions=new Nn(this._client)}};Rr.Permissions=Nn});var Bn,nl=x(()=>{W();se();te();Bn=class extends S{list(e,t={},n){return this._client.getAPIList(k`/fine_tuning/jobs/${e}/checkpoints`,H,{query:t,...n})}}});var Or,sl=x(()=>{W();nl();nl();se();te();Or=class extends S{constructor(){super(...arguments),this.checkpoints=new Bn(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(k`/fine_tuning/jobs/${e}`,t)}list(e={},t){return this._client.getAPIList("/fine_tuning/jobs",H,{query:e,...t})}cancel(e,t){return this._client.post(k`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return this._client.getAPIList(k`/fine_tuning/jobs/${e}/events`,H,{query:t,...n})}pause(e,t){return this._client.post(k`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(k`/fine_tuning/jobs/${e}/resume`,t)}};Or.Checkpoints=Bn});var nt,ol=x(()=>{W();Ya();Ya();el();el();rl();rl();sl();sl();nt=class extends S{constructor(){super(...arguments),this.methods=new Ln(this._client),this.jobs=new Or(this._client),this.checkpoints=new Rr(this._client),this.alpha=new Pr(this._client)}};nt.Methods=Ln;nt.Jobs=Or;nt.Checkpoints=Rr;nt.Alpha=Pr});var jn,il=x(()=>{W();jn=class extends S{}});var er,al=x(()=>{W();il();il();er=class extends S{constructor(){super(...arguments),this.graderModels=new jn(this._client)}};er.GraderModels=jn});var Fr,ll=x(()=>{W();St();Fr=class extends S{createVariation(e,t){return this._client.post("/images/variations",qe({body:e,...t},this._client))}edit(e,t){return this._client.post("/images/edits",qe({body:e,...t,stream:e.stream??!1},this._client))}generate(e,t){return this._client.post("/images/generations",{body:e,...t,stream:e.stream??!1})}}});var Mr,cl=x(()=>{W();se();te();Mr=class extends S{retrieve(e,t){return this._client.get(k`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",ht,e)}delete(e,t){return this._client.delete(k`/models/${e}`,t)}}});var Lr,ul=x(()=>{W();Lr=class extends S{create(e,t){return this._client.post("/moderations",{body:e,...t})}}});function vu(r,e){return!e||!um(e)?{...r,output_parsed:null,output:r.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(n=>({...n,parsed:null}))}:t)}:dl(r,e)}function dl(r,e){let t=r.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:pm(e,s)};if(s.type==="message"){let o=s.content.map(i=>i.type==="output_text"?{...i,parsed:cm(e,i.text)}:i);return{...s,content:o}}return s}),n=Object.assign({},r,{output:t});return Object.getOwnPropertyDescriptor(r,"output_text")||zo(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(let s of n.output)if(s.type==="message"){for(let o of s.content)if(o.type==="output_text"&&o.parsed!==null)return o.parsed}return null}}),n}function cm(r,e){var t,n,s,o;return((n=(t=r.text)==null?void 0:t.format)==null?void 0:n.type)!=="json_schema"?null:"$parseRaw"in((s=r.text)==null?void 0:s.format)?((o=r.text)==null?void 0:o.format).$parseRaw(e):JSON.parse(e)}function um(r){var e;return!!Is((e=r.text)==null?void 0:e.format)}function dm(r){return(r==null?void 0:r.$brand)==="auto-parseable-tool"}function fm(r,e){return r.find(t=>t.type==="function"&&t.name===e)}function pm(r,e){let t=fm(r.tools??[],e.name);return{...e,...e,parsed_arguments:dm(t)?t.$parseRaw(e.arguments):t!=null&&t.strict?JSON.parse(e.arguments):null}}function zo(r){let e=[];for(let t of r.output)if(t.type==="message")for(let n of t.content)n.type==="output_text"&&e.push(n.text);r.output_text=e.join("")}var fl=x(()=>{tt();Rs()});function mm(r,e){return vu(r,e)}var Un,Ho,tr,Vo,Tu,ku,Au,Su,Go,Cu=x(()=>{Ge();tt();Fo();fl();Go=class r extends Vt{constructor(e){super(),Un.add(this),Ho.set(this,void 0),tr.set(this,void 0),Vo.set(this,void 0),N(this,Ho,e,"f")}static createResponse(e,t,n){let s=new r(t);return s._run(()=>s._createOrRetrieveResponse(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createOrRetrieveResponse(e,t,n){var a;let s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),w(this,Un,"m",Tu).call(this);let o,i=null;"response_id"in t?(o=await e.responses.retrieve(t.response_id,{stream:!0},{...n,signal:this.controller.signal,stream:!0}),i=t.starting_after??null):o=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal}),this._connected();for await(let l of o)w(this,Un,"m",ku).call(this,l,i);if((a=o.controller.signal)!=null&&a.aborted)throw new de;return w(this,Un,"m",Au).call(this)}[(Ho=new WeakMap,tr=new WeakMap,Vo=new WeakMap,Un=new WeakSet,Tu=function(){this.ended||N(this,tr,void 0,"f")},ku=function(t,n){if(this.ended)return;let s=(i,a)=>{(n==null||a.sequence_number>n)&&this._emit(i,a)},o=w(this,Un,"m",Su).call(this,t);switch(s("event",t),t.type){case"response.output_text.delta":{let i=o.output[t.output_index];if(!i)throw new F(`missing output at index ${t.output_index}`);if(i.type==="message"){let a=i.content[t.content_index];if(!a)throw new F(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new F(`expected content to be 'output_text', got ${a.type}`);s("response.output_text.delta",{...t,snapshot:a.text})}break}case"response.function_call_arguments.delta":{let i=o.output[t.output_index];if(!i)throw new F(`missing output at index ${t.output_index}`);i.type==="function_call"&&s("response.function_call_arguments.delta",{...t,snapshot:i.arguments});break}default:s(t.type,t);break}},Au=function(){if(this.ended)throw new F("stream has ended, this shouldn't happen");let t=w(this,tr,"f");if(!t)throw new F("request ended without sending any events");N(this,tr,void 0,"f");let n=mm(t,w(this,Ho,"f"));return N(this,Vo,n,"f"),n},Su=function(t){let n=w(this,tr,"f");if(!n){if(t.type!=="response.created")throw new F(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=N(this,tr,t.response,"f"),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{let s=n.output[t.output_index];if(!s)throw new F(`missing output at index ${t.output_index}`);s.type==="message"&&s.content.push(t.part);break}case"response.output_text.delta":{let s=n.output[t.output_index];if(!s)throw new F(`missing output at index ${t.output_index}`);if(s.type==="message"){let o=s.content[t.content_index];if(!o)throw new F(`missing content at index ${t.content_index}`);if(o.type!=="output_text")throw new F(`expected content to be 'output_text', got ${o.type}`);o.text+=t.delta}break}case"response.function_call_arguments.delta":{let s=n.output[t.output_index];if(!s)throw new F(`missing output at index ${t.output_index}`);s.type==="function_call"&&(s.arguments+=t.delta);break}case"response.completed":{N(this,tr,t.response,"f");break}}return n},Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("event",s=>{let o=t.shift();o?o.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(let s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{n=!0;for(let o of t)o.reject(s);t.length=0}),this.on("error",s=>{n=!0;for(let o of t)o.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((o,i)=>t.push({resolve:o,reject:i})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();let e=w(this,Vo,"f");if(!e)throw new F("stream ended without producing a ChatCompletion");return e}}});var Wn,pl=x(()=>{W();se();te();Wn=class extends S{list(e,t={},n){return this._client.getAPIList(k`/responses/${e}/input_items`,H,{query:t,...n})}}});var rr,ml=x(()=>{fl();Cu();W();pl();pl();fe();te();rr=class extends S{constructor(){super(...arguments),this.inputItems=new Wn(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&zo(n),n))}retrieve(e,t={},n){return this._client.get(k`/responses/${e}`,{query:t,...n,stream:(t==null?void 0:t.stream)??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&zo(s),s))}delete(e,t){return this._client.delete(k`/responses/${e}`,{...t,headers:P([{Accept:"*/*"},t==null?void 0:t.headers])})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(n=>dl(n,e))}stream(e,t){return Go.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(k`/responses/${e}/cancel`,t)}};rr.InputItems=Wn});var qn,hl=x(()=>{W();St();te();qn=class extends S{create(e,t,n){return this._client.post(k`/uploads/${e}/parts`,qe({body:t,...n},this._client))}}});var nr,gl=x(()=>{W();hl();hl();te();nr=class extends S{constructor(){super(...arguments),this.parts=new qn(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(k`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(k`/uploads/${e}/complete`,{body:t,...n})}};nr.Parts=qn});var Eu,$u=x(()=>{Eu=async r=>{let e=await Promise.allSettled(r),t=e.filter(s=>s.status==="rejected");if(t.length){for(let s of t)console.error(s.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}let n=[];for(let s of e)s.status==="fulfilled"&&n.push(s.value);return n}});var zn,yl=x(()=>{W();se();fe();_n();$u();te();zn=class extends S{create(e,t,n){return this._client.post(k`/vector_stores/${e}/file_batches`,{body:t,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,t,n){let{vector_store_id:s}=t;return this._client.get(k`/vector_stores/${s}/file_batches/${e}`,{...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}cancel(e,t,n){let{vector_store_id:s}=t;return this._client.post(k`/vector_stores/${s}/file_batches/${e}/cancel`,{...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}async createAndPoll(e,t,n){let s=await this.create(e,t);return await this.poll(e,s.id,n)}listFiles(e,t,n){let{vector_store_id:s,...o}=t;return this._client.getAPIList(k`/vector_stores/${s}/file_batches/${e}/files`,H,{query:o,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}async poll(e,t,n){var o;let s=P([n==null?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((o=n==null?void 0:n.pollIntervalMs)==null?void 0:o.toString())??void 0}]);for(;;){let{data:i,response:a}=await this.retrieve(t,{vector_store_id:e},{...n,headers:s}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(n!=null&&n.pollIntervalMs)l=n.pollIntervalMs;else{let u=a.headers.get("openai-poll-after-ms");if(u){let c=parseInt(u);isNaN(c)||(l=c)}}await ft(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},s){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let o=(s==null?void 0:s.maxConcurrency)??5,i=Math.min(o,t.length),a=this._client,l=t.values(),u=[...n];async function c(m){for(let h of m){let v=await a.files.create({file:h,purpose:"assistants"},s);u.push(v.id)}}let f=Array(i).fill(l).map(c);return await Eu(f),await this.createAndPoll(e,{file_ids:u})}}});var Hn,_l=x(()=>{W();se();fe();Ls();te();Hn=class extends S{create(e,t,n){return this._client.post(k`/vector_stores/${e}/files`,{body:t,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,t,n){let{vector_store_id:s}=t;return this._client.get(k`/vector_stores/${s}/files/${e}`,{...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,t,n){let{vector_store_id:s,...o}=t;return this._client.post(k`/vector_stores/${s}/files/${e}`,{body:o,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e,t={},n){return this._client.getAPIList(k`/vector_stores/${e}/files`,H,{query:t,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,t,n){let{vector_store_id:s}=t;return this._client.delete(k`/vector_stores/${s}/files/${e}`,{...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}async createAndPoll(e,t,n){let s=await this.create(e,t,n);return await this.poll(e,s.id,n)}async poll(e,t,n){var o;let s=P([n==null?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((o=n==null?void 0:n.pollIntervalMs)==null?void 0:o.toString())??void 0}]);for(;;){let i=await this.retrieve(t,{vector_store_id:e},{...n,headers:s}).withResponse(),a=i.data;switch(a.status){case"in_progress":let l=5e3;if(n!=null&&n.pollIntervalMs)l=n.pollIntervalMs;else{let u=i.response.headers.get("openai-poll-after-ms");if(u){let c=parseInt(u);isNaN(c)||(l=c)}}await ft(l);break;case"failed":case"completed":return a}}}async upload(e,t,n){let s=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:s.id},n)}async uploadAndPoll(e,t,n){let s=await this.upload(e,t,n);return await this.poll(e,s.id,n)}content(e,t,n){let{vector_store_id:s}=t;return this._client.getAPIList(k`/vector_stores/${s}/files/${e}/content`,ht,{...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}});var Pt,bl=x(()=>{W();yl();yl();_l();_l();se();fe();te();Pt=class extends S{constructor(){super(...arguments),this.files=new Hn(this._client),this.fileBatches=new zn(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}retrieve(e,t){return this._client.get(k`/vector_stores/${e}`,{...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}update(e,t,n){return this._client.post(k`/vector_stores/${e}`,{body:t,...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e={},t){return this._client.getAPIList("/vector_stores",H,{query:e,...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}delete(e,t){return this._client.delete(k`/vector_stores/${e}`,{...t,headers:P([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}search(e,t,n){return this._client.getAPIList(k`/vector_stores/${e}/search`,ht,{body:t,method:"post",...n,headers:P([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}};Pt.Files=Hn;Pt.FileBatches=zn});var Vn,Iu,Zo,Dr,xl=x(()=>{Ge();tt();W();fe();Dr=class extends S{constructor(){super(...arguments),Vn.add(this)}async unwrap(e,t,n=this._client.webhookSecret,s=300){return await this.verifySignature(e,t,n,s),JSON.parse(e)}async verifySignature(e,t,n=this._client.webhookSecret,s=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");w(this,Vn,"m",Iu).call(this,n);let o=P([t]).values,i=w(this,Vn,"m",Zo).call(this,o,"webhook-signature"),a=w(this,Vn,"m",Zo).call(this,o,"webhook-timestamp"),l=w(this,Vn,"m",Zo).call(this,o,"webhook-id"),u=parseInt(a,10);if(isNaN(u))throw new ut("Invalid webhook timestamp format");let c=Math.floor(Date.now()/1e3);if(c-u>s)throw new ut("Webhook timestamp is too old");if(u>c+s)throw new ut("Webhook timestamp is too new");let f=i.split(" ").map(d=>d.startsWith("v1,")?d.substring(3):d),m=n.startsWith("whsec_")?Buffer.from(n.replace("whsec_",""),"base64"):Buffer.from(n,"utf-8"),h=l?`${l}.${a}.${e}`:`${a}.${e}`,v=await crypto.subtle.importKey("raw",m,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(let d of f)try{let p=Buffer.from(d,"base64");if(await crypto.subtle.verify("HMAC",v,p,new TextEncoder().encode(h)))return}catch{continue}throw new ut("The given webhook signature does not match the expected signature")}};Vn=new WeakSet,Iu=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},Zo=function(e,t){if(!e)throw new Error("Headers are required");let n=e.get(t);if(n==null)throw new Error(`Missing required header: ${t}`);return n}});var Pu=x(()=>{uu();du();$a();Ia();Wa();qa();Va();Ga();Ja();Xa();ol();al();ll();cl();ul();ml();gl();bl();xl()});var wl,vl,Ko,Ru,q,Jo=x(()=>{Ge();Mi();kt();_n();mo();Ni();bs();Oc();Wc();Di();dt();se();na();Pu();ko();Ia();qa();Ga();Xa();ll();cl();ul();xl();$a();Wa();Aa();Va();Ja();ol();al();ml();gl();bl();Ni();fe();Da();ws();kt();q=class{constructor({baseURL:e=Jt("OPENAI_BASE_URL"),apiKey:t=Jt("OPENAI_API_KEY"),organization:n=Jt("OPENAI_ORG_ID")??null,project:s=Jt("OPENAI_PROJECT_ID")??null,webhookSecret:o=Jt("OPENAI_WEBHOOK_SECRET")??null,...i}={}){if(wl.add(this),Ko.set(this,void 0),this.completions=new Sr(this),this.chat=new Zt(this),this.embeddings=new Er(this),this.files=new Ir(this),this.images=new Fr(this),this.audio=new gt(this),this.moderations=new Lr(this),this.models=new Mr(this),this.fineTuning=new nt(this),this.graders=new er(this),this.vectorStores=new Pt(this),this.webhooks=new Dr(this),this.beta=new _t(this),this.batches=new wr(this),this.uploads=new nr(this),this.responses=new rr(this),this.evals=new Qt(this),this.containers=new Yt(this),t===void 0)throw new F("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");let a={apiKey:t,organization:n,project:s,webhookSecret:o,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&Ec())throw new F(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=a.baseURL,this.timeout=a.timeout??vl.DEFAULT_TIMEOUT,this.logger=a.logger??console;let l="warn";this.logLevel=l,this.logLevel=Zi(a.logLevel,"ClientOptions.logLevel",this)??Zi(Jt("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??l,this.fetchOptions=a.fetchOptions,this.maxRetries=a.maxRetries??2,this.fetch=a.fetch??Ic(),N(this,Ko,Rc,"f"),this._options=a,this.apiKey=t,this.organization=n,this.project=s,this.webhookSecret=o}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){}async authHeaders(e){return P([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return Vi(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Ht}`}defaultIdempotencyKey(){return`stainless-node-retry-${Fi()}`}makeStatusError(e,t,n,s){return he.generate(e,t,n,s)}buildURL(e,t,n){let s=!w(this,wl,"m",Ru).call(this)&&n||this.baseURL,o=bc(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return wc(i)||(t={...i,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(o.search=this.stringifyQuery(t)),o.toString()}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(s=>({method:e,path:t,...s})))}request(e,t=null){return new yr(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var _,g;let s=await e,o=s.maxRetries??this.maxRetries;t==null&&(t=o),await this.prepareOptions(s);let{req:i,url:a,timeout:l}=await this.buildRequest(s,{retryCount:o-t});await this.prepareRequest(i,{url:a,options:s});let u="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),c=n===void 0?"":`, retryOf: ${n}`,f=Date.now();if(ce(this).debug(`[${u}] sending request`,At({retryOfRequestLogID:n,method:s.method,url:a,options:s,headers:i.headers})),(_=s.signal)!=null&&_.aborted)throw new de;let m=new AbortController,h=await this.fetchWithTimeout(a,i,l,m).catch(ys),v=Date.now();if(h instanceof Error){let y=`retrying, ${t} attempts remaining`;if((g=s.signal)!=null&&g.aborted)throw new de;let b=gs(h)||/timed? ?out/i.test(String(h)+("cause"in h?String(h.cause):""));if(t)return ce(this).info(`[${u}] connection ${b?"timed out":"failed"} - ${y}`),ce(this).debug(`[${u}] connection ${b?"timed out":"failed"} (${y})`,At({retryOfRequestLogID:n,url:a,durationMs:v-f,message:h.message})),this.retryRequest(s,t,n??u);throw ce(this).info(`[${u}] connection ${b?"timed out":"failed"} - error; no more retries left`),ce(this).debug(`[${u}] connection ${b?"timed out":"failed"} (error; no more retries left)`,At({retryOfRequestLogID:n,url:a,durationMs:v-f,message:h.message})),b?new zt:new qt({cause:h})}let d=[...h.headers.entries()].filter(([y])=>y==="x-request-id").map(([y,b])=>", "+y+": "+JSON.stringify(b)).join(""),p=`[${u}${c}${d}] ${i.method} ${a} ${h.ok?"succeeded":"failed"} with status ${h.status} in ${v-f}ms`;if(!h.ok){let y=await this.shouldRetry(h);if(t&&y){let G=`retrying, ${t} attempts remaining`;return await Pc(h.body),ce(this).info(`${p} - ${G}`),ce(this).debug(`[${u}] response error (${G})`,At({retryOfRequestLogID:n,url:h.url,status:h.status,headers:h.headers,durationMs:v-f})),this.retryRequest(s,t,n??u,h.headers)}let b=y?"error; no more retries left":"error; not retryable";ce(this).info(`${p} - ${b}`);let C=await h.text().catch(G=>ys(G).message),E=kc(C),I=E?void 0:C;throw ce(this).debug(`[${u}] response error (${b})`,At({retryOfRequestLogID:n,url:h.url,status:h.status,headers:h.headers,message:I,durationMs:Date.now()-f})),this.makeStatusError(h.status,E,I,h.headers)}return ce(this).info(p),ce(this).debug(`[${u}] response start`,At({retryOfRequestLogID:n,url:h.url,status:h.status,headers:h.headers,durationMs:v-f})),{response:h,options:s,controller:m,requestLogID:u,retryOfRequestLogID:n,startTime:f}}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}requestAPIList(e,t){let n=this.makeRequest(t,null,void 0);return new ks(this,n,e)}async fetchWithTimeout(e,t,n,s){let{signal:o,method:i,...a}=t||{};o&&o.addEventListener("abort",()=>s.abort());let l=setTimeout(()=>s.abort(),n),u=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||typeof a.body=="object"&&a.body!==null&&Symbol.asyncIterator in a.body,c={signal:s.signal,...u?{duplex:"half"}:{},method:"GET",...a};i&&(c.method=i.toUpperCase());try{return await this.fetch.call(void 0,e,c)}finally{clearTimeout(l)}}async shouldRetry(e){let t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n,s){let o,i=s==null?void 0:s.get("retry-after-ms");if(i){let l=parseFloat(i);Number.isNaN(l)||(o=l)}let a=s==null?void 0:s.get("retry-after");if(a&&!o){let l=parseFloat(a);Number.isNaN(l)?o=Date.parse(a)-Date.now():o=l*1e3}if(!(o&&0<=o&&o<60*1e3)){let l=e.maxRetries??this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(t,l)}return await ft(o),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){let o=t-e,i=Math.min(.5*Math.pow(2,o),8),a=1-Math.random()*.25;return i*a*1e3}async buildRequest(e,{retryCount:t=0}={}){let n={...e},{method:s,path:o,query:i,defaultBaseURL:a}=n,l=this.buildURL(o,i,a);"timeout"in n&&Tc("timeout",n.timeout),n.timeout=n.timeout??this.timeout;let{bodyHeaders:u,body:c}=this.buildBody({options:n}),f=await this.buildHeaders({options:e,method:s,bodyHeaders:u,retryCount:t});return{req:{method:s,headers:f,...n.signal&&{signal:n.signal},...globalThis.ReadableStream&&c instanceof globalThis.ReadableStream&&{duplex:"half"},...c&&{body:c},...this.fetchOptions??{},...n.fetchOptions??{}},url:l,timeout:n.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:s}){let o={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);let i=P([o,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...$c(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,n,e.headers]);return this.validateHeaders(i),i.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};let n=P([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||e instanceof Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:ho(e)}:w(this,Ko,"f").call(this,{body:e,headers:n})}};vl=q,Ko=new WeakMap,wl=new WeakSet,Ru=function(){return this.baseURL!=="https://api.openai.com/v1"};q.OpenAI=vl;q.DEFAULT_TIMEOUT=6e5;q.OpenAIError=F;q.APIError=he;q.APIConnectionError=qt;q.APIConnectionTimeoutError=zt;q.APIUserAbortError=de;q.NotFoundError=dn;q.ConflictError=fn;q.RateLimitError=mn;q.BadRequestError=ln;q.AuthenticationError=cn;q.InternalServerError=hn;q.PermissionDeniedError=un;q.UnprocessableEntityError=pn;q.InvalidWebhookSignatureError=ut;q.toFile=Co;q.Completions=Sr;q.Chat=Zt;q.Embeddings=Er;q.Files=Ir;q.Images=Fr;q.Audio=gt;q.Moderations=Lr;q.Models=Mr;q.FineTuning=nt;q.Graders=er;q.VectorStores=Pt;q.Webhooks=Dr;q.Beta=_t;q.Batches=wr;q.Uploads=nr;q.Responses=rr;q.Evals=Qt;q.Containers=Yt});var Ou=x(()=>{tt();Ls();Jo();fe()});var Fu=x(()=>{Jo();na();ko();Jo();se();dt();Ou()});var Gn,Tl=x(()=>{Fu();Gn=class{constructor(e,t,n){this.currentModel="grok-3-latest";this.client=new q({apiKey:e,baseURL:n||process.env.GROK_BASE_URL||"https://api.x.ai/v1",timeout:36e4}),t&&(this.currentModel=t)}setModel(e){this.currentModel=e}getCurrentModel(){return this.currentModel}async chat(e,t,n,s){try{let o={model:n||this.currentModel,messages:e,temperature:.7,max_tokens:4e3};return t&&t.length>0&&(o.tools=t,o.tool_choice="auto"),s!=null&&s.search_parameters&&(o.search_parameters=s.search_parameters),await this.client.chat.completions.create(o)}catch(o){throw new Error(`Grok API error: ${o instanceof Error?o.message:String(o)}`)}}async*chatStream(e,t,n,s){try{let o={model:n||this.currentModel,messages:e,temperature:.7,max_tokens:4e3,stream:!0};t&&t.length>0&&(o.tools=t,o.tool_choice="auto"),s!=null&&s.search_parameters&&(o.search_parameters=s.search_parameters);let i=await this.client.chat.completions.create(o),a=!0;for await(let l of i)a&&(a=!1),yield l}catch(o){throw new Error(`Grok API error: ${o instanceof Error?o.message:String(o)}`)}}async search(e,t){let n={role:"user",content:e},s={search_parameters:t||{mode:"on"}};return this.chat([n],[],void 0,s)}}});function xm(r,e,t){let n=r.toLowerCase();if((t==="bash"||t==="input")&&(n.includes("unexpected eof")||n.includes("matching"))){if(e.command&&typeof e.command=="string"){let s=e.command.replace(/'/g,`'"'"'`);return{...e,command:s}}if(e.prompt&&typeof e.prompt=="string"){let s=e.prompt.replace(/"/g,'\\"').replace(/'/g,"\\'");return{...e,prompt:s}}}if((n.includes("no such file")||n.includes("not found")||n.includes("does not exist"))&&(e.path||e.file_path)){let s=e.path||e.file_path;if(s.startsWith("./"))return{...e,path:s.substring(2),file_path:s.substring(2)};if(!s.startsWith("/")&&!s.startsWith("./"))return{...e,path:"./"+s,file_path:"./"+s};if(t==="search"&&e.query){let o=e.query;if(!o.includes("*"))return{...e,query:`*${o}*`}}}if((n.includes("permission denied")||n.includes("access denied"))&&t==="bash"&&e.command&&typeof e.command=="string"&&!e.command.startsWith("sudo "))return D.warn("[RetryExecutor] Permission denied, but NOT auto-adding sudo for safety"),null;if(n.includes("invalid argument")||n.includes("type error")){let s={...e};for(let[o,i]of Object.entries(s))typeof i=="string"&&i.match(/^\d+$/)&&(s[o]=parseInt(i,10));return s}return null}function Mu(r){var a;let{toolName:e,originalArgs:t,previousErrors:n}=r,s=[],o=((a=n[n.length-1])==null?void 0:a.error)||"",i=`After ${r.attempt} attempts, the last error was: "${o}, the original arguments were: ${JSON.stringify(t)}"`;return e==="search"?s.push("Try using the list tool to explore the directory structure",`Use the bash tool with "find . -name '*pattern*'" for a broader search`,"Check if the file has a different extension (e.g., .txt instead of .md)"):e==="read_file"||e==="view_file"?s.push("Use the list tool to verify the file exists in the expected location","Try the pwd tool to confirm the current working directory",'Use bash with "ls -la" to see all files including hidden ones'):e==="bash"?o.includes("command not found")?s.push('Check if the command is installed with "which <command>"',"Try using the full path to the command","Consider using an alternative command"):o.includes("permission")&&s.push("The command may require elevated permissions","Try a different approach that doesn't require special permissions",'Check file ownership and permissions with "ls -la"'):e==="input"&&s.push("The input dialog may not be supported in this environment","Consider asking the user to provide the information directly in their message","Try a simpler prompt without special characters"),s.push("Review the error messages for clues about what went wrong","Consider breaking down the task into smaller steps","Ask the user for clarification or additional information"),`${i}. Consider these alternative approaches:
${s.map(l=>`- ${l}`).join(`
`)}`}function wm(r){return async(e,t,n=5)=>{let s={toolName:e,originalArgs:t,attempt:0,previousErrors:[]},o=t;for(;s.attempt<n;){s.attempt++,D.log(`[RetryExecutor] Attempt ${s.attempt} for ${e}`);try{let i=await r.execute(e,o);if(i.success)return s.attempt>1&&D.log(`[RetryExecutor] Succeeded on attempt ${s.attempt}`),i;let a=i.error||"Unknown error";s.previousErrors.push({error:a,args:o}),D.warn(`[RetryExecutor] Tool ${e} failed: ${a}`);let l=xm(a,o,e);if(l&&s.attempt<n){D.log("[RetryExecutor] Attempting to fix error with modified arguments"),o=l;continue}if(s.attempt<n){D.log("[RetryExecutor] No automatic fix available, retrying with original args"),o=t;continue}let u=Mu(s);return{success:!1,error:`${a}

${u}`,data:{attempts:s.attempt,errors:s.previousErrors}}}catch(i){let a=i instanceof Error?i.message:String(i);if(s.previousErrors.push({error:a,args:o}),D.error(`[RetryExecutor] Unexpected error: ${a}`),s.attempt>=n){let l=Mu(s);return{success:!1,error:`Execution failed: ${a}

${l}`,data:{attempts:s.attempt,errors:s.previousErrors}}}}}return{success:!1,error:"Max retries exceeded",data:{attempts:s.attempt,errors:s.previousErrors}}}}function vm(r){let e=r.replace(/\}[^}]*$/,"}"),t=e.match(/\{[\s\S]*\}/);return t?t[0]:e.trim()?null:"{}"}function Lu(r){let e=wm(r);return async(t,n)=>{let s=n;if(typeof n=="string")try{s=JSON.parse(n)}catch{let i=vm(n);if(i)try{s=JSON.parse(i)}catch{let a=r.get(t);a&&(!a.definition.arguments||a.definition.arguments.length===0)?s={}:s={input:n}}else s={input:n}}return e(t,s,5)}}var Du=x(()=>{hr()});var qu=$i((YT,Me)=>{var O;Me.exports.__wbg_set_wasm=function(r){O=r};var Tm=typeof TextDecoder>"u"?(0,Me.require)("util").TextDecoder:TextDecoder,ju=new Tm("utf-8",{ignoreBOM:!0,fatal:!0});ju.decode();var Xo=null;function Kn(){return(Xo===null||Xo.byteLength===0)&&(Xo=new Uint8Array(O.memory.buffer)),Xo}function ei(r,e){return r=r>>>0,ju.decode(Kn().subarray(r,r+e))}var Rt=new Array(128).fill(void 0);Rt.push(void 0,null,!0,!1);var js=Rt.length;function st(r){js===Rt.length&&Rt.push(Rt.length+1);let e=js;return js=Rt[e],Rt[e]=r,e}function Uu(r,e){try{return r.apply(this,e)}catch(t){O.__wbindgen_export_0(st(t))}}function ti(r){return Rt[r]}function km(r){r<132||(Rt[r]=js,js=r)}function Nr(r){let e=ti(r);return km(r),e}var Fe=0,Am=typeof TextEncoder>"u"?(0,Me.require)("util").TextEncoder:TextEncoder,Qo=new Am("utf-8"),Sm=typeof Qo.encodeInto=="function"?function(r,e){return Qo.encodeInto(r,e)}:function(r,e){let t=Qo.encode(r);return e.set(t),{read:r.length,written:t.length}};function sr(r,e,t){if(t===void 0){let a=Qo.encode(r),l=e(a.length,1)>>>0;return Kn().subarray(l,l+a.length).set(a),Fe=a.length,l}let n=r.length,s=e(n,1)>>>0,o=Kn(),i=0;for(;i<n;i++){let a=r.charCodeAt(i);if(a>127)break;o[s+i]=a}if(i!==n){i!==0&&(r=r.slice(i)),s=t(s,n,n=i+r.length*3,1)>>>0;let a=Kn().subarray(s+i,s+n),l=Sm(r,a);i+=l.written,s=t(s,n,i,1)>>>0}return Fe=i,s}function Cm(r){return r==null}var Zn=null;function oe(){return(Zn===null||Zn.buffer.detached===!0||Zn.buffer.detached===void 0&&Zn.buffer!==O.memory.buffer)&&(Zn=new DataView(O.memory.buffer)),Zn}var Yo=null;function Wu(){return(Yo===null||Yo.byteLength===0)&&(Yo=new Uint32Array(O.memory.buffer)),Yo}function Nu(r,e){return r=r>>>0,Wu().subarray(r/4,r/4+e)}function Em(r,e){let t=e(r.length*1,1)>>>0;return Kn().set(r,t/1),Fe=r.length,t}function $m(r,e){let t=e(r.length*4,4)>>>0;return Wu().set(r,t/4),Fe=r.length,t}function Bu(r,e){return r=r>>>0,Kn().subarray(r/1,r/1+e)}Me.exports.get_encoding=function(r,e){if(O==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let o=O.__wbindgen_add_to_stack_pointer(-16),i=sr(r,O.__wbindgen_export_1,O.__wbindgen_export_2),a=Fe;O.get_encoding(o,i,a,st(e));var t=oe().getInt32(o+0,!0),n=oe().getInt32(o+4,!0),s=oe().getInt32(o+8,!0);if(s)throw Nr(n);return Us.__wrap(t)}finally{O.__wbindgen_add_to_stack_pointer(16)}};Me.exports.encoding_for_model=function(r,e){if(O==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let o=O.__wbindgen_add_to_stack_pointer(-16),i=sr(r,O.__wbindgen_export_1,O.__wbindgen_export_2),a=Fe;O.encoding_for_model(o,i,a,st(e));var t=oe().getInt32(o+0,!0),n=oe().getInt32(o+4,!0),s=oe().getInt32(o+8,!0);if(s)throw Nr(n);return Us.__wrap(t)}finally{O.__wbindgen_add_to_stack_pointer(16)}};var kl=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>O.__wbg_tiktoken_free(r>>>0,1)),Us=class r{constructor(e,t,n){if(O==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");let s=sr(e,O.__wbindgen_export_1,O.__wbindgen_export_2),o=Fe,i=sr(n,O.__wbindgen_export_1,O.__wbindgen_export_2),a=Fe,l=O.tiktoken_new(s,o,st(t),i,a);return this.__wbg_ptr=l>>>0,kl.register(this,this.__wbg_ptr,this),this}get name(){try{let n=O.__wbindgen_add_to_stack_pointer(-16);O.tiktoken_name(n,this.__wbg_ptr);var e=oe().getInt32(n+0,!0),t=oe().getInt32(n+4,!0);let s;return e!==0&&(s=ei(e,t).slice(),O.__wbindgen_export_3(e,t*1,1)),s}finally{O.__wbindgen_add_to_stack_pointer(16)}}static __wrap(e){e=e>>>0;let t=Object.create(r.prototype);return t.__wbg_ptr=e,kl.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,kl.unregister(this),e}free(){if(O==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");let e=this.__destroy_into_raw();O.__wbg_tiktoken_free(e,0)}encode(e,t,n){if(O==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let u=O.__wbindgen_add_to_stack_pointer(-16),c=sr(e,O.__wbindgen_export_1,O.__wbindgen_export_2),f=Fe;O.tiktoken_encode(u,this.__wbg_ptr,c,f,st(t),st(n));var s=oe().getInt32(u+0,!0),o=oe().getInt32(u+4,!0),i=oe().getInt32(u+8,!0),a=oe().getInt32(u+12,!0);if(a)throw Nr(i);var l=Nu(s,o).slice();return O.__wbindgen_export_3(s,o*4,4),l}finally{O.__wbindgen_add_to_stack_pointer(16)}}encode_ordinary(e){if(O==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let o=O.__wbindgen_add_to_stack_pointer(-16),i=sr(e,O.__wbindgen_export_1,O.__wbindgen_export_2),a=Fe;O.tiktoken_encode_ordinary(o,this.__wbg_ptr,i,a);var t=oe().getInt32(o+0,!0),n=oe().getInt32(o+4,!0),s=Nu(t,n).slice();return O.__wbindgen_export_3(t,n*4,4),s}finally{O.__wbindgen_add_to_stack_pointer(16)}}encode_with_unstable(e,t,n){if(O==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let a=O.__wbindgen_add_to_stack_pointer(-16),l=sr(e,O.__wbindgen_export_1,O.__wbindgen_export_2),u=Fe;O.tiktoken_encode_with_unstable(a,this.__wbg_ptr,l,u,st(t),st(n));var s=oe().getInt32(a+0,!0),o=oe().getInt32(a+4,!0),i=oe().getInt32(a+8,!0);if(i)throw Nr(o);return Nr(s)}finally{O.__wbindgen_add_to_stack_pointer(16)}}encode_single_token(e){if(O==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");let t=Em(e,O.__wbindgen_export_1),n=Fe;return O.tiktoken_encode_single_token(this.__wbg_ptr,t,n)>>>0}decode(e){if(O==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let o=O.__wbindgen_add_to_stack_pointer(-16),i=$m(e,O.__wbindgen_export_1),a=Fe;O.tiktoken_decode(o,this.__wbg_ptr,i,a);var t=oe().getInt32(o+0,!0),n=oe().getInt32(o+4,!0),s=Bu(t,n).slice();return O.__wbindgen_export_3(t,n*1,1),s}finally{O.__wbindgen_add_to_stack_pointer(16)}}decode_single_token_bytes(e){if(O==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let o=O.__wbindgen_add_to_stack_pointer(-16);O.tiktoken_decode_single_token_bytes(o,this.__wbg_ptr,e);var t=oe().getInt32(o+0,!0),n=oe().getInt32(o+4,!0),s=Bu(t,n).slice();return O.__wbindgen_export_3(t,n*1,1),s}finally{O.__wbindgen_add_to_stack_pointer(16)}}token_byte_values(){if(O==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");let e=O.tiktoken_token_byte_values(this.__wbg_ptr);return Nr(e)}};Me.exports.Tiktoken=Us;Me.exports.__wbg_parse_def2e24ef1252aff=function(){return Uu(function(r,e){let t=JSON.parse(ei(r,e));return st(t)},arguments)};Me.exports.__wbg_stringify_f7ed6987935b4a24=function(){return Uu(function(r){let e=JSON.stringify(ti(r));return st(e)},arguments)};Me.exports.__wbindgen_error_new=function(r,e){let t=new Error(ei(r,e));return st(t)};Me.exports.__wbindgen_is_undefined=function(r){return ti(r)===void 0};Me.exports.__wbindgen_object_drop_ref=function(r){Nr(r)};Me.exports.__wbindgen_string_get=function(r,e){if(O==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");let t=ti(e),n=typeof t=="string"?t:void 0;var s=Cm(n)?0:sr(n,O.__wbindgen_export_1,O.__wbindgen_export_2),o=Fe;oe().setInt32(r+4,o,!0),oe().setInt32(r+0,s,!0)};Me.exports.__wbindgen_throw=function(r,e){throw new Error(ei(r,e))}});var Vu=$i(ri=>{var Ws=qu(),zu={};zu["./tiktoken_bg.js"]=Ws;var Jn=require("path"),Im=require("fs"),Hu=__dirname.split(Jn.sep).reduce((r,e,t,n)=>{let s=n.slice(0,t+1).join(Jn.sep)+Jn.sep;return s.includes("node_modules"+Jn.sep)||r.unshift(Jn.join(s,"node_modules","tiktoken","","./tiktoken_bg.wasm")),r},[]);Hu.unshift(Jn.join(__dirname,"./tiktoken_bg.wasm"));var Al=null;for(let r of Hu)try{Al=Im.readFileSync(r);break}catch{}if(Al==null)throw new Error("Missing tiktoken_bg.wasm");var Pm=new WebAssembly.Module(Al),Rm=new WebAssembly.Instance(Pm,zu);Ws.__wbg_set_wasm(Rm.exports);ri.get_encoding=Ws.get_encoding;ri.encoding_for_model=Ws.encoding_for_model;ri.Tiktoken=Ws.Tiktoken});function Gu(r){return new Sl(r)}var ni,Sl,Zu=x(()=>{ni=j(Vu(),1),Sl=class{constructor(e="gpt-4"){try{this.encoder=(0,ni.encoding_for_model)(e)}catch{this.encoder=(0,ni.get_encoding)("cl100k_base")}}countTokens(e){return e?this.encoder.encode(e).length:0}countMessageTokens(e){let t=0;for(let n of e)t+=3,n.content&&typeof n.content=="string"&&(t+=this.countTokens(n.content)),n.role&&(t+=this.countTokens(n.role)),n.tool_calls&&(t+=this.countTokens(JSON.stringify(n.tool_calls)));return t+=3,t}estimateStreamingTokens(e){return this.countTokens(e)}dispose(){this.encoder.free()}}});var Xu={};hs(Xu,{GrokAgent:()=>Cl});var Ku,Ju,Cl,Yu=x(()=>{Tl();Ee();Du();Ku=require("events");Zu();hr();Ju=j(require("path"),1),Cl=class extends Ku.EventEmitter{constructor(e){super(),this.client=new Gn(e.apiKey,e.model,e.baseURL),this.model=e.model||"grok-3-latest",this.maxToolRounds=e.maxToolRounds||30,this.tokenCounter=Gu(this.model),this.registry=Qu(),this.executeToolWithRegistry=Lu(this.registry);let t=[],n=process.env.HOME||process.env.USERPROFILE||"";n&&t.push(Ju.join(n,".clanker")),e.dynamicToolsPath&&t.push(e.dynamicToolsPath),e.loadDynamicTools&&t.push(process.cwd()),this.toolLoader=td(this.registry,{directories:t.length>0?t:void 0,recursive:!0,watch:!0,loadBuiltins:!0})}async chat(e,t,n=!1){let s=[];t&&s.push({role:"system",content:t}),s.push(...e);let o=ed(this.registry);return n?this.streamChat(s,o):this.nonStreamChat(s,o)}async*streamChat(e,t){var i,a,l;let n=0,s=[...e],o=this.tokenCounter.countMessageTokens(s);for(;n<this.maxToolRounds;){let u=this.client.chatStream(s,t.length>0?t:void 0,this.model),c="",f=[],m=null,h=null;for await(let v of u)if(!(!v.choices||v.choices.length===0||!v.choices[0].delta)){if(v.choices[0].delta.tool_calls)for(let d of v.choices[0].delta.tool_calls)d.index===0&&!m?m={id:d.id,type:"function",function:{name:((i=d.function)==null?void 0:i.name)||"",arguments:((a=d.function)==null?void 0:a.arguments)||""}}:m&&((l=d.function)!=null&&l.arguments)&&(m.function.arguments+=d.function.arguments);if(v.choices[0].delta.content!==void 0&&v.choices[0].delta.content!==null){let d=v.choices[0].delta.content;c+=d,yield{type:"content",content:d};let p=this.tokenCounter.estimateStreamingTokens(c)+(f.length>0?this.tokenCounter.countTokens(JSON.stringify(f)):0);yield{type:"token_count",tokenCount:o+p}}if(v.choices[0].finish_reason){h=v.choices[0].finish_reason,m&&f.push(m);break}}if(f.length>0){yield{type:"tool_calls",toolCalls:f};let v=await this.executeToolCalls(f),d={role:"assistant",content:c||"",tool_calls:f};s.push(d),o=this.tokenCounter.countMessageTokens(s);for(let p=0;p<v.length;p++){let _=v[p];yield{type:"tool_result",toolCall:f[p],toolResult:_};let g={role:"tool",content:this.formatToolResult(_),tool_call_id:f[p].id};s.push(g),o=this.tokenCounter.countMessageTokens(s),yield{type:"token_count",tokenCount:o}}n++,m=null,D.log(`[Agent] Tool execution complete, continuing to round ${n}`)}else if(c){yield{type:"done"};return}else if(h==="tool_calls")n++;else{yield{type:"done"};return}}throw new Error(`Maximum tool rounds (${this.maxToolRounds}) exceeded`)}async nonStreamChat(e,t){var o;let n=0,s=[...e];for(;n<this.maxToolRounds;){let a=(o=(await this.client.chat(s,t.length>0?t:void 0,this.model)).choices[0])==null?void 0:o.message;if(!a)throw new Error("No response from API");if(a.tool_calls&&a.tool_calls.length>0){let l=await this.executeToolCalls(a.tool_calls);s.push({role:"assistant",content:a.content,tool_calls:a.tool_calls});for(let u=0;u<l.length;u++)s.push({role:"tool",content:this.formatToolResult(l[u]),tool_call_id:a.tool_calls[u].id});n++}else return a.content||""}throw new Error(`Maximum tool rounds (${this.maxToolRounds}) exceeded`)}async executeToolCalls(e){let t=[];for(let n of e)try{let s=await this.executeTool(n);t.push(s)}catch(s){t.push({success:!1,error:`Tool execution error: ${s instanceof Error?s.message:String(s)}`})}return t}async executeTool(e){let t=e.function.name,n;try{n=JSON.parse(e.function.arguments)}catch(s){D.error(`[Agent] Failed to parse arguments for ${t}:`),D.error(`[Agent] Raw arguments: ${JSON.stringify(e.function.arguments)}`),D.error(`[Agent] Error: ${s}`);let o=this.registry.get(t),i=`Failed to parse JSON arguments: ${s instanceof Error?s.message:String(s)}`;return i+=`

The raw arguments were: ${e.function.arguments}`,o&&(i+=`

Tool "${t}" expects:`,!o.definition.arguments||o.definition.arguments.length===0?i+=`
- No arguments required (use empty object: {})`:o.definition.arguments.forEach(a=>{i+=`
- ${a.name}: ${a.type}${a.required?" (required)":" (optional)"}`,a.description&&(i+=` - ${a.description}`)})),{success:!1,error:i}}return this.executeToolWithRegistry(t,n)}formatToolResult(e){return e.success?e.output||JSON.stringify(e.data)||"Success":`Error: ${e.error}`}getRegistry(){return this.registry}async waitForToolsToLoad(){this.toolLoader&&await this.toolLoader.loadTools()}getToolStats(){return this.registry.getExecutionStats()}getClient(){return this.client}async reloadDynamicTools(){this.toolLoader&&await this.toolLoader.reloadTools()}dispose(){this.tokenCounter.dispose()}}});var Z,El,R,bt,qs=x(()=>{(function(r){r.assertEqual=s=>{};function e(s){}r.assertIs=e;function t(s){throw new Error}r.assertNever=t,r.arrayToEnum=s=>{let o={};for(let i of s)o[i]=i;return o},r.getValidEnumValues=s=>{let o=r.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),i={};for(let a of o)i[a]=s[a];return r.objectValues(i)},r.objectValues=s=>r.objectKeys(s).map(function(o){return s[o]}),r.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{let o=[];for(let i in s)Object.prototype.hasOwnProperty.call(s,i)&&o.push(i);return o},r.find=(s,o)=>{for(let i of s)if(o(i))return i},r.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function n(s,o=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(o)}r.joinValues=n,r.jsonStringifyReplacer=(s,o)=>typeof o=="bigint"?o.toString():o})(Z||(Z={}));(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(El||(El={}));R=Z.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),bt=r=>{switch(typeof r){case"undefined":return R.undefined;case"string":return R.string;case"number":return Number.isNaN(r)?R.nan:R.number;case"boolean":return R.boolean;case"function":return R.function;case"bigint":return R.bigint;case"symbol":return R.symbol;case"object":return Array.isArray(r)?R.array:r===null?R.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?R.promise:typeof Map<"u"&&r instanceof Map?R.map:typeof Set<"u"&&r instanceof Set?R.set:typeof Date<"u"&&r instanceof Date?R.date:R.object;default:return R.unknown}}});var A,Om,Le,si=x(()=>{qs();A=Z.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Om=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:"),Le=class r extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(o){return o.message},n={_errors:[]},s=o=>{for(let i of o.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)n._errors.push(t(i));else{let a=n,l=0;for(;l<i.path.length;){let u=i.path[l];l===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(t(i))):a[u]=a[u]||{_errors:[]},a=a[u],l++}}};return s(this),n}static assert(e){if(!(e instanceof r))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Z.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},n=[];for(let s of this.issues)if(s.path.length>0){let o=s.path[0];t[o]=t[o]||[],t[o].push(e(s))}else n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}};Le.create=r=>new Le(r)});var Fm,Ot,$l=x(()=>{si();qs();Fm=(r,e)=>{let t;switch(r.code){case A.invalid_type:r.received===R.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case A.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,Z.jsonStringifyReplacer)}`;break;case A.unrecognized_keys:t=`Unrecognized key(s) in object: ${Z.joinValues(r.keys,", ")}`;break;case A.invalid_union:t="Invalid input";break;case A.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Z.joinValues(r.options)}`;break;case A.invalid_enum_value:t=`Invalid enum value. Expected ${Z.joinValues(r.options)}, received '${r.received}'`;break;case A.invalid_arguments:t="Invalid function arguments";break;case A.invalid_return_type:t="Invalid function return type";break;case A.invalid_date:t="Invalid date";break;case A.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:Z.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case A.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="bigint"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case A.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case A.custom:t="Invalid input";break;case A.invalid_intersection_types:t="Intersection results could not be merged";break;case A.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case A.not_finite:t="Number must be finite";break;default:t=e.defaultError,Z.assertNever(r)}return{message:t}},Ot=Fm});function Mm(r){rd=r}function Xn(){return rd}var rd,oi=x(()=>{$l();rd=Ot});function $(r,e){let t=Xn(),n=zs({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===Ot?void 0:Ot].filter(s=>!!s)});r.common.issues.push(n)}var zs,Lm,Ae,B,Br,$e,ii,ai,or,Yn,Il=x(()=>{oi();$l();zs=r=>{let{data:e,path:t,errorMaps:n,issueData:s}=r,o=[...t,...s.path||[]],i={...s,path:o};if(s.message!==void 0)return{...s,path:o,message:s.message};let a="",l=n.filter(u=>!!u).slice().reverse();for(let u of l)a=u(i,{data:e,defaultError:a}).message;return{...s,path:o,message:a}},Lm=[];Ae=class r{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let s of t){if(s.status==="aborted")return B;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let s of t){let o=await s.key,i=await s.value;n.push({key:o,value:i})}return r.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let s of t){let{key:o,value:i}=s;if(o.status==="aborted"||i.status==="aborted")return B;o.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),o.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(n[o.value]=i.value)}return{status:e.value,value:n}}},B=Object.freeze({status:"aborted"}),Br=r=>({status:"dirty",value:r}),$e=r=>({status:"valid",value:r}),ii=r=>r.status==="aborted",ai=r=>r.status==="dirty",or=r=>r.status==="valid",Yn=r=>typeof Promise<"u"&&r instanceof Promise});var nd=x(()=>{});var M,sd=x(()=>{(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(M||(M={}))});function z(r){if(!r)return{};let{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(i,a)=>{let{message:l}=r;return i.code==="invalid_enum_value"?{message:l??a.defaultError}:typeof a.data>"u"?{message:l??n??a.defaultError}:i.code!=="invalid_type"?{message:a.defaultError}:{message:l??t??a.defaultError}},description:s}}function ld(r){let e="[0-5]\\d";r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`);let t=r.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function Qm(r){return new RegExp(`^${ld(r)}$`)}function cd(r){let e=`${ad}T${ld(r)}`,t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function eh(r,e){return!!((e==="v4"||!e)&&Vm.test(r)||(e==="v6"||!e)&&Zm.test(r))}function th(r,e){if(!Wm.test(r))return!1;try{let[t]=r.split(".");if(!t)return!1;let n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function rh(r,e){return!!((e==="v4"||!e)&&Gm.test(r)||(e==="v6"||!e)&&Km.test(r))}function nh(r,e){let t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=t>n?t:n,o=Number.parseInt(r.toFixed(s).replace(".","")),i=Number.parseInt(e.toFixed(s).replace(".",""));return o%i/10**s}function Qn(r){if(r instanceof De){let e={};for(let t in r.shape){let n=r.shape[t];e[t]=Ze.create(Qn(n))}return new De({...r._def,shape:()=>e})}else return r instanceof Lt?new Lt({...r._def,type:Qn(r.element)}):r instanceof Ze?Ze.create(Qn(r.unwrap())):r instanceof wt?wt.create(Qn(r.unwrap())):r instanceof xt?xt.create(r.items.map(e=>Qn(e))):r}function Rl(r,e){let t=bt(r),n=bt(e);if(r===e)return{valid:!0,data:r};if(t===R.object&&n===R.object){let s=Z.objectKeys(e),o=Z.objectKeys(r).filter(a=>s.indexOf(a)!==-1),i={...r,...e};for(let a of o){let l=Rl(r[a],e[a]);if(!l.valid)return{valid:!1};i[a]=l.data}return{valid:!0,data:i}}else if(t===R.array&&n===R.array){if(r.length!==e.length)return{valid:!1};let s=[];for(let o=0;o<r.length;o++){let i=r[o],a=e[o],l=Rl(i,a);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return t===R.date&&n===R.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}function ud(r,e){return new Jr({values:r,typeName:U.ZodEnum,...z(e)})}function id(r,e){let t=typeof r=="function"?r(e):typeof r=="string"?{message:r}:r;return typeof t=="string"?{message:t}:t}function dd(r,e={},t){return r?ar.create().superRefine((n,s)=>{let o=r(n);if(o instanceof Promise)return o.then(i=>{if(!i){let a=id(e,n),l=a.fatal??t??!0;s.addIssue({code:"custom",...a,fatal:l})}});if(!o){let i=id(e,n),a=i.fatal??t??!0;s.addIssue({code:"custom",...i,fatal:a})}}):ar.create()}var Ke,od,V,Dm,Nm,Bm,jm,Um,Wm,qm,zm,Hm,Pl,Vm,Gm,Zm,Km,Jm,Xm,ad,Ym,ir,jr,Ur,Wr,qr,es,zr,Hr,ar,Mt,ot,ts,Lt,De,Vr,Ft,li,Gr,xt,ci,rs,ns,ui,Zr,Kr,Jr,Xr,lr,Je,Ze,wt,Yr,Qr,ss,sh,Hs,Vs,en,oh,U,ih,fd,pd,ah,lh,md,ch,uh,dh,fh,ph,mh,hh,gh,yh,_h,bh,xh,wh,vh,Th,kh,Ah,Sh,Ch,Eh,$h,Ih,Ph,Rh,Oh,Fh,Mh,Lh,Dh,Nh,Bh,jh,Uh,Wh,hd=x(()=>{si();oi();sd();Il();qs();Ke=class{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},od=(r,e)=>{if(or(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new Le(r.common.issues);return this._error=t,this._error}}};V=class{get description(){return this._def.description}_getType(e){return bt(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:bt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ae,ctx:{common:e.parent.common,data:e.data,parsedType:bt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(Yn(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){let n={common:{issues:[],async:(t==null?void 0:t.async)??!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:bt(e)},s=this._parseSync({data:e,path:n.path,parent:n});return od(n,s)}"~validate"(e){var n,s;let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:bt(e)};if(!this["~standard"].async)try{let o=this._parseSync({data:e,path:[],parent:t});return or(o)?{value:o.value}:{issues:t.common.issues}}catch(o){(s=(n=o==null?void 0:o.message)==null?void 0:n.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(o=>or(o)?{value:o.value}:{issues:t.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:bt(e)},s=this._parse({data:e,path:n.path,parent:n}),o=await(Yn(s)?s:Promise.resolve(s));return od(n,o)}refine(e,t){let n=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,o)=>{let i=e(s),a=()=>o.addIssue({code:A.custom,...n(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>l?!0:(a(),!1)):i?!0:(a(),!1)})}refinement(e,t){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof t=="function"?t(n,s):t),!1))}_refinement(e){return new Je({schema:this,typeName:U.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Ze.create(this,this._def)}nullable(){return wt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Lt.create(this)}promise(){return lr.create(this,this._def)}or(e){return Vr.create([this,e],this._def)}and(e){return Gr.create(this,e,this._def)}transform(e){return new Je({...z(this._def),schema:this,typeName:U.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new Yr({...z(this._def),innerType:this,defaultValue:t,typeName:U.ZodDefault})}brand(){return new Hs({typeName:U.ZodBranded,type:this,...z(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new Qr({...z(this._def),innerType:this,catchValue:t,typeName:U.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Vs.create(this,e)}readonly(){return en.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},Dm=/^c[^\s-]{8,}$/i,Nm=/^[0-9a-z]+$/,Bm=/^[0-9A-HJKMNP-TV-Z]{26}$/i,jm=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Um=/^[a-z0-9_-]{21}$/i,Wm=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,qm=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,zm=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Hm="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Vm=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Gm=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Zm=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Km=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Jm=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Xm=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ad="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Ym=new RegExp(`^${ad}$`);ir=class r extends V{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==R.string){let o=this._getOrReturnCtx(e);return $(o,{code:A.invalid_type,expected:R.string,received:o.parsedType}),B}let n=new Ae,s;for(let o of this._def.checks)if(o.kind==="min")e.data.length<o.value&&(s=this._getOrReturnCtx(e,s),$(s,{code:A.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="max")e.data.length>o.value&&(s=this._getOrReturnCtx(e,s),$(s,{code:A.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="length"){let i=e.data.length>o.value,a=e.data.length<o.value;(i||a)&&(s=this._getOrReturnCtx(e,s),i?$(s,{code:A.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):a&&$(s,{code:A.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),n.dirty())}else if(o.kind==="email")zm.test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"email",code:A.invalid_string,message:o.message}),n.dirty());else if(o.kind==="emoji")Pl||(Pl=new RegExp(Hm,"u")),Pl.test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"emoji",code:A.invalid_string,message:o.message}),n.dirty());else if(o.kind==="uuid")jm.test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"uuid",code:A.invalid_string,message:o.message}),n.dirty());else if(o.kind==="nanoid")Um.test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"nanoid",code:A.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid")Dm.test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"cuid",code:A.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid2")Nm.test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"cuid2",code:A.invalid_string,message:o.message}),n.dirty());else if(o.kind==="ulid")Bm.test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"ulid",code:A.invalid_string,message:o.message}),n.dirty());else if(o.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),$(s,{validation:"url",code:A.invalid_string,message:o.message}),n.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"regex",code:A.invalid_string,message:o.message}),n.dirty())):o.kind==="trim"?e.data=e.data.trim():o.kind==="includes"?e.data.includes(o.value,o.position)||(s=this._getOrReturnCtx(e,s),$(s,{code:A.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),n.dirty()):o.kind==="toLowerCase"?e.data=e.data.toLowerCase():o.kind==="toUpperCase"?e.data=e.data.toUpperCase():o.kind==="startsWith"?e.data.startsWith(o.value)||(s=this._getOrReturnCtx(e,s),$(s,{code:A.invalid_string,validation:{startsWith:o.value},message:o.message}),n.dirty()):o.kind==="endsWith"?e.data.endsWith(o.value)||(s=this._getOrReturnCtx(e,s),$(s,{code:A.invalid_string,validation:{endsWith:o.value},message:o.message}),n.dirty()):o.kind==="datetime"?cd(o).test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{code:A.invalid_string,validation:"datetime",message:o.message}),n.dirty()):o.kind==="date"?Ym.test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{code:A.invalid_string,validation:"date",message:o.message}),n.dirty()):o.kind==="time"?Qm(o).test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{code:A.invalid_string,validation:"time",message:o.message}),n.dirty()):o.kind==="duration"?qm.test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"duration",code:A.invalid_string,message:o.message}),n.dirty()):o.kind==="ip"?eh(e.data,o.version)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"ip",code:A.invalid_string,message:o.message}),n.dirty()):o.kind==="jwt"?th(e.data,o.alg)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"jwt",code:A.invalid_string,message:o.message}),n.dirty()):o.kind==="cidr"?rh(e.data,o.version)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"cidr",code:A.invalid_string,message:o.message}),n.dirty()):o.kind==="base64"?Jm.test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"base64",code:A.invalid_string,message:o.message}),n.dirty()):o.kind==="base64url"?Xm.test(e.data)||(s=this._getOrReturnCtx(e,s),$(s,{validation:"base64url",code:A.invalid_string,message:o.message}),n.dirty()):Z.assertNever(o);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(s=>e.test(s),{validation:t,code:A.invalid_string,...M.errToObj(n)})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...M.errToObj(e)})}url(e){return this._addCheck({kind:"url",...M.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...M.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...M.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...M.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...M.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...M.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...M.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...M.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...M.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...M.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...M.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...M.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...M.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...M.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...M.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...M.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...M.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...M.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...M.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...M.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...M.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...M.errToObj(t)})}nonempty(e){return this.min(1,M.errToObj(e))}trim(){return new r({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new r({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new r({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};ir.create=r=>new ir({checks:[],typeName:U.ZodString,coerce:(r==null?void 0:r.coerce)??!1,...z(r)});jr=class r extends V{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==R.number){let o=this._getOrReturnCtx(e);return $(o,{code:A.invalid_type,expected:R.number,received:o.parsedType}),B}let n,s=new Ae;for(let o of this._def.checks)o.kind==="int"?Z.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),$(n,{code:A.invalid_type,expected:"integer",received:"float",message:o.message}),s.dirty()):o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),$(n,{code:A.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),$(n,{code:A.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="multipleOf"?nh(e.data,o.value)!==0&&(n=this._getOrReturnCtx(e,n),$(n,{code:A.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):o.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),$(n,{code:A.not_finite,message:o.message}),s.dirty()):Z.assertNever(o);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,M.toString(t))}gt(e,t){return this.setLimit("min",e,!1,M.toString(t))}lte(e,t){return this.setLimit("max",e,!0,M.toString(t))}lt(e,t){return this.setLimit("max",e,!1,M.toString(t))}setLimit(e,t,n,s){return new r({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:M.toString(s)}]})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:M.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:M.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:M.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:M.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:M.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:M.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:M.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:M.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:M.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Z.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}};jr.create=r=>new jr({checks:[],typeName:U.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...z(r)});Ur=class r extends V{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==R.bigint)return this._getInvalidInput(e);let n,s=new Ae;for(let o of this._def.checks)o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),$(n,{code:A.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),$(n,{code:A.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="multipleOf"?e.data%o.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),$(n,{code:A.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):Z.assertNever(o);return{status:s.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return $(t,{code:A.invalid_type,expected:R.bigint,received:t.parsedType}),B}gte(e,t){return this.setLimit("min",e,!0,M.toString(t))}gt(e,t){return this.setLimit("min",e,!1,M.toString(t))}lte(e,t){return this.setLimit("max",e,!0,M.toString(t))}lt(e,t){return this.setLimit("max",e,!1,M.toString(t))}setLimit(e,t,n,s){return new r({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:M.toString(s)}]})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:M.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:M.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:M.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:M.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:M.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Ur.create=r=>new Ur({checks:[],typeName:U.ZodBigInt,coerce:(r==null?void 0:r.coerce)??!1,...z(r)});Wr=class extends V{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==R.boolean){let n=this._getOrReturnCtx(e);return $(n,{code:A.invalid_type,expected:R.boolean,received:n.parsedType}),B}return $e(e.data)}};Wr.create=r=>new Wr({typeName:U.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...z(r)});qr=class r extends V{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==R.date){let o=this._getOrReturnCtx(e);return $(o,{code:A.invalid_type,expected:R.date,received:o.parsedType}),B}if(Number.isNaN(e.data.getTime())){let o=this._getOrReturnCtx(e);return $(o,{code:A.invalid_date}),B}let n=new Ae,s;for(let o of this._def.checks)o.kind==="min"?e.data.getTime()<o.value&&(s=this._getOrReturnCtx(e,s),$(s,{code:A.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),n.dirty()):o.kind==="max"?e.data.getTime()>o.value&&(s=this._getOrReturnCtx(e,s),$(s,{code:A.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),n.dirty()):Z.assertNever(o);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:M.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:M.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};qr.create=r=>new qr({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:U.ZodDate,...z(r)});es=class extends V{_parse(e){if(this._getType(e)!==R.symbol){let n=this._getOrReturnCtx(e);return $(n,{code:A.invalid_type,expected:R.symbol,received:n.parsedType}),B}return $e(e.data)}};es.create=r=>new es({typeName:U.ZodSymbol,...z(r)});zr=class extends V{_parse(e){if(this._getType(e)!==R.undefined){let n=this._getOrReturnCtx(e);return $(n,{code:A.invalid_type,expected:R.undefined,received:n.parsedType}),B}return $e(e.data)}};zr.create=r=>new zr({typeName:U.ZodUndefined,...z(r)});Hr=class extends V{_parse(e){if(this._getType(e)!==R.null){let n=this._getOrReturnCtx(e);return $(n,{code:A.invalid_type,expected:R.null,received:n.parsedType}),B}return $e(e.data)}};Hr.create=r=>new Hr({typeName:U.ZodNull,...z(r)});ar=class extends V{constructor(){super(...arguments),this._any=!0}_parse(e){return $e(e.data)}};ar.create=r=>new ar({typeName:U.ZodAny,...z(r)});Mt=class extends V{constructor(){super(...arguments),this._unknown=!0}_parse(e){return $e(e.data)}};Mt.create=r=>new Mt({typeName:U.ZodUnknown,...z(r)});ot=class extends V{_parse(e){let t=this._getOrReturnCtx(e);return $(t,{code:A.invalid_type,expected:R.never,received:t.parsedType}),B}};ot.create=r=>new ot({typeName:U.ZodNever,...z(r)});ts=class extends V{_parse(e){if(this._getType(e)!==R.undefined){let n=this._getOrReturnCtx(e);return $(n,{code:A.invalid_type,expected:R.void,received:n.parsedType}),B}return $e(e.data)}};ts.create=r=>new ts({typeName:U.ZodVoid,...z(r)});Lt=class r extends V{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==R.array)return $(t,{code:A.invalid_type,expected:R.array,received:t.parsedType}),B;if(s.exactLength!==null){let i=t.data.length>s.exactLength.value,a=t.data.length<s.exactLength.value;(i||a)&&($(t,{code:i?A.too_big:A.too_small,minimum:a?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&($(t,{code:A.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&($(t,{code:A.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((i,a)=>s.type._parseAsync(new Ke(t,i,t.path,a)))).then(i=>Ae.mergeArray(n,i));let o=[...t.data].map((i,a)=>s.type._parseSync(new Ke(t,i,t.path,a)));return Ae.mergeArray(n,o)}get element(){return this._def.type}min(e,t){return new r({...this._def,minLength:{value:e,message:M.toString(t)}})}max(e,t){return new r({...this._def,maxLength:{value:e,message:M.toString(t)}})}length(e,t){return new r({...this._def,exactLength:{value:e,message:M.toString(t)}})}nonempty(e){return this.min(1,e)}};Lt.create=(r,e)=>new Lt({type:r,minLength:null,maxLength:null,exactLength:null,typeName:U.ZodArray,...z(e)});De=class r extends V{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=Z.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==R.object){let u=this._getOrReturnCtx(e);return $(u,{code:A.invalid_type,expected:R.object,received:u.parsedType}),B}let{status:n,ctx:s}=this._processInputParams(e),{shape:o,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof ot&&this._def.unknownKeys==="strip"))for(let u in s.data)i.includes(u)||a.push(u);let l=[];for(let u of i){let c=o[u],f=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Ke(s,f,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof ot){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of a)l.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")a.length>0&&($(s,{code:A.unrecognized_keys,keys:a}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of a){let f=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Ke(s,f,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of l){let f=await c.key,m=await c.value;u.push({key:f,value:m,alwaysSet:c.alwaysSet})}return u}).then(u=>Ae.mergeObjectSync(n,u)):Ae.mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(e){return M.errToObj,new r({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var o,i;let s=((i=(o=this._def).errorMap)==null?void 0:i.call(o,t,n).message)??n.defaultError;return t.code==="unrecognized_keys"?{message:M.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new r({...this._def,unknownKeys:"strip"})}passthrough(){return new r({...this._def,unknownKeys:"passthrough"})}extend(e){return new r({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new r({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:U.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new r({...this._def,catchall:e})}pick(e){let t={};for(let n of Z.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new r({...this._def,shape:()=>t})}omit(e){let t={};for(let n of Z.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new r({...this._def,shape:()=>t})}deepPartial(){return Qn(this)}partial(e){let t={};for(let n of Z.objectKeys(this.shape)){let s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}return new r({...this._def,shape:()=>t})}required(e){let t={};for(let n of Z.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let o=this.shape[n];for(;o instanceof Ze;)o=o._def.innerType;t[n]=o}return new r({...this._def,shape:()=>t})}keyof(){return ud(Z.objectKeys(this.shape))}};De.create=(r,e)=>new De({shape:()=>r,unknownKeys:"strip",catchall:ot.create(),typeName:U.ZodObject,...z(e)});De.strictCreate=(r,e)=>new De({shape:()=>r,unknownKeys:"strict",catchall:ot.create(),typeName:U.ZodObject,...z(e)});De.lazycreate=(r,e)=>new De({shape:r,unknownKeys:"strip",catchall:ot.create(),typeName:U.ZodObject,...z(e)});Vr=class extends V{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;function s(o){for(let a of o)if(a.result.status==="valid")return a.result;for(let a of o)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;let i=o.map(a=>new Le(a.ctx.common.issues));return $(t,{code:A.invalid_union,unionErrors:i}),B}if(t.common.async)return Promise.all(n.map(async o=>{let i={...t,common:{...t.common,issues:[]},parent:null};return{result:await o._parseAsync({data:t.data,path:t.path,parent:i}),ctx:i}})).then(s);{let o,i=[];for(let l of n){let u={...t,common:{...t.common,issues:[]},parent:null},c=l._parseSync({data:t.data,path:t.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!o&&(o={result:c,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(o)return t.common.issues.push(...o.ctx.common.issues),o.result;let a=i.map(l=>new Le(l));return $(t,{code:A.invalid_union,unionErrors:a}),B}}get options(){return this._def.options}};Vr.create=(r,e)=>new Vr({options:r,typeName:U.ZodUnion,...z(e)});Ft=r=>r instanceof Zr?Ft(r.schema):r instanceof Je?Ft(r.innerType()):r instanceof Kr?[r.value]:r instanceof Jr?r.options:r instanceof Xr?Z.objectValues(r.enum):r instanceof Yr?Ft(r._def.innerType):r instanceof zr?[void 0]:r instanceof Hr?[null]:r instanceof Ze?[void 0,...Ft(r.unwrap())]:r instanceof wt?[null,...Ft(r.unwrap())]:r instanceof Hs||r instanceof en?Ft(r.unwrap()):r instanceof Qr?Ft(r._def.innerType):[],li=class r extends V{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==R.object)return $(t,{code:A.invalid_type,expected:R.object,received:t.parsedType}),B;let n=this.discriminator,s=t.data[n],o=this.optionsMap.get(s);return o?t.common.async?o._parseAsync({data:t.data,path:t.path,parent:t}):o._parseSync({data:t.data,path:t.path,parent:t}):($(t,{code:A.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),B)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let s=new Map;for(let o of t){let i=Ft(o.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of i){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,o)}}return new r({typeName:U.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...z(n)})}};Gr=class extends V{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),s=(o,i)=>{if(ii(o)||ii(i))return B;let a=Rl(o.value,i.value);return a.valid?((ai(o)||ai(i))&&t.dirty(),{status:t.value,value:a.data}):($(n,{code:A.invalid_intersection_types}),B)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([o,i])=>s(o,i)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};Gr.create=(r,e,t)=>new Gr({left:r,right:e,typeName:U.ZodIntersection,...z(t)});xt=class r extends V{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==R.array)return $(n,{code:A.invalid_type,expected:R.array,received:n.parsedType}),B;if(n.data.length<this._def.items.length)return $(n,{code:A.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),B;!this._def.rest&&n.data.length>this._def.items.length&&($(n,{code:A.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let o=[...n.data].map((i,a)=>{let l=this._def.items[a]||this._def.rest;return l?l._parse(new Ke(n,i,n.path,a)):null}).filter(i=>!!i);return n.common.async?Promise.all(o).then(i=>Ae.mergeArray(t,i)):Ae.mergeArray(t,o)}get items(){return this._def.items}rest(e){return new r({...this._def,rest:e})}};xt.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new xt({items:r,typeName:U.ZodTuple,rest:null,...z(e)})};ci=class r extends V{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==R.object)return $(n,{code:A.invalid_type,expected:R.object,received:n.parsedType}),B;let s=[],o=this._def.keyType,i=this._def.valueType;for(let a in n.data)s.push({key:o._parse(new Ke(n,a,n.path,a)),value:i._parse(new Ke(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?Ae.mergeObjectAsync(t,s):Ae.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof V?new r({keyType:e,valueType:t,typeName:U.ZodRecord,...z(n)}):new r({keyType:ir.create(),valueType:e,typeName:U.ZodRecord,...z(t)})}},rs=class extends V{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==R.map)return $(n,{code:A.invalid_type,expected:R.map,received:n.parsedType}),B;let s=this._def.keyType,o=this._def.valueType,i=[...n.data.entries()].map(([a,l],u)=>({key:s._parse(new Ke(n,a,n.path,[u,"key"])),value:o._parse(new Ke(n,l,n.path,[u,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let l of i){let u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return B;(u.status==="dirty"||c.status==="dirty")&&t.dirty(),a.set(u.value,c.value)}return{status:t.value,value:a}})}else{let a=new Map;for(let l of i){let u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return B;(u.status==="dirty"||c.status==="dirty")&&t.dirty(),a.set(u.value,c.value)}return{status:t.value,value:a}}}};rs.create=(r,e,t)=>new rs({valueType:e,keyType:r,typeName:U.ZodMap,...z(t)});ns=class r extends V{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==R.set)return $(n,{code:A.invalid_type,expected:R.set,received:n.parsedType}),B;let s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&($(n,{code:A.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&($(n,{code:A.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());let o=this._def.valueType;function i(l){let u=new Set;for(let c of l){if(c.status==="aborted")return B;c.status==="dirty"&&t.dirty(),u.add(c.value)}return{status:t.value,value:u}}let a=[...n.data.values()].map((l,u)=>o._parse(new Ke(n,l,n.path,u)));return n.common.async?Promise.all(a).then(l=>i(l)):i(a)}min(e,t){return new r({...this._def,minSize:{value:e,message:M.toString(t)}})}max(e,t){return new r({...this._def,maxSize:{value:e,message:M.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};ns.create=(r,e)=>new ns({valueType:r,minSize:null,maxSize:null,typeName:U.ZodSet,...z(e)});ui=class r extends V{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==R.function)return $(t,{code:A.invalid_type,expected:R.function,received:t.parsedType}),B;function n(a,l){return zs({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Xn(),Ot].filter(u=>!!u),issueData:{code:A.invalid_arguments,argumentsError:l}})}function s(a,l){return zs({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Xn(),Ot].filter(u=>!!u),issueData:{code:A.invalid_return_type,returnTypeError:l}})}let o={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof lr){let a=this;return $e(async function(...l){let u=new Le([]),c=await a._def.args.parseAsync(l,o).catch(h=>{throw u.addIssue(n(l,h)),u}),f=await Reflect.apply(i,this,c);return await a._def.returns._def.type.parseAsync(f,o).catch(h=>{throw u.addIssue(s(f,h)),u})})}else{let a=this;return $e(function(...l){let u=a._def.args.safeParse(l,o);if(!u.success)throw new Le([n(l,u.error)]);let c=Reflect.apply(i,this,u.data),f=a._def.returns.safeParse(c,o);if(!f.success)throw new Le([s(c,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new r({...this._def,args:xt.create(e).rest(Mt.create())})}returns(e){return new r({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new r({args:e||xt.create([]).rest(Mt.create()),returns:t||Mt.create(),typeName:U.ZodFunction,...z(n)})}},Zr=class extends V{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};Zr.create=(r,e)=>new Zr({getter:r,typeName:U.ZodLazy,...z(e)});Kr=class extends V{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return $(t,{received:t.data,code:A.invalid_literal,expected:this._def.value}),B}return{status:"valid",value:e.data}}get value(){return this._def.value}};Kr.create=(r,e)=>new Kr({value:r,typeName:U.ZodLiteral,...z(e)});Jr=class r extends V{_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),n=this._def.values;return $(t,{expected:Z.joinValues(n),received:t.parsedType,code:A.invalid_type}),B}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return $(t,{received:t.data,code:A.invalid_enum_value,options:n}),B}return $e(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return r.create(e,{...this._def,...t})}exclude(e,t=this._def){return r.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}};Jr.create=ud;Xr=class extends V{_parse(e){let t=Z.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==R.string&&n.parsedType!==R.number){let s=Z.objectValues(t);return $(n,{expected:Z.joinValues(s),received:n.parsedType,code:A.invalid_type}),B}if(this._cache||(this._cache=new Set(Z.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let s=Z.objectValues(t);return $(n,{received:n.data,code:A.invalid_enum_value,options:s}),B}return $e(e.data)}get enum(){return this._def.values}};Xr.create=(r,e)=>new Xr({values:r,typeName:U.ZodNativeEnum,...z(e)});lr=class extends V{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==R.promise&&t.common.async===!1)return $(t,{code:A.invalid_type,expected:R.promise,received:t.parsedType}),B;let n=t.parsedType===R.promise?t.data:Promise.resolve(t.data);return $e(n.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}};lr.create=(r,e)=>new lr({type:r,typeName:U.ZodPromise,...z(e)});Je=class extends V{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===U.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,o={addIssue:i=>{$(n,i),i.fatal?t.abort():t.dirty()},get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),s.type==="preprocess"){let i=s.transform(n.data,o);if(n.common.async)return Promise.resolve(i).then(async a=>{if(t.value==="aborted")return B;let l=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return l.status==="aborted"?B:l.status==="dirty"?Br(l.value):t.value==="dirty"?Br(l.value):l});{if(t.value==="aborted")return B;let a=this._def.schema._parseSync({data:i,path:n.path,parent:n});return a.status==="aborted"?B:a.status==="dirty"?Br(a.value):t.value==="dirty"?Br(a.value):a}}if(s.type==="refinement"){let i=a=>{let l=s.refinement(a,o);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?B:(a.status==="dirty"&&t.dirty(),i(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?B:(a.status==="dirty"&&t.dirty(),i(a.value).then(()=>({status:t.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!or(i))return B;let a=s.transform(i.value,o);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>or(i)?Promise.resolve(s.transform(i.value,o)).then(a=>({status:t.value,value:a})):B);Z.assertNever(s)}};Je.create=(r,e,t)=>new Je({schema:r,typeName:U.ZodEffects,effect:e,...z(t)});Je.createWithPreprocess=(r,e,t)=>new Je({schema:e,effect:{type:"preprocess",transform:r},typeName:U.ZodEffects,...z(t)});Ze=class extends V{_parse(e){return this._getType(e)===R.undefined?$e(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ze.create=(r,e)=>new Ze({innerType:r,typeName:U.ZodOptional,...z(e)});wt=class extends V{_parse(e){return this._getType(e)===R.null?$e(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};wt.create=(r,e)=>new wt({innerType:r,typeName:U.ZodNullable,...z(e)});Yr=class extends V{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===R.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};Yr.create=(r,e)=>new Yr({innerType:r,typeName:U.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...z(e)});Qr=class extends V{_parse(e){let{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Yn(s)?s.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Le(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Le(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};Qr.create=(r,e)=>new Qr({innerType:r,typeName:U.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...z(e)});ss=class extends V{_parse(e){if(this._getType(e)!==R.nan){let n=this._getOrReturnCtx(e);return $(n,{code:A.invalid_type,expected:R.nan,received:n.parsedType}),B}return{status:"valid",value:e.data}}};ss.create=r=>new ss({typeName:U.ZodNaN,...z(r)});sh=Symbol("zod_brand"),Hs=class extends V{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}},Vs=class r extends V{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let o=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?B:o.status==="dirty"?(t.dirty(),Br(o.value)):this._def.out._parseAsync({data:o.value,path:n.path,parent:n})})();{let s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?B:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,t){return new r({in:e,out:t,typeName:U.ZodPipeline})}},en=class extends V{_parse(e){let t=this._def.innerType._parse(e),n=s=>(or(s)&&(s.value=Object.freeze(s.value)),s);return Yn(t)?t.then(s=>n(s)):n(t)}unwrap(){return this._def.innerType}};en.create=(r,e)=>new en({innerType:r,typeName:U.ZodReadonly,...z(e)});oh={object:De.lazycreate};(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(U||(U={}));ih=(r,e={message:`Input not instance of ${r.name}`})=>dd(t=>t instanceof r,e),fd=ir.create,pd=jr.create,ah=ss.create,lh=Ur.create,md=Wr.create,ch=qr.create,uh=es.create,dh=zr.create,fh=Hr.create,ph=ar.create,mh=Mt.create,hh=ot.create,gh=ts.create,yh=Lt.create,_h=De.create,bh=De.strictCreate,xh=Vr.create,wh=li.create,vh=Gr.create,Th=xt.create,kh=ci.create,Ah=rs.create,Sh=ns.create,Ch=ui.create,Eh=Zr.create,$h=Kr.create,Ih=Jr.create,Ph=Xr.create,Rh=lr.create,Oh=Je.create,Fh=Ze.create,Mh=wt.create,Lh=Je.createWithPreprocess,Dh=Vs.create,Nh=()=>fd().optional(),Bh=()=>pd().optional(),jh=()=>md().optional(),Uh={string:r=>ir.create({...r,coerce:!0}),number:r=>jr.create({...r,coerce:!0}),boolean:r=>Wr.create({...r,coerce:!0}),bigint:r=>Ur.create({...r,coerce:!0}),date:r=>qr.create({...r,coerce:!0})},Wh=B});var _e={};hs(_e,{BRAND:()=>sh,DIRTY:()=>Br,EMPTY_PATH:()=>Lm,INVALID:()=>B,NEVER:()=>Wh,OK:()=>$e,ParseStatus:()=>Ae,Schema:()=>V,ZodAny:()=>ar,ZodArray:()=>Lt,ZodBigInt:()=>Ur,ZodBoolean:()=>Wr,ZodBranded:()=>Hs,ZodCatch:()=>Qr,ZodDate:()=>qr,ZodDefault:()=>Yr,ZodDiscriminatedUnion:()=>li,ZodEffects:()=>Je,ZodEnum:()=>Jr,ZodError:()=>Le,ZodFirstPartyTypeKind:()=>U,ZodFunction:()=>ui,ZodIntersection:()=>Gr,ZodIssueCode:()=>A,ZodLazy:()=>Zr,ZodLiteral:()=>Kr,ZodMap:()=>rs,ZodNaN:()=>ss,ZodNativeEnum:()=>Xr,ZodNever:()=>ot,ZodNull:()=>Hr,ZodNullable:()=>wt,ZodNumber:()=>jr,ZodObject:()=>De,ZodOptional:()=>Ze,ZodParsedType:()=>R,ZodPipeline:()=>Vs,ZodPromise:()=>lr,ZodReadonly:()=>en,ZodRecord:()=>ci,ZodSchema:()=>V,ZodSet:()=>ns,ZodString:()=>ir,ZodSymbol:()=>es,ZodTransformer:()=>Je,ZodTuple:()=>xt,ZodType:()=>V,ZodUndefined:()=>zr,ZodUnion:()=>Vr,ZodUnknown:()=>Mt,ZodVoid:()=>ts,addIssueToContext:()=>$,any:()=>ph,array:()=>yh,bigint:()=>lh,boolean:()=>md,coerce:()=>Uh,custom:()=>dd,date:()=>ch,datetimeRegex:()=>cd,defaultErrorMap:()=>Ot,discriminatedUnion:()=>wh,effect:()=>Oh,enum:()=>Ih,function:()=>Ch,getErrorMap:()=>Xn,getParsedType:()=>bt,instanceof:()=>ih,intersection:()=>vh,isAborted:()=>ii,isAsync:()=>Yn,isDirty:()=>ai,isValid:()=>or,late:()=>oh,lazy:()=>Eh,literal:()=>$h,makeIssue:()=>zs,map:()=>Ah,nan:()=>ah,nativeEnum:()=>Ph,never:()=>hh,null:()=>fh,nullable:()=>Mh,number:()=>pd,object:()=>_h,objectUtil:()=>El,oboolean:()=>jh,onumber:()=>Bh,optional:()=>Fh,ostring:()=>Nh,pipeline:()=>Dh,preprocess:()=>Lh,promise:()=>Rh,quotelessJson:()=>Om,record:()=>kh,set:()=>Sh,setErrorMap:()=>Mm,strictObject:()=>bh,string:()=>fd,symbol:()=>uh,transformer:()=>Oh,tuple:()=>Th,undefined:()=>dh,union:()=>xh,unknown:()=>mh,util:()=>Z,void:()=>gh});var Ol=x(()=>{oi();Il();nd();qs();hd();si()});var gd=x(()=>{Ol();Ol()});var bd={};hs(bd,{ProviderModels:()=>_d,SettingsManager:()=>Gs,SettingsSchema:()=>di});var Dt,Fl,yd,_d,di,Gs,Ml=x(()=>{Dt=j(require("fs"),1),Fl=j(require("path"),1),yd=j(require("os"),1);gd();_d={grok:{name:"Grok",baseURL:"https://api.x.ai/v1",models:[{value:"grok-4-0709",label:"Grok 4"},{value:"grok-3",label:"Grok 3"},{value:"grok-3-mini",label:"Grok 3 Mini"},{value:"grok-3-fast",label:"Grok 3 Fast"},{value:"grok-3-mini-fast",label:"Grok 3 Mini Fast"},{value:"grok-2-vision-1212",label:"Grok 2 Vision"},{value:"grok-2-image-1212",label:"Grok 2 Image"}],defaultModel:"grok-3"},openai:{name:"OpenAI",baseURL:"https://api.openai.com/v1",models:[{value:"gpt-4",label:"GPT-4"},{value:"gpt-4-turbo",label:"GPT-4 Turbo"},{value:"gpt-3.5-turbo",label:"GPT-3.5 Turbo"}],defaultModel:"gpt-4-turbo"},custom:{name:"Custom",baseURL:"",models:[],defaultModel:""}},di=_e.object({apiKey:_e.string().min(1,"API key is required"),provider:_e.enum(["grok","openai","custom"]).default("grok"),customBaseURL:_e.string().url().optional(),model:_e.string().default(_d.grok.defaultModel),theme:_e.enum(["light","dark","auto"]).default("auto"),autoEditEnabled:_e.boolean().default(!1),vsCodeOpenEnabled:_e.boolean().default(!1),dangerousBypassPermission:_e.boolean().default(!1),virtualScrollingEnabled:_e.boolean().default(!0),confirmationSettings:_e.object({alwaysEdit:_e.boolean().default(!1),alwaysBash:_e.boolean().default(!1),alwaysSearch:_e.boolean().default(!1)}).default({}),version:_e.number().default(1)}),Gs=class r{constructor(){this.currentVersion=2;this.settingsDir=Fl.join(yd.homedir(),".clanker"),this.settingsPath=Fl.join(this.settingsDir,"settings.json")}static getInstance(){return r.instance||(r.instance=new r),r.instance}ensureSettingsDir(){Dt.existsSync(this.settingsDir)||Dt.mkdirSync(this.settingsDir,{recursive:!0})}loadSettings(){try{if(this.ensureSettingsDir(),!Dt.existsSync(this.settingsPath))return{settings:{},isValid:!1,errors:null};let e=Dt.readFileSync(this.settingsPath,"utf-8"),t=JSON.parse(e),n=di.safeParse(t);return n.success?{settings:n.data,isValid:!0,errors:null}:{settings:t,isValid:!1,errors:n.error}}catch(e){return console.error("Failed to load settings:",e),{settings:{},isValid:!1,errors:null}}}saveSettings(e){try{this.ensureSettingsDir();let t={...e,version:this.currentVersion};Dt.writeFileSync(this.settingsPath,JSON.stringify(t,null,2),"utf-8")}catch(t){throw console.error("Failed to save settings:",t),t}}needsConfiguration(){let{isValid:e,settings:t}=this.loadSettings();if(!e)return!0;let n=["apiKey"];for(let s of n)if(!t[s])return!0;return!t.version||t.version<this.currentVersion}getMissingFields(){let{settings:e}=this.loadSettings(),t=di.shape,n=[];for(let[s,o]of Object.entries(t))s!=="version"&&!o.isOptional()&&!e[s]&&n.push(s);return n}validateField(e,t){var n;try{di.shape[e].parse(t);return}catch(s){return s instanceof _e.ZodError&&((n=s.errors[0])==null?void 0:n.message)||"Invalid value"}}}});var Ll,T,Ne,it,os=x(()=>{yc();Ll=j(require("crypto"),1);hr();_c();T=Oi({agent:null,isInitializing:!1,initError:null,messages:[],messageCount:0,executions:new Map,activeExecutions:[],trackedFiles:new Map,isProcessing:!1,isStreaming:!1,tokenCount:0,inputTokenCount:0,outputTokenCount:0,processingTime:0,inputValue:"",cursorPosition:0,inputHistory:[],historyIndex:-1,showHelp:!1,showModelSelector:!1,exitConfirmation:!1,exitConfirmationTime:0,showCommandSuggestions:!1,selectedCommandIndex:0,commandSuggestions:[],showModelSelection:!1,selectedModelIndex:0,availableModels:["grok-4-latest","grok-3-latest","grok-4","grok-3","grok-beta"],showCommandForm:!1,stageStack:[{id:"main",type:"chat"}],autoEditEnabled:!1,vsCodeOpenEnabled:!1,dangerousBypassPermission:!1,virtualScrollingEnabled:!0,confirmationSettings:{alwaysEdit:!1,alwaysBash:!1,alwaysSearch:!1},theme:"auto",model:"grok-beta",confirmationOptions:null,confirmationResolver:null}),Ne={setAgent(r){T.agent=r,T.initError=null},async initializeAgent(r){T.isInitializing=!0,T.initError=null;try{let{GrokAgent:e}=await Promise.resolve().then(()=>(Yu(),Xu)),t=new e(r);T.agent=t,T.isInitializing=!1}catch(e){throw T.isInitializing=!1,T.initError=e instanceof Error?e.message:"Unknown error",e}},clearAgent(){T.agent=null,T.initError=null},setInitializing(r){T.isInitializing=r},setInitError(r){T.initError=r},addMessage(r){let e=`msg-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,t={...r,id:e,timestamp:new Date};T.messages.push(t),T.messageCount=T.messages.length},updateMessage(r,e){let t=T.messages.findIndex(n=>n.id===r);t!==-1&&Object.assign(T.messages[t],e)},clearMessages(){T.messages=[],T.messageCount=0},setMessages(r){T.messages=r,T.messageCount=r.length},startStreaming(r){let e=T.messages.find(t=>t.id===r);e&&(e.metadata||(e.metadata={}),e.metadata.isStreaming=!0)},appendToMessage(r,e){let t=T.messages.find(n=>n.id===r);t&&(t.content+=e)},finishStreaming(r,e){let t=T.messages.find(n=>n.id===r);t&&(t.metadata||(t.metadata={}),Object.assign(t.metadata,e),t.metadata.isStreaming=!1)},addToolCalls(r,e){let t=T.messages.find(n=>n.id===r);t&&(t.toolCalls=e)},addExecution(r){let e=`exec-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,t={...r,id:e,status:"executing",startTime:new Date};return T.executions.set(e,t),T.activeExecutions.push(e),e},updateExecution(r,e){let t=T.executions.get(r);t&&(Object.assign(t,e),T.executions.set(r,t))},completeExecution(r,e){let t=T.executions.get(r);t&&(t.status="completed",t.result=e,t.endTime=new Date,T.executions.set(r,t),T.activeExecutions=T.activeExecutions.filter(n=>n!==r))},failExecution(r,e){let t=T.executions.get(r);t&&(t.status="failed",t.result={success:!1,error:e},t.endTime=new Date,T.executions.set(r,t),T.activeExecutions=T.activeExecutions.filter(n=>n!==r))},getExecution(r){return T.executions.get(r)},clearExecutions(){T.executions=new Map,T.activeExecutions=[]},setProcessing(r){T.isProcessing=r},setStreaming(r){T.isStreaming=r},updateTokenCount(r){T.tokenCount=r,T.outputTokenCount=r},updateInputTokenCount(r){T.inputTokenCount=r},updateOutputTokenCount(r){T.outputTokenCount=r,T.tokenCount=r},updateProcessingTime(r){T.processingTime=r},setInputValue(r){T.inputValue=r},getInputValue(){return T.inputValue},setCursorPosition(r){T.cursorPosition=r},addToHistory(r){if(!r.trim())return;let t=[...T.inputHistory.filter(n=>n!==r),r];T.inputHistory=t.length>100?t.slice(-100):t,T.historyIndex=-1},navigateHistory(r){if(r==="up"){let e=T.historyIndex===-1?T.inputHistory.length-1:Math.max(0,T.historyIndex-1);e>=0&&e<T.inputHistory.length&&(T.historyIndex=e,T.inputValue=T.inputHistory[e],T.cursorPosition=T.inputHistory[e].length)}else{if(T.historyIndex===-1)return;let e=T.historyIndex+1;e>=T.inputHistory.length?(T.historyIndex=-1,T.inputValue="",T.cursorPosition=0):(T.historyIndex=e,T.inputValue=T.inputHistory[e],T.cursorPosition=T.inputHistory[e].length)}},toggleHelp(){T.showHelp=!T.showHelp},toggleModelSelector(){T.showModelSelector=!T.showModelSelector},setExitConfirmation(r){T.exitConfirmation=r,r&&(T.exitConfirmationTime=Date.now())},setAutoEdit(r){T.autoEditEnabled=r,Ne.saveSettings()},setVSCodeOpen(r){T.vsCodeOpenEnabled=r,Ne.saveSettings()},setDangerousBypassPermission(r){T.dangerousBypassPermission=r,Ne.saveSettings()},setVirtualScrolling(r){T.virtualScrollingEnabled=r,Ne.saveSettings()},updateConfirmationSettings(r){Object.assign(T.confirmationSettings,r),Ne.saveSettings()},setTheme(r){T.theme=r,Ne.saveSettings()},setModel(r){T.model=r,Ne.saveSettings()},setShowCommandForm(r){T.showCommandForm=r},setShowHelp(r){T.showHelp=r},async loadSettings(){try{let{SettingsManager:r}=await Promise.resolve().then(()=>(Ml(),bd)),e=r.getInstance(),{settings:t,isValid:n}=e.loadSettings();n&&t&&(t.model&&(T.model=t.model),t.theme&&(T.theme=t.theme),t.autoEditEnabled!==void 0&&(T.autoEditEnabled=t.autoEditEnabled),t.vsCodeOpenEnabled!==void 0&&(T.vsCodeOpenEnabled=t.vsCodeOpenEnabled),t.dangerousBypassPermission!==void 0&&(T.dangerousBypassPermission=t.dangerousBypassPermission),t.virtualScrollingEnabled!==void 0&&(T.virtualScrollingEnabled=t.virtualScrollingEnabled),t.confirmationSettings&&Object.assign(T.confirmationSettings,t.confirmationSettings))}catch(r){D.error("Failed to load settings:",r)}},async saveSettings(){try{let r={autoEditEnabled:T.autoEditEnabled,vsCodeOpenEnabled:T.vsCodeOpenEnabled,dangerousBypassPermission:T.dangerousBypassPermission,virtualScrollingEnabled:T.virtualScrollingEnabled,confirmationSettings:T.confirmationSettings,theme:T.theme,model:T.model}}catch(r){D.error("Failed to save settings:",r)}},requestConfirmation(r){return new Promise(e=>{T.confirmationOptions=r,T.confirmationResolver=e})},respondToConfirmation(r){T.confirmationResolver&&(T.confirmationResolver(r),T.confirmationOptions=null,T.confirmationResolver=null)},cancelConfirmation(){T.confirmationResolver&&(T.confirmationResolver({confirmed:!1}),T.confirmationOptions=null,T.confirmationResolver=null)},updateFile(r,e){let t=Ll.createHash("sha256").update(e).digest("hex"),n=e.split(`
`).length;T.trackedFiles.set(r,{hash:t,lastRead:new Date,lineCount:n})},hasFile(r){return T.trackedFiles.has(r)},getFileInfo(r){return T.trackedFiles.get(r)},verifyFileHash(r,e){let t=T.trackedFiles.get(r);if(!t)return!1;let n=Ll.createHash("sha256").update(e).digest("hex");return t.hash===n},clearFile(r){T.trackedFiles.delete(r)},clearAllFiles(){T.trackedFiles.clear()},getCurrentStage(){return T.stageStack[T.stageStack.length-1]},pushStage(r){T.stageStack.push(r)},popStage(){T.stageStack.length>1&&T.stageStack.pop()},replaceStage(r){T.stageStack.length>0&&(T.stageStack[T.stageStack.length-1]=r)},clearStages(){T.stageStack=[{id:"main",type:"chat"}]},getStageStack(){return T.stageStack}},it={updateFile:Ne.updateFile,hasFile:Ne.hasFile,getFileInfo:Ne.getFileInfo,verifyFileHash:Ne.verifyFileHash,clearFile:Ne.clearFile,clearAllFiles:Ne.clearAllFiles}});var xd=x(()=>{os()});var wd,Xe,is=x(()=>{wd=require("events");xd();Xe=class r extends wd.EventEmitter{constructor(){super();this.skipConfirmationThisSession=!1;this.pendingConfirmation=null;this.resolveConfirmation=null;this.sessionFlags={fileOperations:!1,bashCommands:!1,allOperations:!1,createFiles:!1,editFiles:!1}}static getInstance(){return r.instance||(r.instance=new r),r.instance}async requestConfirmation(t,n="file"){if(T.dangerousBypassPermission)return{confirmed:!0};if(T.autoEditEnabled&&(n==="file_edit"||n==="file_create"))return{confirmed:!0};if(this.sessionFlags.allOperations||n==="file"&&this.sessionFlags.fileOperations||n==="bash"&&this.sessionFlags.bashCommands||n==="file_create"&&this.sessionFlags.createFiles||n==="file_edit"&&this.sessionFlags.editFiles)return{confirmed:!0};this.pendingConfirmation=new Promise(o=>{this.resolveConfirmation=o}),setImmediate(()=>{this.emit("confirmation-requested",t)});let s=await this.pendingConfirmation;return s.dontAskAgain&&(n==="file"?this.sessionFlags.fileOperations=!0:n==="bash"?this.sessionFlags.bashCommands=!0:n==="file_create"?this.sessionFlags.createFiles=!0:n==="file_edit"&&(this.sessionFlags.editFiles=!0)),s}confirmOperation(t,n){this.resolveConfirmation&&(this.resolveConfirmation({confirmed:t,dontAskAgain:n}),this.resolveConfirmation=null,this.pendingConfirmation=null)}rejectOperation(t){this.resolveConfirmation&&(this.resolveConfirmation({confirmed:!1,feedback:t}),this.resolveConfirmation=null,this.pendingConfirmation=null)}isPending(){return this.pendingConfirmation!==null}resetSession(){this.sessionFlags={fileOperations:!1,bashCommands:!1,allOperations:!1,createFiles:!1,editFiles:!1}}getSessionFlags(){return{...this.sessionFlags}}setSessionFlag(t,n){this.sessionFlags[t]=n}}});function Bl(r,e=!0){return process.stdout.isTTY&&!process.env.CI?new Nl:new Dl(`[${r}]`,e)}var Dl,Nl,jl=x(()=>{Dl=class{constructor(e="[Tool]",t=!0){this.prefix=e,this.enabled=t}debug(e,...t){this.enabled&&process.env.DEBUG==="true"&&console.log(`${this.prefix} DEBUG:`,e,...t)}info(e,...t){this.enabled&&console.log(`${this.prefix} INFO:`,e,...t)}warn(e,...t){this.enabled&&console.warn(`${this.prefix} WARN:`,e,...t)}error(e,...t){this.enabled&&console.error(`${this.prefix} ERROR:`,e,...t)}};Nl=class{debug(){}info(){}warn(){}error(){}}});function Qu(r){return new Ul(r)}var Ul,vd=x(()=>{lo();Ii();is();jl();Ul=class{constructor(e=process.cwd()){this.tools=new Map;this.context={registry:this,workingDirectory:e,confirmationService:Xe.getInstance(),state:new Map}}register(e){if(this.tools.has(e.id))throw new Error(`Tool with id '${e.id}' already registered`);this.tools.set(e.id,{definition:e,initialized:!1,executionCount:0,totalDuration:0})}async unregister(e){let t=this.tools.get(e);if(!t)throw new Error(`Tool '${e}' not found`);t.definition.cleanup&&t.initialized&&await t.definition.cleanup(this.context),this.tools.delete(e)}get(e){return this.tools.get(e)}list(e){let t=Array.from(this.tools.values()).map(n=>n.definition);return e&&(e.category&&(t=t.filter(n=>n.category===e.category)),e.capabilities&&e.capabilities.length>0&&(t=t.filter(n=>n.capabilities&&e.capabilities.every(s=>n.capabilities.includes(s)))),e.tags&&e.tags.length>0&&(t=t.filter(n=>n.tags&&e.tags.some(s=>n.tags.includes(s)))),e.composable!==void 0&&(t=t.filter(n=>n.composable===e.composable))),t}search(e){let t=e.toLowerCase();return Array.from(this.tools.values()).map(n=>n.definition).filter(n=>[n.id,n.name,n.description,...n.tags||[]].join(" ").toLowerCase().includes(t))}async execute(e,t){let n=this.tools.get(e);if(!n)return{success:!1,error:`Tool '${e}' not found`};let s=n.definition,o=this.validateArguments(e,t);if(!o.valid)return{success:!1,error:`Validation failed: ${o.errors.map(a=>a.message).join(", ")}`};if(!n.initialized&&s.initialize)try{let a={...this.context,logger:Bl(e)};await s.initialize(a),n.initialized=!0}catch(a){return{success:!1,error:`Failed to initialize tool: ${a instanceof Error?a.message:String(a)}`}}let i=Date.now();try{let a={...this.context,logger:Bl(e)},l=await s.execute(t,a),u=Date.now()-i;return n.executionCount++,n.lastExecuted=new Date,n.totalDuration+=u,l}catch(a){return{success:!1,error:`Tool execution failed: ${a instanceof Error?a.message:String(a)}`}}}compose(e,t,n){let s=t.map(o=>{let i=this.get(o);if(!i)throw new Error(`Tool '${o}' not found for composition`);return i.definition});return lc(e,s,n||{})}validateArguments(e,t){let n=this.get(e);return n?ic(n.definition.arguments||[],t):{valid:!1,errors:[{field:"toolId",message:`Tool '${e}' not found`}]}}getContext(){return this.context}setWorkingDirectory(e){this.context.workingDirectory=e}getStats(){let e=Array.from(this.tools.entries()),t={},n={};e.forEach(([o,i])=>{let a=i.definition;a.category&&(t[a.category]=(t[a.category]||0)+1),a.capabilities&&a.capabilities.forEach(l=>{n[l]=(n[l]||0)+1})});let s=e.map(([o,i])=>({toolId:o,count:i.executionCount})).filter(o=>o.count>0).sort((o,i)=>i.count-o.count).slice(0,10);return{totalTools:e.length,byCategory:t,byCapability:n,mostUsed:s}}getExecutionStats(){let e={};return this.tools.forEach((t,n)=>{e[n]={executionCount:t.executionCount,totalDuration:t.totalDuration}}),e}}});function ee(){return new Wl}var Wl,Td=x(()=>{Wl=class{constructor(){this.metadata={};this.args=[];this.schemas={}}id(e){return this.metadata.id=e,this}name(e){return this.metadata.name=e,this}description(e){return this.metadata.description=e,this}version(e){return this.metadata.version=e,this}author(e){return this.metadata.author=e,this}category(e){return this.metadata.category=e,this}tags(...e){return this.metadata.tags=[...this.metadata.tags||[],...e],this}capabilities(...e){return this.metadata.capabilities=[...this.metadata.capabilities||[],...e],this}argument(e){return this.args.push(e),this}stringArg(e,t,n){return this.argument({name:e,type:"string",description:t,...n})}numberArg(e,t,n){return this.argument({name:e,type:"number",description:t,...n})}booleanArg(e,t,n){return this.argument({name:e,type:"boolean",description:t,...n})}arrayArg(e,t,n){return this.argument({name:e,type:"array",description:t,...n})}inputSchema(e){return this.schemas.input=e,this}outputSchema(e){return this.schemas.output=e,this}composable(e=!0){return this.isComposable=e,this}execute(e){return this.executor=e,this}onInitialize(e){return this.initHook=e,this}onCleanup(e){return this.cleanupHook=e,this}renderResult(e){return this.renderer=e,this}examples(e){return this.examplesList=e,this}build(){if(!this.metadata.id)throw new Error("Tool ID is required");if(this.metadata.name||(this.metadata.name=this.metadata.id),!this.metadata.description)throw new Error("Tool description is required");if(!this.executor)throw new Error("Tool executor is required");let e={id:this.metadata.id,name:this.metadata.name,description:this.metadata.description,version:this.metadata.version,author:this.metadata.author,tags:this.metadata.tags,category:this.metadata.category,capabilities:this.metadata.capabilities,arguments:this.args.length>0?this.args:void 0,execute:this.executor,composable:this.isComposable,inputSchema:this.schemas.input,outputSchema:this.schemas.output,renderResult:this.renderer,examples:this.examplesList};return this.initHook&&(e.initialize=this.initHook),this.cleanupHook&&(e.cleanup=this.cleanupHook),e}}});function qh(r){let e={},t=[];if(r.arguments)for(let n of r.arguments)e[n.name]=zh(n),n.required&&t.push(n.name);return{type:"function",function:{name:r.id,description:Vh(r),parameters:{type:"object",properties:e,required:t}}}}function zh(r){let e={type:Hh(r.type),description:r.description};return r.enum&&(e.enum=r.enum),r.default!==void 0&&(e.default=r.default),e}function Hh(r){switch(r){case"any":return"string";default:return r}}function Vh(r){let e=[r.description];if(r.capabilities&&r.capabilities.length>0){let t=r.capabilities.map(n=>Gh(n)).filter(n=>n).join(", ");t&&e.push(`Capabilities: ${t}`)}return r.tags&&r.tags.length>0&&e.push(`Tags: ${r.tags.join(", ")}`),r.examples&&r.examples.length>0&&(e.push(`

Examples:`),r.examples.forEach((t,n)=>{e.push(`
Example ${n+1}: ${t.description}`),e.push(`Arguments: ${JSON.stringify(t.arguments,null,2)}`),t.result&&e.push(`Expected result: ${t.result}`)})),e.join(". ")}function Gh(r){return{"file:read":"read files","file:write":"write files","system:execute":"execute system commands","network:access":"access network resources","user:confirmation":"request user confirmation"}[r]||""}function ed(r){return r.list().map(t=>qh(t))}var kd=x(()=>{ao();lo()});var tn,cr,Te,J,vt=x(()=>{tn=j(require("react"),1),cr=require("ink"),Te=({children:r,style:e="simple",isLast:t=!0,level:n=0,indicatorColor:s="gray"})=>{let o="  ".repeat(n),i="";switch(e){case"tree":i=t?"\u2514\u2500":"\u251C\u2500";break;case"simple":i="\u23BF";break;case"none":i="";break}return e==="none"?tn.default.createElement(cr.Box,{marginLeft:n*2},r):tn.default.createElement(cr.Box,null,tn.default.createElement(cr.Text,{color:s},o,i," "),tn.default.createElement(cr.Box,{flexDirection:"column",flexGrow:1,paddingLeft:i?1:0},r))},J=({indicator:r="\u23BF",indicatorColor:e="gray",children:t})=>tn.default.createElement(cr.Box,null,tn.default.createElement(cr.Text,{color:e},r),t)});var Ad=$i((hA,fi)=>{var Zh=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};var L=function(r){var e=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,t=0,n={},s={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function d(p){return p instanceof o?new o(p.type,d(p.content),p.alias):Array.isArray(p)?p.map(d):p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(d){return Object.prototype.toString.call(d).slice(8,-1)},objId:function(d){return d.__id||Object.defineProperty(d,"__id",{value:++t}),d.__id},clone:function d(p,_){_=_||{};var g,y;switch(s.util.type(p)){case"Object":if(y=s.util.objId(p),_[y])return _[y];g={},_[y]=g;for(var b in p)p.hasOwnProperty(b)&&(g[b]=d(p[b],_));return g;case"Array":return y=s.util.objId(p),_[y]?_[y]:(g=[],_[y]=g,p.forEach(function(C,E){g[E]=d(C,_)}),g);default:return p}},getLanguage:function(d){for(;d;){var p=e.exec(d.className);if(p)return p[1].toLowerCase();d=d.parentElement}return"none"},setLanguage:function(d,p){d.className=d.className.replace(RegExp(e,"gi"),""),d.classList.add("language-"+p)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(g){var d=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(g.stack)||[])[1];if(d){var p=document.getElementsByTagName("script");for(var _ in p)if(p[_].src==d)return p[_]}return null}},isActive:function(d,p,_){for(var g="no-"+p;d;){var y=d.classList;if(y.contains(p))return!0;if(y.contains(g))return!1;d=d.parentElement}return!!_}},languages:{plain:n,plaintext:n,text:n,txt:n,extend:function(d,p){var _=s.util.clone(s.languages[d]);for(var g in p)_[g]=p[g];return _},insertBefore:function(d,p,_,g){g=g||s.languages;var y=g[d],b={};for(var C in y)if(y.hasOwnProperty(C)){if(C==p)for(var E in _)_.hasOwnProperty(E)&&(b[E]=_[E]);_.hasOwnProperty(C)||(b[C]=y[C])}var I=g[d];return g[d]=b,s.languages.DFS(s.languages,function(K,G){G===I&&K!=d&&(this[K]=b)}),b},DFS:function d(p,_,g,y){y=y||{};var b=s.util.objId;for(var C in p)if(p.hasOwnProperty(C)){_.call(p,C,p[C],g||C);var E=p[C],I=s.util.type(E);I==="Object"&&!y[b(E)]?(y[b(E)]=!0,d(E,_,null,y)):I==="Array"&&!y[b(E)]&&(y[b(E)]=!0,d(E,_,C,y))}}},plugins:{},highlightAll:function(d,p){s.highlightAllUnder(document,d,p)},highlightAllUnder:function(d,p,_){var g={callback:_,container:d,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};s.hooks.run("before-highlightall",g),g.elements=Array.prototype.slice.apply(g.container.querySelectorAll(g.selector)),s.hooks.run("before-all-elements-highlight",g);for(var y=0,b;b=g.elements[y++];)s.highlightElement(b,p===!0,g.callback)},highlightElement:function(d,p,_){var g=s.util.getLanguage(d),y=s.languages[g];s.util.setLanguage(d,g);var b=d.parentElement;b&&b.nodeName.toLowerCase()==="pre"&&s.util.setLanguage(b,g);var C=d.textContent,E={element:d,language:g,grammar:y,code:C};function I(G){E.highlightedCode=G,s.hooks.run("before-insert",E),E.element.innerHTML=E.highlightedCode,s.hooks.run("after-highlight",E),s.hooks.run("complete",E),_&&_.call(E.element)}if(s.hooks.run("before-sanity-check",E),b=E.element.parentElement,b&&b.nodeName.toLowerCase()==="pre"&&!b.hasAttribute("tabindex")&&b.setAttribute("tabindex","0"),!E.code){s.hooks.run("complete",E),_&&_.call(E.element);return}if(s.hooks.run("before-highlight",E),!E.grammar){I(s.util.encode(E.code));return}if(p&&r.Worker){var K=new Worker(s.filename);K.onmessage=function(G){I(G.data)},K.postMessage(JSON.stringify({language:E.language,code:E.code,immediateClose:!0}))}else I(s.highlight(E.code,E.grammar,E.language))},highlight:function(d,p,_){var g={code:d,grammar:p,language:_};if(s.hooks.run("before-tokenize",g),!g.grammar)throw new Error('The language "'+g.language+'" has no grammar.');return g.tokens=s.tokenize(g.code,g.grammar),s.hooks.run("after-tokenize",g),o.stringify(s.util.encode(g.tokens),g.language)},tokenize:function(d,p){var _=p.rest;if(_){for(var g in _)p[g]=_[g];delete p.rest}var y=new l;return u(y,y.head,d),a(d,y,p,y.head,0),f(y)},hooks:{all:{},add:function(d,p){var _=s.hooks.all;_[d]=_[d]||[],_[d].push(p)},run:function(d,p){var _=s.hooks.all[d];if(!(!_||!_.length))for(var g=0,y;y=_[g++];)y(p)}},Token:o};r.Prism=s;function o(d,p,_,g){this.type=d,this.content=p,this.alias=_,this.length=(g||"").length|0}o.stringify=function d(p,_){if(typeof p=="string")return p;if(Array.isArray(p)){var g="";return p.forEach(function(I){g+=d(I,_)}),g}var y={type:p.type,content:d(p.content,_),tag:"span",classes:["token",p.type],attributes:{},language:_},b=p.alias;b&&(Array.isArray(b)?Array.prototype.push.apply(y.classes,b):y.classes.push(b)),s.hooks.run("wrap",y);var C="";for(var E in y.attributes)C+=" "+E+'="'+(y.attributes[E]||"").replace(/"/g,"&quot;")+'"';return"<"+y.tag+' class="'+y.classes.join(" ")+'"'+C+">"+y.content+"</"+y.tag+">"};function i(d,p,_,g){d.lastIndex=p;var y=d.exec(_);if(y&&g&&y[1]){var b=y[1].length;y.index+=b,y[0]=y[0].slice(b)}return y}function a(d,p,_,g,y,b){for(var C in _)if(!(!_.hasOwnProperty(C)||!_[C])){var E=_[C];E=Array.isArray(E)?E:[E];for(var I=0;I<E.length;++I){if(b&&b.cause==C+","+I)return;var K=E[I],G=K.inside,ne=!!K.lookbehind,X=!!K.greedy,Ut=K.alias;if(X&&!K.pattern.global){var ps=K.pattern.toString().match(/[imsuy]*$/)[0];K.pattern=RegExp(K.pattern.source,ps+"g")}for(var to=K.pattern||K,me=g.next,ct=y;me!==p.tail&&!(b&&ct>=b.reach);ct+=me.value.length,me=me.next){var an=me.value;if(p.length>d.length)return;if(!(an instanceof o)){var ro=1,et;if(X){if(et=i(to,ct,d,ne),!et||et.index>=d.length)break;var no=et.index,Nf=et.index+et[0].length,Wt=ct;for(Wt+=me.value.length;no>=Wt;)me=me.next,Wt+=me.value.length;if(Wt-=me.value.length,ct=Wt,me.value instanceof o)continue;for(var ms=me;ms!==p.tail&&(Wt<Nf||typeof ms.value=="string");ms=ms.next)ro++,Wt+=ms.value.length;ro--,an=d.slice(ct,Wt),et.index-=ct}else if(et=i(to,0,an,ne),!et)continue;var no=et.index,so=et[0],Si=an.slice(0,no),sc=an.slice(no+so.length),Ci=ct+an.length;b&&Ci>b.reach&&(b.reach=Ci);var oo=me.prev;Si&&(oo=u(p,oo,Si),ct+=Si.length),c(p,oo,ro);var Bf=new o(C,G?s.tokenize(so,G):so,Ut,so);if(me=u(p,oo,Bf),sc&&u(p,me,sc),ro>1){var Ei={cause:C+","+I,reach:Ci};a(d,p,_,me.prev,ct,Ei),b&&Ei.reach>b.reach&&(b.reach=Ei.reach)}}}}}}function l(){var d={value:null,prev:null,next:null},p={value:null,prev:d,next:null};d.next=p,this.head=d,this.tail=p,this.length=0}function u(d,p,_){var g=p.next,y={value:_,prev:p,next:g};return p.next=y,g.prev=y,d.length++,y}function c(d,p,_){for(var g=p.next,y=0;y<_&&g!==d.tail;y++)g=g.next;p.next=g,g.prev=p,d.length-=y}function f(d){for(var p=[],_=d.head.next;_!==d.tail;)p.push(_.value),_=_.next;return p}if(!r.document)return r.addEventListener&&(s.disableWorkerMessageHandler||r.addEventListener("message",function(d){var p=JSON.parse(d.data),_=p.language,g=p.code,y=p.immediateClose;r.postMessage(s.highlight(g,s.languages[_],_)),y&&r.close()},!1)),s;var m=s.util.currentScript();m&&(s.filename=m.src,m.hasAttribute("data-manual")&&(s.manual=!0));function h(){s.manual||s.highlightAll()}if(!s.manual){var v=document.readyState;v==="loading"||v==="interactive"&&m&&m.defer?document.addEventListener("DOMContentLoaded",h):window.requestAnimationFrame?window.requestAnimationFrame(h):window.setTimeout(h,16)}return s}(Zh);typeof fi<"u"&&fi.exports&&(fi.exports=L);typeof global<"u"&&(global.Prism=L);L.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};L.languages.markup.tag.inside["attr-value"].inside.entity=L.languages.markup.entity;L.languages.markup.doctype.inside["internal-subset"].inside=L.languages.markup;L.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))});Object.defineProperty(L.languages.markup.tag,"addInlined",{value:function(e,t){var n={};n["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:L.languages[t]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};s["language-"+t]={pattern:/[\s\S]+/,inside:L.languages[t]};var o={};o[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return e}),"i"),lookbehind:!0,greedy:!0,inside:s},L.languages.insertBefore("markup","cdata",o)}});Object.defineProperty(L.languages.markup.tag,"addAttribute",{value:function(r,e){L.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[e,"language-"+e],inside:L.languages[e]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});L.languages.html=L.languages.markup;L.languages.mathml=L.languages.markup;L.languages.svg=L.languages.markup;L.languages.xml=L.languages.extend("markup",{});L.languages.ssml=L.languages.xml;L.languages.atom=L.languages.xml;L.languages.rss=L.languages.xml;(function(r){var e=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+e.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+e.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+e.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+e.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:e,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var t=r.languages.markup;t&&(t.tag.addInlined("style","css"),t.tag.addAttribute("style","css"))})(L);L.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};L.languages.javascript=L.languages.extend("clike",{"class-name":[L.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});L.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;L.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:L.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:L.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:L.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:L.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:L.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});L.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:L.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});L.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});L.languages.markup&&(L.languages.markup.tag.addInlined("script","javascript"),L.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));L.languages.js=L.languages.javascript;(function(){if(typeof L>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading\u2026",e=function(m,h){return"\u2716 Error "+m+" while fetching file: "+h},t="\u2716 Error: File does not exist or is empty",n={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},s="data-src-status",o="loading",i="loaded",a="failed",l="pre[data-src]:not(["+s+'="'+i+'"]):not(['+s+'="'+o+'"])';function u(m,h,v){var d=new XMLHttpRequest;d.open("GET",m,!0),d.onreadystatechange=function(){d.readyState==4&&(d.status<400&&d.responseText?h(d.responseText):d.status>=400?v(e(d.status,d.statusText)):v(t))},d.send(null)}function c(m){var h=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(m||"");if(h){var v=Number(h[1]),d=h[2],p=h[3];return d?p?[v,Number(p)]:[v,void 0]:[v,v]}}L.hooks.add("before-highlightall",function(m){m.selector+=", "+l}),L.hooks.add("before-sanity-check",function(m){var h=m.element;if(h.matches(l)){m.code="",h.setAttribute(s,o);var v=h.appendChild(document.createElement("CODE"));v.textContent=r;var d=h.getAttribute("data-src"),p=m.language;if(p==="none"){var _=(/\.(\w+)$/.exec(d)||[,"none"])[1];p=n[_]||_}L.util.setLanguage(v,p),L.util.setLanguage(h,p);var g=L.plugins.autoloader;g&&g.loadLanguages(p),u(d,function(y){h.setAttribute(s,i);var b=c(h.getAttribute("data-range"));if(b){var C=y.split(/\r\n?|\n/g),E=b[0],I=b[1]==null?C.length:b[1];E<0&&(E+=C.length),E=Math.max(0,Math.min(E-1,C.length)),I<0&&(I+=C.length),I=Math.max(0,Math.min(I,C.length)),y=C.slice(E,I).join(`
`),h.hasAttribute("data-start")||h.setAttribute("data-start",String(E+1))}v.textContent=y,L.highlightElement(v)},function(y){h.setAttribute(s,a),v.textContent=y})}}),L.plugins.fileHighlight={highlight:function(h){for(var v=(h||document).querySelectorAll(l),d=0,p;p=v[d++];)L.highlightElement(p)}};var f=!1;L.fileHighlight=function(){f||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),f=!0),L.plugins.fileHighlight.highlight.apply(this,arguments)}})()});var Sd=x(()=>{Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript});var Cd=x(()=>{(function(r){r.languages.typescript=r.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),r.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete r.languages.typescript.parameter,delete r.languages.typescript["literal-property"];var e=r.languages.extend("typescript",{});delete e["class-name"],r.languages.typescript["class-name"].inside=e,r.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e}}}}),r.languages.ts=r.languages.typescript})(Prism)});var Ed=x(()=>{(function(r){var e=r.util.clone(r.languages.javascript),t=/(?:\s|\/\/.*(?!.)|\/\*(?:[^*]|\*(?!\/))\*\/)/.source,n=/(?:\{(?:\{(?:\{[^{}]*\}|[^{}])*\}|[^{}])*\})/.source,s=/(?:\{<S>*\.{3}(?:[^{}]|<BRACES>)*\})/.source;function o(l,u){return l=l.replace(/<S>/g,function(){return t}).replace(/<BRACES>/g,function(){return n}).replace(/<SPREAD>/g,function(){return s}),RegExp(l,u)}s=o(s).source,r.languages.jsx=r.languages.extend("markup",e),r.languages.jsx.tag.pattern=o(/<\/?(?:[\w.:-]+(?:<S>+(?:[\w.:$-]+(?:=(?:"(?:\\[\s\S]|[^\\"])*"|'(?:\\[\s\S]|[^\\'])*'|[^\s{'"/>=]+|<BRACES>))?|<SPREAD>))*<S>*\/?)?>/.source),r.languages.jsx.tag.inside.tag.pattern=/^<\/?[^\s>\/]*/,r.languages.jsx.tag.inside["attr-value"].pattern=/=(?!\{)(?:"(?:\\[\s\S]|[^\\"])*"|'(?:\\[\s\S]|[^\\'])*'|[^\s'">]+)/,r.languages.jsx.tag.inside.tag.inside["class-name"]=/^[A-Z]\w*(?:\.[A-Z]\w*)*$/,r.languages.jsx.tag.inside.comment=e.comment,r.languages.insertBefore("inside","attr-name",{spread:{pattern:o(/<SPREAD>/.source),inside:r.languages.jsx}},r.languages.jsx.tag),r.languages.insertBefore("inside","special-attr",{script:{pattern:o(/=<BRACES>/.source),alias:"language-javascript",inside:{"script-punctuation":{pattern:/^=(?=\{)/,alias:"punctuation"},rest:r.languages.jsx}}},r.languages.jsx.tag);var i=function(l){return l?typeof l=="string"?l:typeof l.content=="string"?l.content:l.content.map(i).join(""):""},a=function(l){for(var u=[],c=0;c<l.length;c++){var f=l[c],m=!1;if(typeof f!="string"&&(f.type==="tag"&&f.content[0]&&f.content[0].type==="tag"?f.content[0].content[0].content==="</"?u.length>0&&u[u.length-1].tagName===i(f.content[0].content[1])&&u.pop():f.content[f.content.length-1].content==="/>"||u.push({tagName:i(f.content[0].content[1]),openedBraces:0}):u.length>0&&f.type==="punctuation"&&f.content==="{"?u[u.length-1].openedBraces++:u.length>0&&u[u.length-1].openedBraces>0&&f.type==="punctuation"&&f.content==="}"?u[u.length-1].openedBraces--:m=!0),(m||typeof f=="string")&&u.length>0&&u[u.length-1].openedBraces===0){var h=i(f);c<l.length-1&&(typeof l[c+1]=="string"||l[c+1].type==="plain-text")&&(h+=i(l[c+1]),l.splice(c+1,1)),c>0&&(typeof l[c-1]=="string"||l[c-1].type==="plain-text")&&(h=i(l[c-1])+h,l.splice(c-1,1),c--),l[c]=new r.Token("plain-text",h,null,h)}f.content&&typeof f.content!="string"&&a(f.content)}};r.hooks.add("after-tokenize",function(l){l.language!=="jsx"&&l.language!=="tsx"||a(l.tokens)})})(Prism)});var $d=x(()=>{(function(r){var e=r.util.clone(r.languages.typescript);r.languages.tsx=r.languages.extend("jsx",e),delete r.languages.tsx.parameter,delete r.languages.tsx["literal-property"];var t=r.languages.tsx.tag;t.pattern=RegExp(/(^|[^\w$]|(?=<\/))/.source+"(?:"+t.pattern.source+")",t.pattern.flags),t.lookbehind=!0})(Prism)});var Id=x(()=>{Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json});var Pd=x(()=>{(function(r){var e=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+e.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+e.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+e.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+e.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:e,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var t=r.languages.markup;t&&(t.tag.addInlined("style","css"),t.tag.addAttribute("style","css"))})(Prism)});var Rd=x(()=>{Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/};Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python;Prism.languages.py=Prism.languages.python});var Od=x(()=>{(function(r){var e="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",t={pattern:/(^(["']?)\w+\2)[ \t]+\S.*/,lookbehind:!0,alias:"punctuation",inside:null},n={bash:t,environment:{pattern:RegExp("\\$"+e),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--|\+\+|\*\*=?|<<=?|>>=?|&&|\|\||[=!+\-*/%<>^&|]=?|[?~:]/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+e),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};r.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)[\w-]+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b[\w-]+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?:\.\w+)*(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+e),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\s)-{1,2}(?:\w+:[+-]?)?\w+(?:\.\w+)*(?=[=\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+)\s[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:n},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0,inside:{bash:t}},{pattern:/(^|[^\\](?:\\\\)*)"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/,lookbehind:!0,greedy:!0,inside:n},{pattern:/(^|[^$\\])'[^']*'/,lookbehind:!0,greedy:!0},{pattern:/\$'(?:[^'\\]|\\[\s\S])*'/,greedy:!0,inside:{entity:n.entity}}],environment:{pattern:RegExp("\\$?"+e),alias:"constant"},variable:n.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:false|true)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|=[=~]?|!=?|<<[<-]?|[&\d]?>>|\d[<>]&?|[<>][&=]?|&[>&]?|\|[&|]?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}},t.inside=r.languages.bash;for(var s=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],o=n.variable[1].inside,i=0;i<s.length;i++)o[s[i]]=r.languages.bash[s[i]];r.languages.sh=r.languages.bash,r.languages.shell=r.languages.bash})(Prism)});var Fd=x(()=>{(function(r){var e=/[*&][^\s[\]{},]+/,t=/!(?:<[\w\-%#;/?:@&=+$,.!~*'()[\]]+>|(?:[a-zA-Z\d-]*!)?[\w\-%#;/?:@&=+$.~*'()]+)?/,n="(?:"+t.source+"(?:[ 	]+"+e.source+")?|"+e.source+"(?:[ 	]+"+t.source+")?)",s=/(?:[^\s\x00-\x08\x0e-\x1f!"#%&'*,\-:>?@[\]`{|}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]|[?:-]<PLAIN>)(?:[ \t]*(?:(?![#:])<PLAIN>|:<PLAIN>))*/.source.replace(/<PLAIN>/g,function(){return/[^\s\x00-\x08\x0e-\x1f,[\]{}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]/.source}),o=/"(?:[^"\\\r\n]|\\.)*"|'(?:[^'\\\r\n]|\\.)*'/.source;function i(a,l){l=(l||"").replace(/m/g,"")+"m";var u=/([:\-,[{]\s*(?:\s<<prop>>[ \t]+)?)(?:<<value>>)(?=[ \t]*(?:$|,|\]|\}|(?:[\r\n]\s*)?#))/.source.replace(/<<prop>>/g,function(){return n}).replace(/<<value>>/g,function(){return a});return RegExp(u,l)}r.languages.yaml={scalar:{pattern:RegExp(/([\-:]\s*(?:\s<<prop>>[ \t]+)?[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)\S[^\r\n]*(?:\2[^\r\n]+)*)/.source.replace(/<<prop>>/g,function(){return n})),lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:RegExp(/((?:^|[:\-,[{\r\n?])[ \t]*(?:<<prop>>[ \t]+)?)<<key>>(?=\s*:\s)/.source.replace(/<<prop>>/g,function(){return n}).replace(/<<key>>/g,function(){return"(?:"+s+"|"+o+")"})),lookbehind:!0,greedy:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:i(/\d{4}-\d\d?-\d\d?(?:[tT]|[ \t]+)\d\d?:\d{2}:\d{2}(?:\.\d*)?(?:[ \t]*(?:Z|[-+]\d\d?(?::\d{2})?))?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(?::\d{2}(?:\.\d*)?)?/.source),lookbehind:!0,alias:"number"},boolean:{pattern:i(/false|true/.source,"i"),lookbehind:!0,alias:"important"},null:{pattern:i(/null|~/.source,"i"),lookbehind:!0,alias:"important"},string:{pattern:i(o),lookbehind:!0,greedy:!0},number:{pattern:i(/[+-]?(?:0x[\da-f]+|0o[0-7]+|(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?|\.inf|\.nan)/.source,"i"),lookbehind:!0},tag:t,important:e,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},r.languages.yml=r.languages.yaml})(Prism)});var Md=x(()=>{(function(r){var e=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function t(c){return c=c.replace(/<inner>/g,function(){return e}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+c+")")}var n=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return n}),o=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;r.languages.markdown=r.languages.extend("markup",{}),r.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:r.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+o+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+o+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(n),inside:r.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+o+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(n),alias:"important",inside:r.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:t(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:t(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:t(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:t(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(c){["url","bold","italic","strike","code-snippet"].forEach(function(f){c!==f&&(r.languages.markdown[c].inside.content.inside[f]=r.languages.markdown[f])})}),r.hooks.add("after-tokenize",function(c){if(c.language!=="markdown"&&c.language!=="md")return;function f(m){if(!(!m||typeof m=="string"))for(var h=0,v=m.length;h<v;h++){var d=m[h];if(d.type!=="code"){f(d.content);continue}var p=d.content[1],_=d.content[3];if(p&&_&&p.type==="code-language"&&_.type==="code-block"&&typeof p.content=="string"){var g=p.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");g=(/[a-z][\w-]*/i.exec(g)||[""])[0].toLowerCase();var y="language-"+g;_.alias?typeof _.alias=="string"?_.alias=[_.alias,y]:_.alias.push(y):_.alias=[y]}}}f(c.tokens)}),r.hooks.add("wrap",function(c){if(c.type==="code-block"){for(var f="",m=0,h=c.classes.length;m<h;m++){var v=c.classes[m],d=/language-(.+)/.exec(v);if(d){f=d[1];break}}var p=r.languages[f];if(p)c.content=r.highlight(u(c.content),p,f);else if(f&&f!=="none"&&r.plugins.autoloader){var _="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);c.attributes.id=_,r.plugins.autoloader.loadLanguages(f,function(){var g=document.getElementById(_);g&&(g.innerHTML=r.highlight(g.textContent,r.languages[f],f))})}}});var i=RegExp(r.languages.markup.tag.pattern.source,"gi"),a={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function u(c){var f=c.replace(i,"");return f=f.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(m,h){if(h=h.toLowerCase(),h[0]==="#"){var v;return h[1]==="x"?v=parseInt(h.slice(2),16):v=Number(h.slice(1)),l(v)}else{var d=a[h];return d||m}}),f}r.languages.md=r.languages.markdown})(Prism)});var Ld=x(()=>{Prism.languages.go=Prism.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/});Prism.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}});delete Prism.languages.go["class-name"]});var Dd=x(()=>{(function(r){for(var e=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,t=0;t<2;t++)e=e.replace(/<self>/g,function(){return e});e=e.replace(/<self>/g,function(){return/[^\s\S]/.source}),r.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+e),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},r.languages.rust["closure-params"].inside.rest=r.languages.rust,r.languages.rust.attribute.inside.string=r.languages.rust.string})(Prism)});var Se,Be,ql,Kh,Jh,zl,pi,Hl=x(()=>{Se=j(require("react"),1),Be=require("ink"),ql=j(Ad(),1);Sd();Cd();Ed();$d();Id();Pd();Rd();Od();Fd();Md();Ld();Dd();Kh={js:"javascript",jsx:"jsx",ts:"typescript",tsx:"tsx",py:"python",rs:"rust",go:"go",yml:"yaml",yaml:"yaml",md:"markdown",sh:"bash",bash:"bash",json:"json",css:"css",html:"html",xml:"xml"},Jh={comment:"gray",prolog:"gray",doctype:"gray",cdata:"gray",punctuation:"gray",property:"cyan",tag:"cyan",boolean:"cyan",number:"cyan",constant:"cyan",symbol:"cyan",deleted:"cyan",selector:"green","attr-name":"green",string:"green",char:"green",builtin:"green",inserted:"green",operator:"yellow",entity:"yellow",url:"yellow",variable:"yellow",atrule:"magenta","attr-value":"magenta",function:"magenta","class-name":"magenta",keyword:"blue",regex:"red",important:"red"},zl=(r,e)=>{if(typeof r=="string")return Se.default.createElement(Be.Text,{key:e},r);let t=Jh[r.type]||"white",n=Array.isArray(r.content)?r.content.map((s,o)=>zl(s,o)):typeof r.content=="object"?zl(r.content,0):r.content;return Se.default.createElement(Be.Text,{key:e,color:t},n)},pi=({content:r,language:e="text",showLineNumbers:t=!1,maxLines:n,startLineNumber:s=1})=>{let o=r.split(`
`),i=n&&o.length>n?o.slice(0,n):o,a=s+i.length-1,l=String(a).length,u=Kh[e]||e,c=ql.default.languages[u],f=[];if(c){let m=ql.default.tokenize(r,c),h=[];f.push(h);let v=d=>{if(typeof d=="string")d.split(`
`).forEach((_,g)=>{g>0&&(h=[],f.push(h)),_&&h.push(_)});else{let p=Array.isArray(d.content)?d.content.join(""):String(d.content);p.includes(`
`)?p.split(`
`).forEach((g,y)=>{y>0&&(h=[],f.push(h)),g&&h.push({...d,content:g})}):h.push(d)}};m.forEach(v),n&&f.length>n&&(f=f.slice(0,n))}return Se.default.createElement(Be.Box,{flexDirection:"column",paddingLeft:t?0:1},c&&f.length>0?f.map((m,h)=>Se.default.createElement(Be.Box,{key:h},t&&Se.default.createElement(Se.default.Fragment,null,Se.default.createElement(Be.Text,{color:"gray",dimColor:!0},String(s+h).padStart(l," ")),Se.default.createElement(Be.Text,{color:"gray",dimColor:!0}," \u2502 ")),Se.default.createElement(Be.Box,null,m.length>0?m.map((v,d)=>zl(v,d)):Se.default.createElement(Be.Text,null," ")))):i.map((m,h)=>Se.default.createElement(Be.Box,{key:h},t&&Se.default.createElement(Se.default.Fragment,null,Se.default.createElement(Be.Text,{color:"gray",dimColor:!0},String(s+h).padStart(l," ")),Se.default.createElement(Be.Text,{color:"gray",dimColor:!0}," \u2502 ")),Se.default.createElement(Be.Text,null,m||" "))))}});var He,as,Nd,Bd,Xh,ur,Vl,Yh,jd,Ud=x(()=>{He=j(require("react"),1),as=require("ink"),Nd=require("child_process"),Bd=require("util");Ee();is();vt();Hl();Xh=(0,Bd.promisify)(Nd.exec),ur=process.cwd(),Yh=ee().id("bash").name("Bash Command Executor").description("Execute a bash command").category("system").capabilities("system:execute","user:confirmation").tags("bash","shell","command","system").stringArg("command","The bash command to execute",{required:!0}).numberArg("timeout","Command timeout in milliseconds",{default:3e4,validate:r=>r>0||"Timeout must be positive"}).onInitialize(async r=>{Vl=Xe.getInstance(),ur=r.workingDirectory||process.cwd()}).execute(async(r,e)=>{var s,o,i,a,l,u,c,f,m,h;let{command:t,timeout:n}=r;(s=e.logger)==null||s.debug(`Executing bash command: ${t}`),(o=e.logger)==null||o.debug(`Working directory: ${ur}`),(i=e.logger)==null||i.debug(`Timeout: ${n}ms`);try{let v=Vl.getSessionFlags();if(!v.bashCommands&&!v.allOperations){let g=await Vl.requestConfirmation({operation:"Run bash command",filename:t,content:`Command: ${t}
Working directory: ${ur}`},"bash");if(!g.confirmed)return(a=e.logger)==null||a.info("Command execution cancelled by user"),{success:!1,error:g.feedback||"Command execution cancelled by user"}}if(t.startsWith("cd ")){let g=t.substring(3).trim();try{return process.chdir(g),ur=process.cwd(),e.registry&&typeof e.registry=="object"&&"setWorkingDirectory"in e.registry&&e.registry.setWorkingDirectory(ur),(l=e.logger)==null||l.info(`Changed directory to: ${ur}`),{success:!0,output:`Changed directory to: ${ur}`}}catch(y){return(u=e.logger)==null||u.error(`Failed to change directory: ${y instanceof Error?y.message:String(y)}`),{success:!1,error:`Cannot change directory: ${y instanceof Error?y.message:String(y)}`}}}let{stdout:d,stderr:p}=await Xh(t,{cwd:ur,timeout:n,maxBuffer:1024*1024}),_=d+(p?`
STDERR: ${p}`:"");return p&&((c=e.logger)==null||c.warn(`Command produced stderr output: ${p}`)),(f=e.logger)==null||f.info("Command executed successfully"),(m=e.logger)==null||m.debug(`Output: ${_.substring(0,200)}${_.length>200?"...":""}`),{success:!0,output:_.trim()||"Command executed successfully (no output)"}}catch(v){return(h=e.logger)==null||h.error(`Command failed: ${v instanceof Error?v.message:String(v)}`),{success:!1,error:`Command failed: ${v instanceof Error?v.message:String(v)}`}}}).renderResult(({isExecuting:r,result:e})=>{if(r)return He.default.createElement(J,null,He.default.createElement(as.Text,{color:"cyan"}," Running command..."));if(!e)return null;if(!e.success)return He.default.createElement(J,null,He.default.createElement(as.Text,{color:"red"}," ",e.error));let t=e.output||"";if(!t.trim())return He.default.createElement(J,null,He.default.createElement(as.Text,{color:"gray"}," (no output)"));if(t.trim().split(`
`).length===1)return He.default.createElement(J,null,He.default.createElement(as.Text,{color:"gray"}," ",t.trim()));if(t.includes("{")||t.includes("function")||t.includes("class")||t.includes("import")||t.includes("export")||t.includes("const ")||t.includes("let ")||t.includes("var ")){let o="text";return t.includes("import React")||t.includes("export default")?o="javascript":t.includes("interface ")||t.includes(": string")?o="typescript":t.includes("def ")||t.includes("import ")?o="python":(t.includes("package ")||t.includes("func "))&&(o="go"),He.default.createElement(Te,null,He.default.createElement(pi,{content:t.trim(),language:o}))}return He.default.createElement(Te,null,He.default.createElement(as.Text,{color:"gray"},t.trim()))}).build(),jd=Yh});function Qh(){if(Y.length===0)return"No todos";let r={pending:Y.filter(s=>s.status==="pending"),in_progress:Y.filter(s=>s.status==="in_progress"),completed:Y.filter(s=>s.status==="completed")},e=[],t=[...r.pending,...r.in_progress].filter(s=>s.priority==="high").sort((s,o)=>s.status==="in_progress"&&o.status!=="in_progress"?-1:s.status!=="in_progress"&&o.status==="in_progress"?1:0);t.length>0&&(e.push("\u{1F534} High Priority:"),t.forEach(s=>{let o=s.status==="in_progress"?"\u{1F504}":"\u23F3";e.push(`  ${o} [${s.id}] ${s.content}`)}),e.push(""));let n=[...r.pending,...r.in_progress].filter(s=>s.priority!=="high").sort((s,o)=>s.priority==="medium"&&o.priority==="low"?-1:s.priority==="low"&&o.priority==="medium"?1:s.status==="in_progress"&&o.status!=="in_progress"?-1:s.status!=="in_progress"&&o.status==="in_progress"?1:0);return n.length>0&&(e.push("\u{1F4CB} Other Tasks:"),n.forEach(s=>{let o=s.status==="in_progress"?"\u{1F504}":"\u23F3",i=s.priority==="medium"?"\u{1F7E1}":"\u{1F7E2}";e.push(`  ${o} ${i} [${s.id}] ${s.content}`)}),e.push("")),r.completed.length>0&&(e.push(`\u2705 Completed (${r.completed.length}):`),r.completed.slice(0,5).forEach(s=>{e.push(`  \u2713 [${s.id}] ${s.content}`)}),r.completed.length>5&&e.push(`  ... and ${r.completed.length-5} more`)),e.push(""),e.push(`Total: ${Y.length} | Pending: ${r.pending.length} | In Progress: ${r.in_progress.length} | Completed: ${r.completed.length}`),e.join(`
`)}var ie,be,Y,eg,tg,Wd,mi=x(()=>{ie=j(require("react"),1),be=require("ink");Ee();vt();Y=[];eg=({toolName:r,arguments:e,result:t,isExecuting:n})=>{var u;if(n)return ie.default.createElement(J,null,ie.default.createElement(be.Text,{color:"cyan"}," Updating todo list..."));if(!t||!t.success)return ie.default.createElement(J,null,ie.default.createElement(be.Text,{color:"red"}," Error: ",(t==null?void 0:t.error)||"Unknown error"));let s=((u=t.data)==null?void 0:u.todos)||[];if(s.length===0)return ie.default.createElement(J,null,ie.default.createElement(be.Text,{color:"gray"}," No todos"));let o=[],i={pending:s.filter(c=>c.status==="pending"),in_progress:s.filter(c=>c.status==="in_progress"),completed:s.filter(c=>c.status==="completed")},a=[...i.pending,...i.in_progress].filter(c=>c.priority==="high").sort((c,f)=>c.status==="in_progress"&&f.status!=="in_progress"?-1:c.status!=="in_progress"&&f.status==="in_progress"?1:0);a.length>0&&a.forEach(c=>{o.push(ie.default.createElement(be.Box,{key:`todo-${c.id}`},ie.default.createElement(be.Text,{color:c.status==="in_progress"?"cyan":"yellow"},c.status==="in_progress"?"  \u25D0 ":"  \u25CB "),ie.default.createElement(be.Text,{color:"white"},c.content),ie.default.createElement(be.Text,{color:"red"}," \u25CF")))});let l=[...i.pending,...i.in_progress].filter(c=>c.priority!=="high").sort((c,f)=>c.priority==="medium"&&f.priority==="low"?-1:c.priority==="low"&&f.priority==="medium"?1:c.status==="in_progress"&&f.status!=="in_progress"?-1:c.status!=="in_progress"&&f.status==="in_progress"?1:0);return l.length>0&&l.forEach(c=>{let f=c.priority==="medium"?"yellow":"green";o.push(ie.default.createElement(be.Box,{key:`todo-${c.id}`},ie.default.createElement(be.Text,{color:c.status==="in_progress"?"cyan":"gray"},c.status==="in_progress"?"  \u25D0 ":"  \u25CB "),ie.default.createElement(be.Text,{color:"white"},c.content),ie.default.createElement(be.Text,{color:f}," \u25CF")))}),i.completed.length>0&&(i.completed.slice(0,3).forEach(c=>{o.push(ie.default.createElement(be.Box,{key:`todo-${c.id}`},ie.default.createElement(be.Text,{color:"green"},"  \u25CF "),ie.default.createElement(be.Text,{color:"gray",dimColor:!0},c.content)))}),i.completed.length>3&&o.push(ie.default.createElement(be.Box,{key:"more-completed"},ie.default.createElement(be.Text,{color:"gray"},"  ... and ",i.completed.length-3," more completed")))),ie.default.createElement(Te,null,ie.default.createElement(be.Box,{flexDirection:"column"},o))},tg=ee().id("create_todo_list").name("Create Todo List").description("Create a new todo list for planning and tracking tasks").category("task").tags("todo","task","planning","tracking").arrayArg("todos","Array of todo items",{required:!0,validate:r=>{if(!Array.isArray(r))return"Todos must be an array";let e=new Set;for(let t of r){if(!t||typeof t!="object")return"Each todo must be an object";let n=t;if(!n.id||typeof n.id!="string")return"Each todo must have a string id";if(e.has(n.id))return`Duplicate todo id: ${n.id}`;if(e.add(n.id),!n.content||typeof n.content!="string")return"Each todo must have content";if(!n.status||!["pending","in_progress","completed"].includes(n.status))return"Each todo status must be pending, in_progress, or completed";if(!n.priority||!["high","medium","low"].includes(n.priority))return"Each todo priority must be high, medium, or low"}return!0}}).onInitialize(async r=>{var e;(e=r.logger)==null||e.debug("Todo list initialized")}).renderResult(eg).examples([{description:"Create a todo list with two tasks",arguments:{todos:[{id:"1",content:"Read all the files in the project",status:"pending",priority:"high"},{id:"2",content:"Synthesize the important files",status:"pending",priority:"medium"}]},result:"Created todo list with 2 items"},{description:"Create an empty todo list",arguments:{todos:[]},result:"Created todo list with 0 items"}]).execute(async(r,e)=>{var s,o;let{todos:t}=r;(s=e.logger)==null||s.debug(`Creating todo list with ${t.length} items`),Y=t.map(i=>({id:i.id,content:i.content,status:i.status,priority:i.priority}));let n=Qh();return(o=e.logger)==null||o.info(`Created todo list with ${Y.length} items`),{success:!0,output:`Created todo list with ${Y.length} items:

${n}`,data:{todos:Y}}}).build(),Wd=tg});async function ng(r,e,t,n){let s=r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/'/g,"'\\''").replace(/\n/g," "),o=(t||"Input Required").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/'/g,"'\\''").replace(/\n/g," "),i=(e||"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/'/g,"'\\''").replace(/\n/g," "),a;n?a=`osascript -e 'tell application "System Events" to display dialog "${s}" default answer "" with title "${o}" with hidden answer' -e 'text returned of result'`:a=`osascript -e 'tell application "System Events" to display dialog "${s}" default answer "${i}" with title "${o}"' -e 'text returned of result'`;try{let{stdout:l}=await rn(a);return l.trim()}catch(l){throw l instanceof Error&&l.message.includes("User canceled")?new Error("User cancelled the input dialog"):l}}async function sg(r,e,t,n){let s=r.replace(/'/g,"''"),o=(t||"Input Required").replace(/'/g,"''"),i=(e||"").replace(/'/g,"''"),a;n?a=`
            Add-Type -AssemblyName Microsoft.VisualBasic
            $secure = Read-Host '${s}' -AsSecureString
            $BSTR = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secure)
            $plain = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)
            Write-Output $plain
        `:a=`
            Add-Type -AssemblyName Microsoft.VisualBasic
            [Microsoft.VisualBasic.Interaction]::InputBox('${s}', '${o}', '${i}')
        `;let{stdout:l}=await rn(`powershell -Command "${a.replace(/"/g,'\\"')}"`),u=l.trim();if(u==="")throw new Error("User cancelled the input dialog");return u}async function og(r,e,t,n){try{return await rn("which zenity"),await ig(r,e,t,n)}catch{try{return await rn("which kdialog"),await ag(r,e,t,n)}catch{return await lg(r,e,n)}}}async function ig(r,e,t,n){let s=["zenity","--entry",`--text="${r.replace(/"/g,'\\"')}"`,`--title="${(t||"Input Required").replace(/"/g,'\\"')}"`];e&&s.push(`--entry-text="${e.replace(/"/g,'\\"')}"`),n&&s.push("--hide-text");try{let{stdout:o}=await rn(s.join(" "));return o.trim()}catch(o){throw o instanceof Error&&(o.message.includes("code 1")||o.message.includes("code 255"))?new Error("User cancelled the input dialog"):o}}async function ag(r,e,t,n){let s=["kdialog",n?"--password":"--inputbox",`"${r.replace(/"/g,'\\"')}"`,e?`"${e.replace(/"/g,'\\"')}"`:'""',`--title "${(t||"Input Required").replace(/"/g,'\\"')}"`];try{let{stdout:o}=await rn(s.join(" "));return o.trim()}catch(o){throw o instanceof Error&&o.message.includes("code 1")?new Error("User cancelled the input dialog"):o}}async function lg(r,e,t){let n=t?`read -s -p "${r.replace(/"/g,'\\"')}: " input && echo "$input"`:`read -p "${r.replace(/"/g,'\\"')} [${e||""}]: " input && echo "\${input:-${e||""}}"`;try{let{stdout:s}=await rn(n,{shell:"/bin/bash"});return s.trim()}catch{throw new Error("Failed to read input from terminal")}}var Zs,Ks,qd,zd,Hd,rn,rg,Vd,Gd=x(()=>{Zs=j(require("react"),1),Ks=require("ink"),qd=j(require("child_process"),1),zd=j(require("os"),1),Hd=require("util");Ee();rn=(0,Hd.promisify)(qd.exec),rg=ee().id("input").name("Get User Input").description("Show a platform-specific input dialog to get arbitrary information from the user").category("utility").capabilities("user:confirmation").tags("input","dialog","user","prompt","ask").stringArg("prompt","The prompt/question to show to the user",{required:!0}).stringArg("default_value","Default value to pre-fill in the input field (optional)",{required:!1}).stringArg("title","Title for the dialog window (optional)",{required:!1,default:"Input Required"}).booleanArg("password","Whether to mask the input for password entry (optional)",{required:!1,default:!1}).examples([{description:"Ask for user's name",arguments:{prompt:"What is your name?",title:"Name Input"},result:"User enters: John Doe"},{description:"Ask for API key with password masking",arguments:{prompt:"Please enter your API key:",title:"API Key",password:!0},result:"User enters masked input"}]).renderResult(({isExecuting:r,result:e,arguments:t})=>r?Zs.default.createElement(Ks.Text,{color:"cyan"},"\u23BF Waiting for user input..."):e!=null&&e.success?t.password?Zs.default.createElement(Ks.Text,{color:"gray"},"\u23BF User provided input (hidden)"):Zs.default.createElement(Ks.Text,{color:"gray"},"\u23BF User input: ",e.output):Zs.default.createElement(Ks.Text,{color:"red"},"\u23BF ",(e==null?void 0:e.error)||"Failed to get input")).execute(async(r,e)=>{var a,l,u;let{prompt:t,default_value:n,title:s,password:o}=r,i=zd.platform();(a=e.logger)==null||a.debug(`Showing input dialog on ${i}`);try{let c;switch(i){case"darwin":c=await ng(t,n,s||"Input Required",o||!1);break;case"win32":c=await sg(t,n,s||"Input Required",o||!1);break;case"linux":c=await og(t,n,s||"Input Required",o||!1);break;default:return{success:!1,error:`Unsupported platform: ${i}`}}return c==null?{success:!1,error:"User cancelled the input dialog"}:((l=e.logger)==null||l.info(`User provided input: ${o?"[HIDDEN]":c}`),{success:!0,output:c,data:{input:c}})}catch(c){return(u=e.logger)==null||u.error(`Failed to show input dialog: ${c instanceof Error?c.message:String(c)}`),{success:!1,error:`Failed to show input dialog: ${c instanceof Error?c.message:String(c)}`}}}).build();Vd=rg});function cg(){if(Y.length===0)return"No todos";let r={pending:Y.filter(s=>s.status==="pending"),in_progress:Y.filter(s=>s.status==="in_progress"),completed:Y.filter(s=>s.status==="completed")},e=[],t=[...r.pending,...r.in_progress].filter(s=>s.priority==="high").sort((s,o)=>s.status==="in_progress"&&o.status!=="in_progress"?-1:s.status!=="in_progress"&&o.status==="in_progress"?1:0);t.length>0&&(e.push("\u{1F534} High Priority:"),t.forEach(s=>{let o=s.status==="in_progress"?"\u{1F504}":"\u23F3";e.push(`  ${o} [${s.id}] ${s.content}`)}),e.push(""));let n=[...r.pending,...r.in_progress].filter(s=>s.priority!=="high").sort((s,o)=>s.priority==="medium"&&o.priority==="low"?-1:s.priority==="low"&&o.priority==="medium"?1:s.status==="in_progress"&&o.status!=="in_progress"?-1:s.status!=="in_progress"&&o.status==="in_progress"?1:0);return n.length>0&&(e.push("\u{1F4CB} Other Tasks:"),n.forEach(s=>{let o=s.status==="in_progress"?"\u{1F504}":"\u23F3",i=s.priority==="medium"?"\u{1F7E1}":"\u{1F7E2}";e.push(`  ${o} ${i} [${s.id}] ${s.content}`)}),e.push("")),r.completed.length>0&&(e.push(`\u2705 Completed (${r.completed.length}):`),r.completed.slice(0,5).forEach(s=>{e.push(`  \u2713 [${s.id}] ${s.content}`)}),r.completed.length>5&&e.push(`  ... and ${r.completed.length-5} more`)),e.push(""),e.push(`Total: ${Y.length} | Pending: ${r.pending.length} | In Progress: ${r.in_progress.length} | Completed: ${r.completed.length}`),e.join(`
`)}var ae,xe,ug,dg,Zd,Kd=x(()=>{ae=j(require("react"),1),xe=require("ink");Ee();vt();mi();ug=({toolName:r,arguments:e,result:t,isExecuting:n})=>{var u;if(n)return ae.default.createElement(J,null,ae.default.createElement(xe.Text,{color:"cyan"}," Loading todo list..."));if(!t||!t.success)return ae.default.createElement(J,null,ae.default.createElement(xe.Text,{color:"red"}," Error: ",(t==null?void 0:t.error)||"Unknown error"));let s=((u=t.data)==null?void 0:u.todos)||[];if(s.length===0)return ae.default.createElement(J,null,ae.default.createElement(xe.Text,{color:"gray"}," No todos"));let o=[],i={pending:s.filter(c=>c.status==="pending"),in_progress:s.filter(c=>c.status==="in_progress"),completed:s.filter(c=>c.status==="completed")},a=[...i.pending,...i.in_progress].filter(c=>c.priority==="high").sort((c,f)=>c.status==="in_progress"&&f.status!=="in_progress"?-1:c.status!=="in_progress"&&f.status==="in_progress"?1:0);a.length>0&&a.forEach(c=>{o.push(ae.default.createElement(xe.Box,{key:`todo-${c.id}`},ae.default.createElement(xe.Text,{color:c.status==="in_progress"?"cyan":"yellow"},c.status==="in_progress"?"  \u25D0 ":"  \u25CB "),ae.default.createElement(xe.Text,{color:"white"},c.content),ae.default.createElement(xe.Text,{color:"red"}," \u25CF")))});let l=[...i.pending,...i.in_progress].filter(c=>c.priority!=="high").sort((c,f)=>c.priority==="medium"&&f.priority==="low"?-1:c.priority==="low"&&f.priority==="medium"?1:c.status==="in_progress"&&f.status!=="in_progress"?-1:c.status!=="in_progress"&&f.status==="in_progress"?1:0);return l.length>0&&l.forEach(c=>{let f=c.priority==="medium"?"yellow":"green";o.push(ae.default.createElement(xe.Box,{key:`todo-${c.id}`},ae.default.createElement(xe.Text,{color:c.status==="in_progress"?"cyan":"gray"},c.status==="in_progress"?"  \u25D0 ":"  \u25CB "),ae.default.createElement(xe.Text,{color:"white"},c.content),ae.default.createElement(xe.Text,{color:f}," \u25CF")))}),i.completed.length>0&&(i.completed.slice(0,3).forEach(c=>{o.push(ae.default.createElement(xe.Box,{key:`todo-${c.id}`},ae.default.createElement(xe.Text,{color:"green"},"  \u25CF "),ae.default.createElement(xe.Text,{color:"gray",dimColor:!0},c.content)))}),i.completed.length>3&&o.push(ae.default.createElement(xe.Box,{key:"more-completed"},ae.default.createElement(xe.Text,{color:"gray"},"  ... and ",i.completed.length-3," more completed")))),ae.default.createElement(Te,null,ae.default.createElement(xe.Box,{flexDirection:"column"},o))},dg=ee().id("list_todos").name("List Todos").description("List all current todos in the todo list").category("task").tags("todo","task","list","view").renderResult(ug).examples([{description:"List all todos",arguments:{},result:"Current todo list with all items displayed"}]).execute(async(r,e)=>{var n,s;if((n=e.logger)==null||n.debug(`Listing ${Y.length} todo items`),Y.length===0)return{success:!0,output:"No todos in the list",data:{todos:[]}};let t=cg();return(s=e.logger)==null||s.info(`Listed ${Y.length} todo items`),{success:!0,output:t,data:{todos:Y}}}).build(),Zd=dg});function fg(r){if(r===0)return"0 B";let e=["B","KB","MB","GB","TB"],t=1024,n=Math.floor(Math.log(r)/Math.log(t));return`${(r/Math.pow(t,n)).toFixed(1)} ${e[n]}`}var nn,dr,Js,hi,pg,Jd,Xd=x(()=>{nn=j(require("react"),1),dr=require("ink");Ee();Js=j(require("fs/promises"),1),hi=j(require("path"),1);pg=ee().id("list").name("List Directory Contents").description("List files and directories in a given path (defaults to current directory)").category("filesystem").tags("filesystem","list","directory","ls").stringArg("path","Directory path to list (defaults to current directory)",{required:!1,default:"."}).booleanArg("detailed","Show detailed information including file types and sizes",{required:!1,default:!1}).examples([{description:"List current directory",arguments:{},result:`file1.ts
file2.js
subdir/
README.md`},{description:"List specific directory",arguments:{path:"./src"},result:`index.ts
app.tsx
components/
utils/`},{description:"List with detailed information",arguments:{path:".",detailed:!0},result:`[file] README.md (2.5 KB)
[file] package.json (1.2 KB)
[dir] src/
[dir] node_modules/`}]).renderResult(({isExecuting:r,result:e,arguments:t})=>{if(r)return nn.default.createElement(dr.Text,{color:"cyan"},"\u23BF Listing directory...");if(!(e!=null&&e.success))return nn.default.createElement(dr.Text,{color:"red"},"\u23BF ",(e==null?void 0:e.error)||"Failed to list directory");let n=e.data;if(!(n!=null&&n.items)||n.items.length===0)return nn.default.createElement(dr.Text,{color:"gray"},"\u23BF Empty directory");let s=20,o=n.items.slice(0,s),i=n.items.length>s;return nn.default.createElement(dr.Box,{flexDirection:"column",marginLeft:2},o.map((a,l)=>nn.default.createElement(dr.Text,{key:l,color:a.isDirectory?"cyan":"white"},"\u23BF ",a.isDirectory?`[dir] ${a.name}/`:`[file] ${a.name}`)),i&&nn.default.createElement(dr.Text,{color:"gray",italic:!0},"\u23BF ... and ",n.items.length-s," more items"))}).execute(async(r,e)=>{let t=hi.resolve(r.path||"."),n=r.detailed||!1;try{if(!(await Js.stat(t)).isDirectory())return{success:!1,error:`Path is not a directory: ${t}`};let o=await Js.readdir(t,{withFileTypes:!0});o.sort((m,h)=>m.isDirectory()&&!h.isDirectory()?-1:!m.isDirectory()&&h.isDirectory()?1:m.name.localeCompare(h.name));let i=100,a=o.length>i,l=a?o.slice(0,i):o,u,c=[];n?u=(await Promise.all(l.map(async h=>{let v=hi.join(t,h.name),d=await Js.stat(v),p=h.isDirectory()?"dir":"file",_=h.isDirectory()?"-":fg(d.size),g=h.isDirectory()?`${h.name}/`:h.name;return c.push({name:h.name,type:p,size:d.size,isDirectory:h.isDirectory()}),`[${p}] ${g} ${_?`(${_})`:""}`.trim()}))).join(`
`):(u=l.map(m=>m.isDirectory()?`${m.name}/`:m.name).join(`
`),l.forEach(m=>{c.push({name:m.name,type:m.isDirectory()?"dir":"file",isDirectory:m.isDirectory()})})),a&&(u+=`

... and ${o.length-i} more items`);let f=`Listed ${o.length} items in ${t}`;return{success:!0,output:u||"Empty directory",data:{path:t,count:o.length,items:c}}}catch(s){return{success:!1,error:`Failed to list directory: ${s instanceof Error?s.message:String(s)}`}}}).build(),Jd=pg});var Gl,Yd,Qd=x(()=>{Gl=class{autoDetectFormat(e){return this.isUnifiedDiff(e)?this.parseUnified(e):e.includes(">>>")&&e.includes("<<<")?this.parseTripleMarkers(e):this.hasDashMarkers(e)?this.parseDashMarkers(e):this.isMultiBlockFormat(e)?this.parseMultiBlock(e):{blocks:[{search:e,replace:"",format:"literal"}],format:"literal",errors:["No recognized diff format found, treating as literal"]}}parseUnified(e){let t=[],n=[],s=e.split(`
`),o=0;for(;o<s.length;){if(s[o].startsWith("@@")){let a=s[o].match(/@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@/);if(a){let l=parseInt(a[1]),u=[],c=[];for(o++;o<s.length&&!s[o].startsWith("@@");)s[o].startsWith("-")?u.push(s[o].substring(1)):s[o].startsWith("+")?c.push(s[o].substring(1)):s[o].startsWith(" ")&&(u.push(s[o].substring(1)),c.push(s[o].substring(1))),o++;t.push({search:u.join(`
`),replace:c.join(`
`),format:"unified",metadata:{startLine:l}});continue}}o++}return{blocks:t,format:"unified",errors:n}}parseTripleMarkers(e){let t=[],n=[],s=/>>>\s*([\s\S]*?)\s*<<<\s*===\s*([\s\S]*?)\s*>>>/g,o;for(;(o=s.exec(e))!==null;)t.push({search:o[1].trim(),replace:o[2].trim(),format:"markers"});let i=/>>>\s*([\s\S]*?)\s*<<<\s*([\s\S]*?)\s*>>>/g,a;if(t.length===0)for(;(a=i.exec(e))!==null;)t.push({search:a[1].trim(),replace:a[2].trim(),format:"markers"});return t.length===0&&n.push("No valid triple marker blocks found"),{blocks:t,format:"markers",errors:n}}parseDashMarkers(e){let t=[],n=[],s=e.split(`
`),o=0;for(;o<s.length;){if(s[o].startsWith("---")&&o+1<s.length){let i=[],a=[];for(o++;o<s.length&&!s[o].startsWith("+++");)i.push(s[o]),o++;if(o<s.length&&s[o].startsWith("+++")){for(o++;o<s.length&&!s[o].startsWith("---");)a.push(s[o]),o++;t.push({search:i.join(`
`).trim(),replace:a.join(`
`).trim(),format:"markers"});continue}}o++}return{blocks:t,format:"markers",errors:n}}parseMultiBlock(e){let t=[],n=[],s=/\d+\.\s*Search:\s*([\s\S]*?)\s*Replace:\s*([\s\S]*?)(?=\d+\.\s*Search:|$)/g,o;for(;(o=s.exec(e))!==null;)t.push({search:o[1].trim(),replace:o[2].trim(),format:"multi-line"});let i=/SEARCH:\s*([\s\S]*?)\s*REPLACE:\s*([\s\S]*?)(?=SEARCH:|$)/gi,a;if(t.length===0)for(;(a=i.exec(e))!==null;)t.push({search:a[1].trim(),replace:a[2].trim(),format:"multi-line"});return{blocks:t,format:"multi-line",errors:n}}isUnifiedDiff(e){return e.includes("@@")&&(e.includes("---")||e.includes("+++"))}hasDashMarkers(e){let t=e.split(`
`),n=!1,s=!1;for(let o of t)o.startsWith("---")&&(n=!0),o.startsWith("+++")&&(s=!0);return n&&s}isMultiBlockFormat(e){return/\d+\.\s*(Search|SEARCH):/i.test(e)||/SEARCH:\s*[\s\S]*?\s*REPLACE:/i.test(e)}validateBlocks(e){let t=[];return e.forEach((n,s)=>{n.search||t.push(`Block ${s+1}: Search content is empty`),n.search===n.replace&&t.push(`Block ${s+1}: Search and replace are identical`)}),t}},Yd=new Gl});var Zl,Kl,ef=x(()=>{Zl=class{apply(e,t){let n={success:!1,original:e,applied:[],failed:[],conflicts:[],stats:{totalBlocks:t.length,appliedCount:0,failedCount:0,conflictCount:0}};if(t.length===0)return n.success=!0,n.content=e,n;let s=this.findAllMatches(e,t),o=this.detectConflicts(s);n.conflicts=o.map(m=>m.map(h=>h.block)),n.stats.conflictCount=o.length;let i=new Set;o.forEach(m=>m.forEach(h=>i.add(h)));let a=s.filter(m=>!i.has(m)),l=t.filter(m=>!m.search),u=t.filter(m=>m.search),c=new Set(a.map(m=>m.block));n.failed=u.filter(m=>!c.has(m)),n.stats.failedCount=n.failed.length,a.sort((m,h)=>h.start-m.start);let f=e;for(let m of a){let h=f.substring(0,m.start),v=f.substring(m.end);f=h+m.block.replace+v,n.applied.push(m.block)}for(let m of l)f+=m.replace,n.applied.push(m);return n.content=f,n.stats.appliedCount=n.applied.length,n.success=n.stats.failedCount===0&&n.stats.conflictCount===0,n}findAllMatches(e,t){let n=[];for(let s of t){let o=this.findMatches(e,s);n.push(...o)}return n}findMatches(e,t){let n=[],s=t.search;if(!s)return n;let o=e.indexOf(s);for(;o!==-1;)n.push({start:o,end:o+s.length,block:t,content:s}),o=e.indexOf(s,o+1);if(n.length===0&&s.includes(`
`)){let i=this.normalizeWhitespace(s),a=this.normalizeWhitespace(e),l=a.indexOf(i);for(;l!==-1;){let u=this.mapNormalizedMatch(e,a,l,i.length);u&&n.push({start:u.start,end:u.end,block:t,content:e.substring(u.start,u.end)}),l=a.indexOf(i,l+1)}}return n}normalizeWhitespace(e){return e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0).join(" ").replace(/\s+/g," ")}mapNormalizedMatch(e,t,n,s){let o=0,i=0,a=[];for(;o<e.length&&i<t.length;){for(;o<e.length&&/\s/.test(e[o]);)o++;o<e.length&&(a[i]=o,o++,i++)}if(n>=a.length||n+s>a.length)return null;let l=a[n],u=o;if(n+s<a.length)u=a[n+s];else{let c=a[a.length-1];u=e.length;for(let f=c;f<e.length;f++)if(this.normalizeWhitespace(e.substring(l,f)).length>=s){u=f;break}}return{start:l,end:u}}detectConflicts(e){let t=[],n=new Set;for(let s=0;s<e.length;s++){if(n.has(e[s]))continue;let o=[e[s]];n.add(e[s]);for(let i=s+1;i<e.length;i++)n.has(e[i])||this.overlaps(e[s],e[i])&&(o.push(e[i]),n.add(e[i]));o.length>1&&t.push(o)}return t}overlaps(e,t){return!(e.end<=t.start||t.end<=e.start)}validateBlocks(e,t){let n=[],s=[];t.forEach((l,u)=>{!l.search&&!l.replace&&n.push(`Block ${u+1}: Both search and replace are empty`),l.search===l.replace&&s.push(`Block ${u+1}: Search and replace are identical`)});let o=this.findAllMatches(e,t),i=new Set(o.map(l=>l.block));t.forEach((l,u)=>{!i.has(l)&&l.search&&n.push(`Block ${u+1}: No matches found for "${l.search.substring(0,50)}${l.search.length>50?"...":""}"`)});let a=this.detectConflicts(o);return a.length>0&&s.push(`Found ${a.length} conflicting replacement groups`),{valid:n.length===0,errors:n,warnings:s}}getMatchDetails(e,t){let n=this.findAllMatches(e,t),s=this.detectConflicts(n),o=new Set(n.map(a=>a.block)),i=t.filter(a=>!o.has(a));return{matches:n,conflicts:s,unmatchedBlocks:i}}},Kl=new Zl});function mg(r){let e=r.search.split(`
`).length,t=r.replace.split(`
`).length;return e>1||t>1?`${e} \u2192 ${t} lines`:r.search.length>50||r.replace.length>50?"large replacement":"text replacement"}function tf(r){let e=r.replace(/\n/g,`\u21B5
`),t=80;if(e.length>t){let n=e.split(`
`);n.length>3?e=n.slice(0,2).join(`
`)+`
...
`+n[n.length-1]:e=e.substring(0,t-3)+"..."}return e}var Q,re,rf,nf=x(()=>{Q=j(require("react"),1),re=require("ink"),rf=({blocks:r,filePath:e,stats:t,maxBlocksToShow:n=5})=>{let s=r.slice(0,n),o=r.length-s.length;return Q.default.createElement(re.Box,{flexDirection:"column"},Q.default.createElement(re.Box,{marginBottom:1},Q.default.createElement(re.Text,{color:"cyan",bold:!0},"Summary: "),Q.default.createElement(re.Text,{color:"green"},t.appliedCount," applied"),t.failedCount>0&&Q.default.createElement(Q.default.Fragment,null,Q.default.createElement(re.Text,{color:"gray"}," \u2022 "),Q.default.createElement(re.Text,{color:"yellow"},t.failedCount," failed")),t.conflictCount>0&&Q.default.createElement(Q.default.Fragment,null,Q.default.createElement(re.Text,{color:"gray"}," \u2022 "),Q.default.createElement(re.Text,{color:"red"},t.conflictCount," conflicts"))),Q.default.createElement(re.Box,{flexDirection:"column"},s.map((i,a)=>Q.default.createElement(re.Box,{key:a,flexDirection:"column",marginBottom:1},Q.default.createElement(re.Box,null,Q.default.createElement(re.Text,{color:"gray",dimColor:!0},"[",a+1,"/",r.length,"]"),Q.default.createElement(re.Text,{color:"cyan",dimColor:!0}," ",mg(i))),Q.default.createElement(re.Box,{flexDirection:"column",paddingLeft:2},Q.default.createElement(re.Box,null,Q.default.createElement(re.Text,{backgroundColor:"red",color:"white"},"-"),Q.default.createElement(re.Text,null," "),Q.default.createElement(re.Text,{backgroundColor:"red",color:"white"},tf(i.search))),Q.default.createElement(re.Box,null,Q.default.createElement(re.Text,{backgroundColor:"green",color:"white"},"+"),Q.default.createElement(re.Text,null," "),Q.default.createElement(re.Text,{backgroundColor:"green",color:"white"},tf(i.replace)))))),o>0&&Q.default.createElement(re.Box,{marginTop:1},Q.default.createElement(re.Text,{color:"gray",dimColor:!0},"... and ",o," more replacement",o!==1?"s":""))))}});var pe,Ie,gi,ls,Jl,hg,sf,of=x(()=>{pe=j(require("react"),1),Ie=require("ink"),gi=j(require("fs/promises"),1),ls=j(require("path"),1);Ee();is();vt();os();Qd();ef();nf();hg=ee().id("multi_edit").name("Multi Edit").description("Flexible file editing tool that can add, append, replace, or remove content. Use empty search string to append content.").category("filesystem").capabilities("file:read","file:write","user:confirmation").tags("file","edit","replace","modify","diff","append","add","remove","update").stringArg("path","Path to the file to edit",{required:!0}).arrayArg("replacements","Array of edit operations. Each item should have: search (string - can be empty to append), replace (string - can be empty to remove), and optional mode (exact|fuzzy)",{required:!1}).stringArg("diff_format","Alternative: provide replacements as a diff string in various formats",{required:!1}).examples([{description:"Replace multiple strings",arguments:{path:"src/config.ts",replacements:[{search:"localhost",replace:"example.com"},{search:"8080",replace:"443"}]},result:"Replaces all occurrences"},{description:"Append content to file",arguments:{path:"script.sh",replacements:[{search:"",replace:`
# New commands
echo 'Hello World'
`}]},result:"Appends new content to end of file"},{description:"Remove lines containing text",arguments:{path:"config.yaml",replacements:[{search:`debug: true
`,replace:""},{search:`verbose: true
`,replace:""}]},result:"Removes matching lines"},{description:"Add content after specific line",arguments:{path:"main.py",replacements:[{search:"import os",replace:`import os
import sys`}]},result:"Adds new import after existing one"},{description:"Using diff format",arguments:{path:"README.md",diff_format:`--- old text
+++ new text

--- another old
+++ another new`},result:"Applies diff-formatted changes"}]).onInitialize(async r=>{var e;Jl=Xe.getInstance(),(e=r.logger)==null||e.debug("Multi Edit tool initialized")}).execute(async(r,e)=>{var o,i,a,l,u,c,f;let{path:t,replacements:n,diff_format:s}=r;(o=e.logger)==null||o.debug(`Replacing in file: ${t}`);try{if(!it.hasFile(t))return(i=e.logger)==null||i.warn(`File ${t} has not been read yet`),{success:!1,error:`You must read the file before editing it. Please use read_file to read "${t}" first.`};let m=await gi.readFile(t,"utf8");if(!it.verifyFileHash(t,m))return(a=e.logger)==null||a.warn(`File ${t} has been modified since last read`),it.clearFile(t),{success:!1,error:`File "${t}" has been modified since it was last read. Please use read_file to read the latest version before editing.`};let h=[];if(s){let g=Yd.autoDetectFormat(s);h=g.blocks,g.errors.length>0&&((l=e.logger)==null||l.warn(`Diff parsing warnings: ${g.errors.join(", ")}`))}else if(n&&n.length>0)h=n.map(g=>({search:g.search,replace:g.replace,format:"literal"}));else return{success:!1,error:"No replacements provided. Use either replacements array or diff_format."};let v=Kl.validateBlocks(m,h);if(!v.valid)return{success:!1,error:`Invalid replacements:
${v.errors.join(`
`)}`};let d=Kl.apply(m,h),p=Jl.getSessionFlags();if(!p.editFiles&&!p.allOperations){let g=`Will apply ${d.stats.appliedCount} replacement(s):

`;d.applied.forEach((b,C)=>{let E=b.search.length>50?b.search.substring(0,47)+"...":b.search,I=b.replace.length>50?b.replace.substring(0,47)+"...":b.replace;g+=`${C+1}. "${E}" \u2192 "${I}"
`}),d.stats.failedCount>0&&(g+=`
Warning: ${d.stats.failedCount} replacement(s) could not be applied.`),d.stats.conflictCount>0&&(g+=`
Warning: ${d.stats.conflictCount} conflicting replacement(s) detected.`);let y=await Jl.requestConfirmation({operation:"Edit file",filename:t,content:g},"file_edit");if(!y.confirmed)return(u=e.logger)==null||u.info("File edit cancelled by user"),{success:!1,error:y.feedback||"Edit cancelled by user"}}d.content&&(await gi.writeFile(t,d.content,"utf8"),it.updateFile(t,d.content));let _=`Successfully applied ${d.stats.appliedCount} replacement(s) in ${t}`;return(c=e.logger)==null||c.info(_),{success:d.success,output:_,data:{filePath:t,stats:d.stats,applied:d.applied,failed:d.failed,conflicts:d.conflicts,originalContent:m,newContent:d.content}}}catch(m){return(f=e.logger)==null||f.error(`Failed to edit file: ${m instanceof Error?m.message:String(m)}`),{success:!1,error:`Failed to edit file: ${m instanceof Error?m.message:String(m)}`}}}).renderResult(({isExecuting:r,result:e,arguments:t})=>{if(r)return pe.default.createElement(J,null,pe.default.createElement(Ie.Text,{color:"cyan"}," Applying replacements..."));if(!e)return null;if(!e.success)return pe.default.createElement(J,null,pe.default.createElement(Ie.Text,{color:"red"}," ",e.error||"Failed to apply replacements"));let n=e.data;if(!n||!n.stats)return pe.default.createElement(J,null,pe.default.createElement(Ie.Text,{color:"green"}," ",e.output));let s=n.filePath||t.path,o=ls.extname(s).slice(1)||"text";return pe.default.createElement(Te,null,pe.default.createElement(Ie.Box,{flexDirection:"column"},pe.default.createElement(Ie.Box,{marginBottom:1,flexDirection:"column"},pe.default.createElement(Ie.Box,null,pe.default.createElement(Ie.Text,{color:"cyan",bold:!0},ls.basename(s)),pe.default.createElement(Ie.Text,{color:"gray"}," \u2022 "),pe.default.createElement(Ie.Text,{color:"gray",dimColor:!0},ls.dirname(s),"/")),pe.default.createElement(Ie.Box,null,pe.default.createElement(Ie.Text,{color:"green"},"\u2713 Applied ",n.stats.appliedCount,"/",n.stats.totalBlocks," replacements"),n.stats.failedCount>0&&pe.default.createElement(Ie.Text,{color:"yellow"}," (",n.stats.failedCount," failed)"),n.stats.conflictCount>0&&pe.default.createElement(Ie.Text,{color:"red"}," (",n.stats.conflictCount," conflicts)"))),n.applied&&n.applied.length>0&&pe.default.createElement(Ie.Box,{marginTop:1},pe.default.createElement(rf,{blocks:n.applied,filePath:s,stats:n.stats,maxBlocksToShow:5}))))}).build(),sf=hg});var yi,_i,gg,af,lf=x(()=>{yi=j(require("react"),1),_i=require("ink");Ee();gg=ee().id("pwd").name("Print Working Directory").description("Get the current working directory path").category("filesystem").tags("filesystem","navigation","directory","pwd").examples([{description:"Get current working directory",arguments:{},result:"/Users/username/projects/my-app"}]).renderResult(({isExecuting:r,result:e})=>r?yi.default.createElement(_i.Text,{color:"cyan"},"\u23BF Getting current directory..."):e!=null&&e.success?yi.default.createElement(_i.Text,{color:"gray"},"\u23BF ",e.output):yi.default.createElement(_i.Text,{color:"red"},"\u23BF ",(e==null?void 0:e.error)||"Failed to get working directory")).execute(async(r,e)=>{let t=process.cwd();return{success:!0,output:t,data:{path:t}}}).build(),af=gg});var sn,bi,Xs,cf,Xl,uf,yg,_g,df,ff=x(()=>{sn=j(require("react"),1),bi=require("ink"),Xs=j(require("fs/promises"),1),cf=j(require("path"),1);Ee();vt();os();Xl=25e3,uf=4,yg=Xl*uf,_g=ee().id("read_file").name("Read Entire File").description(`Read an entire file to prepare for editing (max ${Xl.toLocaleString()} tokens). This tool must be used before any file editing operations.`).category("filesystem").capabilities("file:read").tags("file","read","full","edit","prepare").stringArg("path","Path to the file to read",{required:!0}).examples([{description:"Read a file before editing",arguments:{path:"src/index.ts"},result:"File read and tracked for editing"}]).execute(async(r,e)=>{var n,s,o,i,a;let{path:t}=r;(n=e.logger)==null||n.debug(`Reading entire file: ${t}`);try{let l=await Xs.stat(t);if(l.isDirectory())return(s=e.logger)==null||s.error(`Path is a directory, not a file: ${t}`),{success:!1,error:`Cannot read directory: ${t}. This tool is for files only.`};let u=l.size,c=Math.ceil(u/uf);if(u>yg){let v=(await Xs.readFile(t,"utf8")).split(`
`).length;return(o=e.logger)==null||o.error(`File too large: ${t} (${c} tokens)`),{success:!1,error:`File too large: ${c.toLocaleString()} tokens (max: ${Xl.toLocaleString()} tokens). Use view_file with start_line and end_line arguments to read specific sections. File has ${v.toLocaleString()} total lines.`}}let f=await Xs.readFile(t,"utf8"),h=f.split(`
`).length;return it.updateFile(t,f),(i=e.logger)==null||i.info(`Read entire file: ${t} (${h} lines, ~${c} tokens)`),{success:!0,output:`Successfully read ${t}`,data:{filePath:t,totalLines:h,sizeInBytes:f.length,estimatedTokens:c}}}catch(l){return(a=e.logger)==null||a.error(`Failed to read ${t}: ${l instanceof Error?l.message:String(l)}`),{success:!1,error:`Failed to read ${t}: ${l instanceof Error?l.message:String(l)}`}}}).renderResult(({isExecuting:r,result:e,arguments:t})=>{if(r)return sn.default.createElement(J,null,sn.default.createElement(bi.Text,{color:"cyan"}," Reading file..."));if(!e||!e.success)return sn.default.createElement(J,null,sn.default.createElement(bi.Text,{color:"red"}," ",(e==null?void 0:e.error)||"Failed to read file"));let n=e.data,s=(n==null?void 0:n.filePath)||t.path,o=(n==null?void 0:n.totalLines)||0;return sn.default.createElement(J,null,sn.default.createElement(bi.Text,{color:"green"}," Read ",cf.basename(s)," (",o," lines)"))}).build(),df=_g});var on,fr,xi,cs,bg,pf,mf=x(()=>{on=j(require("react"),1),fr=require("ink"),xi=j(require("fs/promises"),1),cs=j(require("path"),1);Ee();is();bg=ee().id("remove").name("Remove Files").description("Delete one or more files (requires confirmation)").category("filesystem").capabilities("file:write").tags("delete","remove","rm","unlink","filesystem").stringArg("path","File path to remove (for single file)",{required:!1}).arrayArg("paths","Array of file paths to remove (for multiple files)",{required:!1}).booleanArg("force","Skip confirmation (requires dangerously bypass permission)",{default:!1}).examples([{description:"Remove a single file",arguments:{path:"temp.txt"},result:"File removed: temp.txt"},{description:"Remove multiple files",arguments:{paths:["file1.txt","file2.txt","file3.txt"]},result:"3 files removed successfully"}]).renderResult(({isExecuting:r,result:e,arguments:t})=>{var s,o;if(r){let i=((s=t.paths)==null?void 0:s.length)||1;return on.default.createElement(fr.Text,{color:"yellow"},"\u23BF Preparing to remove ",i," file",i>1?"s":"","...")}if(!(e!=null&&e.success))return on.default.createElement(fr.Text,{color:"red"},"\u23BF ",(e==null?void 0:e.error)||"Failed to remove file(s)");let n=e.data;return(n==null?void 0:n.removedCount)>1?on.default.createElement(fr.Box,{flexDirection:"column",marginLeft:2},on.default.createElement(fr.Text,{color:"green"},"\u23BF Successfully removed ",n.removedCount," files"),(o=n.removed)==null?void 0:o.map((i,a)=>on.default.createElement(fr.Text,{key:a,color:"gray"},"  \u2022 ",i))):on.default.createElement(fr.Text,{color:"green"},"\u23BF ",e.output)}).execute(async(r,e)=>{var v,d;let{path:t,paths:n,force:s}=r;if(!t&&(!n||n.length===0))return{success:!1,error:'Either "path" or "paths" argument is required'};if(t&&n)return{success:!1,error:'Cannot specify both "path" and "paths" - use one or the other'};let o=t?[t]:n,i=[],a=[];for(let p of o)try{let _=cs.isAbsolute(p)?p:cs.join(process.cwd(),p);if((await xi.stat(_)).isDirectory())return{success:!1,error:`Cannot remove directory: ${p}. Use a different tool for directory operations.`};i.push(p)}catch{a.push(p)}if(a.length===o.length)return{success:!1,error:`No files found to remove. Missing: ${a.join(", ")}`};let l=i.length===1?`Remove file: ${i[0]}?`:`Remove ${i.length} files?`,u=i.map(p=>`\u2022 ${p}`).join(`
`);if(!s){let _=await Xe.getInstance().requestConfirmation({operation:"file_delete",filename:i.length===1?i[0]:`${i.length} files`,content:l+`

Files to remove:
`+u});if(!_.confirmed)return{success:!1,error:_.feedback||"Operation cancelled by user"}}let c=[],f=[];for(let p of i)try{let _=cs.isAbsolute(p)?p:cs.join(process.cwd(),p);await xi.unlink(_),c.push(p),(v=e.logger)==null||v.info(`Removed file: ${p}`)}catch(_){f.push(p),(d=e.logger)==null||d.error(`Failed to remove ${p}: ${_}`)}let m="";return a.length>0&&(m=`

Warning: ${a.length} file(s) not found: ${a.join(", ")}`),f.length>0?{success:!1,error:`Failed to remove ${f.length} file(s): ${f.join(", ")}`,data:{removed:c,failed:f,missing:a}}:{success:!0,output:c.length===1?`File removed: ${c[0]}${m}`:`${c.length} files removed successfully${m}`,data:{removed:c,removedCount:c.length,missing:a}}}).build(),pf=bg});var hf,wi,gf=x(()=>{hf=require("child_process");hr();wi=class{async search(e,t={}){let n=[];return t.caseSensitive||n.push("-i"),t.wholeWord&&n.push("-w"),t.regex||n.push("-F"),t.includeHidden&&n.push("--hidden"),t.fileTypes&&t.fileTypes.length>0&&t.fileTypes.forEach(s=>{n.push("-t",s)}),t.includes&&t.includes.length>0&&t.includes.forEach(s=>{n.push("--glob",s)}),t.excludes&&t.excludes.length>0&&t.excludes.forEach(s=>{n.push("--glob",`!${s}`)}),t.maxResults&&n.push("-m",t.maxResults.toString()),n.push("--json"),n.push(e),n.push("."),new Promise((s,o)=>{let i=[],a=(0,hf.spawn)("rg",n,{cwd:process.cwd()}),l="";a.stdout.on("data",u=>{l+=u.toString();let c=l.split(`
`);l=c.pop()||"";for(let f of c)if(f.trim())try{let m=JSON.parse(f);m.type==="match"&&i.push({file:m.data.path.text,line_number:m.data.line_number,lineNumber:m.data.line_number,line:m.data.lines.text,match:m.data.lines.text})}catch{}}),a.stderr.on("data",u=>{D.error("ripgrep error:",u.toString())}),a.on("close",u=>{u===0||u===1?s(i.slice(0,t.maxResults)):o(new Error(`ripgrep exited with code ${u}`))}),a.on("error",u=>{o(new Error(`Failed to start ripgrep: ${u.message}`))})})}}});async function wg(r){let e={maxResults:r.max_results,caseSensitive:r.case_sensitive,wholeWord:r.whole_word,regex:r.regex,includeHidden:r.include_hidden};r.file_types&&r.file_types.length>0&&(e.fileTypes=r.file_types),r.include_pattern&&(e.includes=[r.include_pattern]),r.exclude_pattern&&(e.excludes=[r.exclude_pattern]);let t=await _f.search(r.query,e),n=[],s=new Map;for(let o of t)s.has(o.file)||s.set(o.file,[]),s.get(o.file).push(o);for(let[o,i]of s){n.push(`
${o}:`);for(let a of i){let l=a.line_number||a.lineNumber||"?",u=a.line||a.match||"";n.push(`  ${l}: ${u.trim()}`)}}return{matches:t,formatted:n}}async function vg(r){let e=[],t=r.query.includes("*")||r.query.includes("?")||r.query.includes("{"),n=r.case_sensitive?r.query:r.query.toLowerCase();async function s(o,i=0){if(!(e.length>=r.max_results)&&!(i>20))try{let a=await yf.readdir(o,{withFileTypes:!0});for(let l of a){if(e.length>=r.max_results)break;let u=vi.join(o,l.name),c=vi.relative(process.cwd(),u);if(!r.include_hidden&&l.name.startsWith(".")||l.name==="node_modules"||l.name===".git"||l.name==="dist"||l.name==="build"||r.exclude_pattern&&Ys(c,r.exclude_pattern))continue;if(r.include_pattern&&!Ys(c,r.include_pattern)){l.isDirectory()&&await s(u,i+1);continue}let f=r.case_sensitive?l.name:l.name.toLowerCase(),m=r.case_sensitive?c:c.toLowerCase(),h=!1;t?h=Ys(l.name,r.query)||Ys(c,r.query):h=f.includes(n)||m.includes(n),h&&e.push(c),l.isDirectory()&&await s(u,i+1)}}catch{}}return await s(process.cwd()),e}function Ys(r,e){if(e.includes("{")&&e.includes("}")){let n=e.match(/\{([^}]+)\}/);if(n)return n[1].split(",").some(o=>{let i=e.replace(n[0],o);return Ys(r,i)})}let t=e.replace(/\./g,"\\.").replace(/\*\*/g,"\xA7\xA7\xA7").replace(/\*/g,"[^/]*").replace(/§§§/g,".*").replace(/\?/g,".");try{if(!e.includes("/")){let n=r.split("/").pop()||r;return new RegExp(`^${t}$`).test(n)}return new RegExp(`^${t}$`).test(r)}catch{return!1}}var pr,Bt,vi,yf,_f,xg,bf,xf=x(()=>{pr=j(require("react"),1),Bt=require("ink");gf();Ee();vi=j(require("path"),1),yf=j(require("fs/promises"),1),xg=ee().id("search").name("Unified Search Tool").description("Unified search tool for finding text content or files (similar to Cursor's search)").category("search").capabilities("file:read").tags("search","find","grep","ripgrep","rg").stringArg("query","Text to search for or file name/path pattern",{required:!0}).stringArg("search_type",'Type of search: "text" for content search, "files" for file names, "both" for both',{default:"both",enum:["text","files","both"]}).stringArg("include_pattern",'Glob pattern for files to include (e.g. "*.ts", "*.js")').stringArg("exclude_pattern",'Glob pattern for files to exclude (e.g. "*.log", "node_modules")').booleanArg("case_sensitive","Whether search should be case sensitive",{default:!1}).booleanArg("whole_word","Whether to match whole words only",{default:!1}).booleanArg("regex","Whether query is a regex pattern",{default:!1}).numberArg("max_results","Maximum number of results to return",{default:50,validate:ac.min(1)}).arrayArg("file_types",'File types to search (e.g. ["js", "ts", "py"])').booleanArg("include_hidden","Whether to include hidden files",{default:!1}).onInitialize(async r=>{var e;_f=new wi,(e=r.logger)==null||e.info("Search tool initialized with RipgrepSearch")}).execute(async(r,e)=>{var m,h,v,d,p,_,g,y;let{query:t,search_type:n="both",include_pattern:s,exclude_pattern:o,case_sensitive:i=!1,whole_word:a=!1,regex:l=!1,max_results:u=50,file_types:c,include_hidden:f=!1}=r;if(t.includes("~>")){let b=t.split("~>").map(C=>C.trim());if(b.length===2&&b[0]===""){n="files";let C=b[1].split(/\s+/).filter(E=>E);C.length>0&&(t=C[0],C.length>1&&(t=`{${C.join(",")}}`),l=!0)}}(m=e.logger)==null||m.debug(`Searching for: ${t}`),(h=e.logger)==null||h.debug(`Search type: ${n}`),(v=e.logger)==null||v.debug(`Options: case_sensitive=${i}, whole_word=${a}, regex=${l}`);try{let b=[],C=0;if(n==="text"||n==="both"){let I=await wg({query:t,case_sensitive:i,whole_word:a,regex:l,max_results:u,file_types:c,include_pattern:s,exclude_pattern:o,include_hidden:f});I.matches.length>0&&((d=e.logger)==null||d.info(`Found ${I.matches.length} text matches`),b.push("=== Text Search Results ==="),b.push(...I.formatted),C+=I.matches.length)}if(n==="files"||n==="both"){let I=await vg({query:t,case_sensitive:i,include_pattern:s,exclude_pattern:o,include_hidden:f,max_results:Math.max(0,(u||50)-C)});I.length>0&&((p=e.logger)==null||p.info(`Found ${I.length} file matches`),b.length>0&&b.push(""),b.push("=== File Search Results ==="),b.push(...I),C+=I.length)}if(b.length===0)return(_=e.logger)==null||_.info(`No matches found for query: ${t}`),{success:!0,output:"No matches found"};let E=[`Found ${C} match${C===1?"":"es"}`];return C>=u&&E.push(`(showing first ${u} results)`),(g=e.logger)==null||g.info(`Search completed: ${C} total matches`),{success:!0,output:[...E,"",...b].join(`
`)}}catch(b){return(y=e.logger)==null||y.error(`Search failed: ${b instanceof Error?b.message:String(b)}`),{success:!1,error:`Search failed: ${b instanceof Error?b.message:String(b)}`}}}).renderResult(({isExecuting:r,result:e,arguments:t})=>{var o;if(r)return pr.default.createElement(Bt.Text,{color:"cyan"},'\u23BF Searching for "',t.query,'"...');if(!(e!=null&&e.success))return pr.default.createElement(Bt.Text,{color:"red"},"\u23BF ",(e==null?void 0:e.error)||"Search failed");let n=e.data,s=((o=n==null?void 0:n.results)==null?void 0:o.length)||0;return s===0?pr.default.createElement(Bt.Text,{color:"gray"},"\u23BF No matches found"):pr.default.createElement(Bt.Box,{flexDirection:"column",marginLeft:2},pr.default.createElement(Bt.Text,{color:"gray"},"\u23BF Found ",s," match",s===1?"":"es"),n.results.slice(0,5).map((i,a)=>pr.default.createElement(Bt.Text,{key:a,color:"cyan"},"\u23BF ",i.file,i.line_number?`:${i.line_number}`:"")),s>5&&pr.default.createElement(Bt.Text,{color:"gray",italic:!0},"\u23BF ... and ",s-5," more"))}).build(),bf=xg});function kg(r,e,t){var v,d,p,_,g;let n=r.split(`
`).filter(y=>y.trim()),s=r.match(/[^.!?]+[.!?]+/g)||[],o=r.split(`

`).filter(y=>y.trim()),i=()=>s.filter(y=>y.trim().length>30).slice(0,5).map(y=>y.trim()),a=()=>{let y=[/(?:will|should|must|need(?:s)? to|have to|going to)\s+\w+/gi,/\b(?:TODO|FIXME|ACTION|TASK):\s*.+/gi,/\b(?:next steps?|action items?):\s*.+/gi];return s.filter(b=>y.some(C=>C.test(b))).map(b=>b.trim())},l=()=>{let y={},b="Overview";return n.forEach(C=>{C.match(/^#+\s+/)||C.match(/^[A-Z][^.!?]*:$/)?(b=C.replace(/^#+\s+/,"").replace(/:$/,"").trim(),y[b]=[]):C.trim()&&(y[b]||(y[b]=[]),y[b].push(C.trim()))}),y},u;if(e!=null&&e.toLowerCase().includes("action")){let y=a();u={type:"action_items",title:"Action Items Extracted",items:y.slice(0,10),count:y.length}}else if(e!=null&&e.toLowerCase().includes("section")){let y=l();u={type:"sections",title:"Document Structure",sections:Object.entries(y).slice(0,5).map(([b,C])=>({title:b,summary:C.slice(0,2).join(" ")}))}}else if(e!=null&&e.toLowerCase().includes("brief")||e!=null&&e.toLowerCase().includes("short"))u={type:"brief",title:"Brief Summary",content:s.slice(0,2).join(" ").trim()};else{let y=i(),b=a().length>0;u={type:"structured",title:"Summary",overview:((v=o[0])==null?void 0:v.substring(0,200))+(((d=o[0])==null?void 0:d.length)>200?"...":""),keyPoints:y.slice(0,3),sections:Object.keys(l()).slice(0,3),hasActionItems:b}}let c="";switch(u.type){case"action_items":c=u.items.map((b,C)=>`${C+1}. ${b}`).join(`
`);break;case"sections":c=u.sections.map((b,C)=>`${C+1}. **${b.title}**: ${b.summary}`).join(`
`);break;case"brief":c=u.content;break;case"structured":let y=[];u.overview&&y.push(`**Overview**: ${u.overview}`),((p=u.keyPoints)==null?void 0:p.length)>0&&(y.push(`
**Key Points**:`),u.keyPoints.forEach((b,C)=>{y.push(`${C+1}. ${b}`)})),((_=u.sections)==null?void 0:_.length)>0&&(y.push(`
**Sections Found**:`),u.sections.forEach((b,C)=>{y.push(`- ${b}`)})),c=y.join(`
`);break}let f=r.split(/\s+/).length,m=c.split(/\s+/).length,h=Math.round((1-m/f)*100);return(g=t.logger)==null||g.info(`Basic summary generated (${h}% compression)`),{success:!0,output:c,data:{originalLength:r.length,summaryLength:c.length,originalWords:f,summaryWords:m,compressionRatio:h,instructions:e,summaryType:u.type,summaryData:u,note:"Basic text processing (no AI)"}}}var je,Ye,Ti,wf,Tg,vf,Tf=x(()=>{je=j(require("react"),1),Ye=require("ink");Ee();vt();Tl();Ml();Ti=j(require("fs"),1),wf=j(require("path"),1),Tg=ee().id("summarize").name("Text Summarizer").description("Intelligently summarize text content into a concise, structured markdown format with numbered lists, key points, and hierarchical organization. Produces high-level overviews while preserving essential details when necessary.").category("utility").capabilities("file:read").tags("summarize","text","analysis","extract","condense").stringArg("text","The text content to summarize",{required:!1,validate:r=>r!==void 0&&typeof r!="string"?"Text must be a string":r&&r.trim().length<10?"Text must be at least 10 characters long":r&&r.trim().length>1e5?"Text must be less than 100,000 characters":!0}).stringArg("file","Path to file to summarize (alternative to text)",{required:!1,validate:r=>r!==void 0&&typeof r!="string"?"File path must be a string":!0}).stringArg("instructions",'Optional instructions for how to summarize (e.g., "focus on technical details", "extract action items", "keep it under 50 words")',{required:!1}).examples([{description:"Summarize work completed this session",arguments:{text:`REST OF MESSAGE HISTORY AS CONTEXT..... \u23FA I need to import Box in ChatContainer:

\u23FA Update(src/ui/containers/ChatContainer.tsx)
  \u23BF \xA0Updated src/ui/containers/ChatContainer.tsx with 1 addition and 1 removal
       1    import React, {useCallback, useEffect, useRef} from "react";
       2 -  import {useInput} from "ink";
       2 +  import {Box, useInput} from "ink";
       3    import {useSnapshot} from "valtio";
       4    import {GrokAgent} from "../../clanker/agent";
       5    import {ChatLayout} from "../components/chat/ChatLayout";

\u23FA Update Todos
  \u23BF \xA0\u2612 Update ChatInput to have bottom margin and be fixed         
     \u2612 Change ChatInput to have only top border spanning full width

\u23FA Bash(npm run typecheck)
  \u23BF \xA0> @ziggle/clanker@0.1.0 typecheck
     > tsc --noEmit`,instructions:"Summarize the work done in this session, focusing on code changes and tasks completed"},result:` I've successfully implemented a confirmation modal for SIGINT (Ctrl+C) with the following
  changes:

  Key Features:

  1. Exit Confirmation Modal - Created a proper modal dialog for exit confirmation
  2. Clean UI - Shows "Exit Confirmation" title with "Are you sure you want to exit?" message
  3. Two Options:
    - Cancel (secondary button) - Closes modal and clears input
    - Exit (danger button) - Exits the application

  Changes Made:

  1. Added EXIT_CONFIRMATION stage type to the stage system
  2. Created ExitConfirmationModal screen that uses the reusable Modal component
  3. Updated Ctrl+C handlers to push the exit confirmation modal instead of inline confirmation
  4. Removed old exit confirmation from StatusBar - now always shows the normal status

  User Experience:

  - When user presses Ctrl+C, a modal appears asking for confirmation
  - User can navigate with arrow keys and select with Enter/Space
  - Cancel returns to where they were with cleared input
  - Exit closes the application
  - No more "Press Ctrl+C again to exit" message in the status bar

  This provides a cleaner, more consistent user experience that follows the same pattern as other
  modals in the application.`},{description:"Summarize meeting notes extracting action items",arguments:{text:`Meeting Notes - Product Launch Review

Attendees: Sarah (PM), Mike (Dev), Lisa (Design)

Discussion:
- Sarah presented the launch timeline, targeting March 15th
- Mike mentioned the API integration is 80% complete, needs 2 more days
- Lisa showed the new UI mockups, team loved the dark mode option
- Budget concerns raised about marketing spend

Decisions:
- Approved dark mode for v1.0
- Marketing budget capped at $50k
- Beta testing starts March 1st

Next Steps:
- Mike to complete API by Friday
- Lisa to finalize icons by next week
- Sarah to recruit 20 beta testers`,instructions:"Extract only the action items and deadlines in a bullet list"},result:`\u2022 Mike: Complete API integration by Friday
\u2022 Lisa: Finalize icons by next week
\u2022 Sarah: Recruit 20 beta testers
\u2022 Team: Start beta testing March 1st
\u2022 Team: Launch product March 15th`},{description:"Technical documentation summary for quick reference",arguments:{text:`# Redis Cluster Configuration Guide

Redis Cluster provides a way to run a Redis installation where data is automatically sharded across multiple Redis nodes. Redis Cluster also provides some degree of availability during partitions.

## Minimal Requirements
- At least 3 master nodes
- Recommended: 6 nodes (3 masters, 3 replicas)
- Each node should have at least 16GB RAM
- Network latency between nodes < 2ms

## Configuration Steps
1. Install Redis on all nodes
2. Configure redis.conf with cluster-enabled yes
3. Set cluster-config-file nodes.conf
4. Define cluster-node-timeout 5000
5. Start all Redis instances
6. Use redis-cli --cluster create to form cluster
7. Verify with redis-cli --cluster check

## Important Notes
- Cluster uses hash slots (16384 total)
- Automatic failover requires majority of masters
- Cross-slot operations require special handling
- Monitor with redis-cli --cluster info`,instructions:"Create a condensed technical summary focusing on the essential setup requirements and key concepts, suitable for a DevOps quick reference card"},result:`**Redis Cluster Quick Ref**

**Min Setup**: 3 masters (recommended: 3 masters + 3 replicas), 16GB RAM/node, <2ms latency

**Config**: cluster-enabled yes, cluster-node-timeout 5000

**Commands**: redis-cli --cluster [create|check|info]

**Key Points**: 16384 hash slots, auto-failover needs majority, cross-slot ops need special handling`},{description:"Extract key insights from user research data",arguments:{text:`User Interview Summary - E-commerce Mobile App

Participant 1 (Age 28, frequent buyer):
- Loves the quick checkout feature
- Frustrated by slow image loading
- Wants better filter options
- Would pay for premium shipping

Participant 2 (Age 45, occasional buyer):
- Finds navigation confusing
- Appreciates detailed product descriptions
- Wants guest checkout option
- Price comparison feature requested

Participant 3 (Age 22, daily user):
- Uses wishlist extensively
- Wants social sharing features
- Frustrated by limited payment options
- Loves the recommendation engine

Participant 4 (Age 35, business buyer):
- Needs bulk ordering features
- Wants invoice generation
- Requires purchase approval workflow
- Appreciates order tracking

Common themes observed:
- Loading performance issues (3/4 users)
- Payment options need expansion (2/4 users)
- Navigation could be improved (2/4 users)`,instructions:"Identify the top 3 pain points and top 3 valued features based on user feedback frequency"},result:`**Top 3 Pain Points:**
1. Performance issues (slow image loading) - 75% of users
2. Limited payment options - 50% of users
3. Navigation complexity - 50% of users

**Top 3 Valued Features:**
1. Quick checkout process
2. Product recommendations
3. Order tracking/wishlist functionality`},{description:"Summarize a file with specific focus",arguments:{file:"docs/architecture.md",instructions:"Focus on the key design decisions and system components"},result:`**Key Design Decisions:**
1. Microservices architecture for scalability
2. Event-driven communication via Kafka
3. PostgreSQL for transactional data, Redis for caching

**System Components:**
- API Gateway (Kong)
- Authentication Service (OAuth2)
- Core Business Services (User, Product, Order)
- Data Pipeline (Apache Spark)
- Monitoring Stack (Prometheus/Grafana)`},{description:"Create an executive summary from a technical report",arguments:{text:`Q4 2024 Infrastructure Performance Report

Overview:
Our cloud infrastructure served 2.4 billion requests this quarter, a 40% increase from Q3. Overall uptime was 99.97%, meeting our SLA requirements.

Key Metrics:
- Average response time: 120ms (down from 145ms in Q3)
- Peak concurrent users: 1.2M (Oct 15 during flash sale)
- Data transferred: 850TB
- Cost per transaction: $0.0023 (reduced by 15%)

Incidents:
- Oct 5: 15-minute partial outage affecting EU region (faulty load balancer)
- Nov 12: 5-minute database replication lag causing stale data
- Dec 3: DDoS attack successfully mitigated, no user impact

Infrastructure Changes:
- Migrated 60% of services to Kubernetes
- Implemented new caching layer (Redis Cluster)
- Upgraded all database instances to latest version
- Added 3 new edge locations in Asia

Budget:
- Total spend: $485,000 (under budget by 8%)
- Largest cost: Compute (45%), Storage (30%), Network (25%)

Recommendations:
1. Complete Kubernetes migration by Q1 2025
2. Implement multi-region database failover
3. Investigate serverless options for variable workloads
4. Upgrade monitoring stack to reduce incident detection time`,instructions:"Create a 100-word executive summary highlighting business impact, major achievements, and critical recommendations"},result:"Q4 infrastructure handled 40% more traffic (2.4B requests) while reducing costs by 15% and improving performance (120ms avg response). Achieved 99.97% uptime despite three minor incidents. Key wins: 60% Kubernetes migration, new Redis caching layer, and 3 Asian edge locations delivered under budget ($485K). Critical recommendations: complete Kubernetes migration Q1 2025, implement multi-region database failover for resilience, and explore serverless to optimize variable workload costs. Infrastructure successfully supported business growth while improving efficiency."},{description:"Summarize code review comments for PR description",arguments:{text:`Code Review Comments for PR #1234: Implement User Authentication

Reviewer 1 (Senior Dev):
- Line 45: Password hashing should use bcrypt instead of SHA256
- Line 78: SQL injection vulnerability in login query - use parameterized queries
- Line 120: Good error handling implementation
- Line 145: Rate limiting needed on login endpoint
- Overall: Solid structure but security improvements needed

Reviewer 2 (Security Lead):
- Critical: Store sessions in Redis, not in memory
- Add CSRF token validation
- Implement account lockout after failed attempts
- Enable secure cookie flags
- Add audit logging for auth events

Reviewer 3 (Tech Lead):
- Extract validation logic to separate module
- Add unit tests for auth functions
- Update API documentation
- Consider using JWT for stateless auth
- Performance: Add database indexes for email field

Positive feedback:
- Clean code structure
- Good error messages
- Follows team naming conventions`,instructions:"Summarize as a brief PR update comment, grouping by: critical security fixes needed, suggested improvements, and positive aspects"},result:`**PR Update Summary:**

\u{1F534} **Critical Security Fixes Required:**
- Replace SHA256 with bcrypt for passwords
- Fix SQL injection vulnerability using parameterized queries
- Implement Redis session storage
- Add CSRF protection and secure cookie flags

\u{1F7E1} **Suggested Improvements:**
- Add rate limiting and account lockout
- Include audit logging
- Create unit tests and extract validation logic
- Add database indexes for performance
- Update API docs

\u2705 **Positive:** Clean structure, good error handling, follows conventions`}]).execute(async(r,e)=>{var i,a,l,u,c,f,m,h,v;let{text:t,file:n,instructions:s}=r;if(!t&&!n)return{success:!1,error:"Either text or file parameter must be provided"};if(t&&n)return{success:!1,error:"Cannot provide both text and file parameters"};let o=t||"";if(n)try{let d=wf.resolve(e.workingDirectory,n);if(!Ti.existsSync(d))return{success:!1,error:`File not found: ${n}`};o=Ti.readFileSync(d,"utf-8"),(i=e.logger)==null||i.debug(`Read file: ${d} (${o.length} characters)`)}catch(d){return{success:!1,error:`Failed to read file: ${d instanceof Error?d.message:String(d)}`}}(a=e.logger)==null||a.debug(`Summarizing text of length: ${o.length}`),s&&((l=e.logger)==null||l.debug(`Using custom instructions: ${s}`));try{let d=Gs.getInstance(),{settings:p,isValid:_}=d.loadSettings();if(!_||!p.apiKey)return(u=e.logger)==null||u.warn("No API key configured, using basic text processing"),kg(o,s,e);let g=p.provider==="custom"&&p.customBaseURL?p.customBaseURL:void 0,y=new Gn(p.apiKey,p.model,g),b=`Please summarize the following text using numbered points for key changes, findings, or items, followed by a brief overview paragraph that provides context or conclusion. Format the summary with:
1. First key point
2. Second key point
3. Third key point (etc.)

Then a paragraph explaining the overall context or outcome.

Text to summarize:
${o}`;s&&(b=`Please summarize the following text according to these instructions: ${s}

Important: Use numbered points for the main items/findings/changes, followed by a brief overview paragraph that provides context or conclusion.

Text to summarize:
${o}`),(c=e.logger)==null||c.info("Generating AI-powered summary...");let E=((m=(f=(await y.chat([{role:"user",content:b}])).choices[0])==null?void 0:f.message)==null?void 0:m.content)||"";if(!E)return{success:!1,error:"No summary generated from AI"};let I=o.split(/\s+/).length,K=E.split(/\s+/).length,G=Math.round((1-K/I)*100);return(h=e.logger)==null||h.info(`AI summary generated successfully (${G}% compression)`),{success:!0,output:E,data:{originalLength:o.length,summaryLength:E.length,originalWords:I,summaryWords:K,compressionRatio:G,instructions:s,summaryType:"ai_generated",source:n?`file: ${n}`:"text input"}}}catch(d){return(v=e.logger)==null||v.error(`Summarization failed: ${d instanceof Error?d.message:String(d)}`),{success:!1,error:`Failed to summarize: ${d instanceof Error?d.message:String(d)}`}}}).renderResult(({isExecuting:r,result:e})=>{if(r)return je.default.createElement(J,null,je.default.createElement(Ye.Text,{color:"cyan"}," Generating summary..."));if(!e)return null;if(!e.success)return je.default.createElement(J,null,je.default.createElement(Ye.Text,{color:"red"}," ",e.error||"Summarization failed"));let t=e.data,n=e.output||"",o=((t==null?void 0:t.summaryType)||"unknown")==="ai_generated";return je.default.createElement(Te,null,je.default.createElement(Ye.Box,{flexDirection:"column"},je.default.createElement(Ye.Box,{flexDirection:"column"},n.split(`
`).map((i,a)=>{if(i.trim()==="")return je.default.createElement(Ye.Text,{key:a}," ");let l=/\*\*(.*?)\*\*/g,u=i.split(l);return je.default.createElement(Ye.Text,{key:a},u.map((c,f)=>f%2===1?je.default.createElement(Ye.Text,{key:f,bold:!0},c):je.default.createElement(Ye.Text,{key:f},c)))})),je.default.createElement(Ye.Box,{marginTop:1},je.default.createElement(Ye.Text,{color:"gray",dimColor:!0},t==null?void 0:t.originalWords," words \u2192 ",t==null?void 0:t.summaryWords," words (",t==null?void 0:t.compressionRatio,"% reduction)"))))}).build();vf=Tg});function Ag(){if(Y.length===0)return"No todos";let r={pending:Y.filter(s=>s.status==="pending"),in_progress:Y.filter(s=>s.status==="in_progress"),completed:Y.filter(s=>s.status==="completed")},e=[],t=[...r.pending,...r.in_progress].filter(s=>s.priority==="high").sort((s,o)=>s.status==="in_progress"&&o.status!=="in_progress"?-1:s.status!=="in_progress"&&o.status==="in_progress"?1:0);t.length>0&&(e.push("\u{1F534} High Priority:"),t.forEach(s=>{let o=s.status==="in_progress"?"\u{1F504}":"\u23F3";e.push(`  ${o} [${s.id}] ${s.content}`)}),e.push(""));let n=[...r.pending,...r.in_progress].filter(s=>s.priority!=="high").sort((s,o)=>s.priority==="medium"&&o.priority==="low"?-1:s.priority==="low"&&o.priority==="medium"?1:s.status==="in_progress"&&o.status!=="in_progress"?-1:s.status!=="in_progress"&&o.status==="in_progress"?1:0);return n.length>0&&(e.push("\u{1F4CB} Other Tasks:"),n.forEach(s=>{let o=s.status==="in_progress"?"\u{1F504}":"\u23F3",i=s.priority==="medium"?"\u{1F7E1}":"\u{1F7E2}";e.push(`  ${o} ${i} [${s.id}] ${s.content}`)}),e.push("")),r.completed.length>0&&(e.push(`\u2705 Completed (${r.completed.length}):`),r.completed.slice(0,5).forEach(s=>{e.push(`  \u2713 [${s.id}] ${s.content}`)}),r.completed.length>5&&e.push(`  ... and ${r.completed.length-5} more`)),e.push(""),e.push(`Total: ${Y.length} | Pending: ${r.pending.length} | In Progress: ${r.in_progress.length} | Completed: ${r.completed.length}`),e.join(`
`)}var le,we,Sg,Cg,kf,Af=x(()=>{le=j(require("react"),1),we=require("ink");Ee();vt();mi();Sg=({toolName:r,arguments:e,result:t,isExecuting:n})=>{var u;if(n)return le.default.createElement(J,null,le.default.createElement(we.Text,{color:"cyan"}," Updating todo list..."));if(!t||!t.success)return le.default.createElement(J,null,le.default.createElement(we.Text,{color:"red"}," Error: ",(t==null?void 0:t.error)||"Unknown error"));let s=((u=t.data)==null?void 0:u.todos)||[];if(s.length===0)return le.default.createElement(J,null,le.default.createElement(we.Text,{color:"gray"}," No todos"));let o=[],i={pending:s.filter(c=>c.status==="pending"),in_progress:s.filter(c=>c.status==="in_progress"),completed:s.filter(c=>c.status==="completed")},a=[...i.pending,...i.in_progress].filter(c=>c.priority==="high").sort((c,f)=>c.status==="in_progress"&&f.status!=="in_progress"?-1:c.status!=="in_progress"&&f.status==="in_progress"?1:0);a.length>0&&a.forEach(c=>{o.push(le.default.createElement(we.Box,{key:`todo-${c.id}`},le.default.createElement(we.Text,{color:c.status==="in_progress"?"cyan":"yellow"},c.status==="in_progress"?"  \u25D0 ":"  \u25CB "),le.default.createElement(we.Text,{color:"white"},c.content),le.default.createElement(we.Text,{color:"red"}," \u25CF")))});let l=[...i.pending,...i.in_progress].filter(c=>c.priority!=="high").sort((c,f)=>c.priority==="medium"&&f.priority==="low"?-1:c.priority==="low"&&f.priority==="medium"?1:c.status==="in_progress"&&f.status!=="in_progress"?-1:c.status!=="in_progress"&&f.status==="in_progress"?1:0);return l.length>0&&l.forEach(c=>{let f=c.priority==="medium"?"yellow":"green";o.push(le.default.createElement(we.Box,{key:`todo-${c.id}`},le.default.createElement(we.Text,{color:c.status==="in_progress"?"cyan":"gray"},c.status==="in_progress"?"  \u25D0 ":"  \u25CB "),le.default.createElement(we.Text,{color:"white"},c.content),le.default.createElement(we.Text,{color:f}," \u25CF")))}),i.completed.length>0&&(i.completed.slice(0,3).forEach(c=>{o.push(le.default.createElement(we.Box,{key:`todo-${c.id}`},le.default.createElement(we.Text,{color:"green"},"  \u25CF "),le.default.createElement(we.Text,{color:"gray",dimColor:!0},c.content)))}),i.completed.length>3&&o.push(le.default.createElement(we.Box,{key:"more-completed"},le.default.createElement(we.Text,{color:"gray"},"  ... and ",i.completed.length-3," more completed")))),le.default.createElement(Te,null,le.default.createElement(we.Box,{flexDirection:"column"},o))},Cg=ee().id("update_todo_list").name("Update Todo List").description("Update existing todos in the todo list").category("task").tags("todo","task","update","modify").arrayArg("updates","Array of todo updates",{required:!0,validate:r=>{if(!Array.isArray(r))return"Updates must be an array";for(let e of r){if(!e||typeof e!="object")return"Each update must be an object";let t=e;if(!t.id||typeof t.id!="string")return"Each update must have a string id";if(t.status&&!["pending","in_progress","completed"].includes(t.status))return"Status must be pending, in_progress, or completed";if(t.priority&&!["high","medium","low"].includes(t.priority))return"Priority must be high, medium, or low";if(t.content&&typeof t.content!="string")return"Content must be a string"}return!0}}).renderResult(Sg).examples([{description:"Mark a todo as completed",arguments:{updates:[{id:"1",status:"completed"}]},result:"Updated 1 todo(s): 1"},{description:"Update multiple todos - mark one as in progress and another as completed",arguments:{updates:[{id:"1",status:"in_progress"},{id:"2",status:"completed",priority:"high"}]},result:"Updated 2 todo(s): 1, 2"},{description:"Change todo content and priority",arguments:{updates:[{id:"1",content:"Read and understand all project files",priority:"high"}]},result:"Updated 1 todo(s): 1"}]).execute(async(r,e)=>{var i,a,l,u;let{updates:t}=r;(i=e.logger)==null||i.debug(`Updating ${t.length} todo items`);let n=[],s=[];for(let c of t){let f=Y.findIndex(m=>m.id===c.id);if(f===-1){(a=e.logger)==null||a.warn(`Todo not found: ${c.id}`),s.push(c.id);continue}c.status&&(Y[f].status=c.status),c.priority&&(Y[f].priority=c.priority),c.content&&(Y[f].content=c.content),n.push(c.id),(l=e.logger)==null||l.debug(`Updated todo ${c.id}`)}let o=[];return n.length>0&&o.push(`Updated ${n.length} todo(s): ${n.join(", ")}`),s.length>0&&o.push(`Todo(s) not found: ${s.join(", ")}`),o.length===0&&o.push("No updates performed"),o.push(""),o.push("Current todo list:"),o.push(Ag()),(u=e.logger)==null||u.info(`Todo update completed: ${n.length} updated, ${s.length} not found`),{success:s.length===0,output:o.join(`
`),data:{todos:Y,updated:n,notFound:s}}}).build(),kf=Cg});var Ve,at,us,Qs,Yl,Eg,Sf,Cf=x(()=>{Ve=j(require("react"),1),at=require("ink"),us=j(require("fs/promises"),1),Qs=j(require("path"),1);Ee();is();vt();os();Eg=ee().id("write_to_file").name("Write to File").description("Write complete content to a file (create new or overwrite existing)").category("filesystem").capabilities("file:write","user:confirmation").tags("file","write","create","overwrite").stringArg("path","Path where the file should be written",{required:!0}).stringArg("content","Complete content to write to the file",{required:!0}).booleanArg("create_only","Fail if file already exists (default: false)",{default:!1}).examples([{description:"Create a new file",arguments:{path:"src/hello.ts",content:"console.log('Hello, world!');"},result:"Creates hello.ts with the provided content"},{description:"Overwrite existing file",arguments:{path:"README.md",content:`# New Content
This replaces the entire file.`},result:"Overwrites README.md with new content"},{description:"Create only (fail if exists)",arguments:{path:"config.json",content:"{}",create_only:!0},result:"Creates config.json only if it doesn't exist"}]).onInitialize(async r=>{var e;Yl=Xe.getInstance(),(e=r.logger)==null||e.debug("Write to File tool initialized")}).execute(async(r,e)=>{var o,i,a,l,u,c,f;let{path:t,content:n,create_only:s}=r;(o=e.logger)==null||o.debug(`Writing to file: ${t}`),(i=e.logger)==null||i.debug(`Content length: ${n.length} bytes`),(a=e.logger)==null||a.debug(`Create only: ${s}`);try{let m=!1,h="";try{h=await us.readFile(t,"utf8"),m=!0}catch{m=!1}if(s&&m)return(l=e.logger)==null||l.warn(`File ${t} already exists (create_only=true)`),{success:!1,error:`File already exists: ${t}. Set create_only to false to overwrite.`};let v=Yl.getSessionFlags();if(!v.createFiles&&!v.allOperations){let _=m?"Overwrite file":"Create file",g=m?`WARNING: This will OVERWRITE the existing file!

Existing content (first 500 chars):
${h.slice(0,500)}${h.length>500?"...":""}

`:"",y=await Yl.requestConfirmation({operation:_,filename:t,content:`${g}New content (first 500 chars):
${n.slice(0,500)}${n.length>500?"...":""}`},"file_create");if(!y.confirmed)return(u=e.logger)==null||u.info("File write cancelled by user"),{success:!1,error:y.feedback||"File write cancelled by user"}}let d=Qs.dirname(t);await us.mkdir(d,{recursive:!0}),await us.writeFile(t,n,"utf8"),it.updateFile(t,n);let p=m?`Successfully overwrote file: ${t}`:`Successfully created file: ${t}`;return(c=e.logger)==null||c.info(p),{success:!0,output:p,data:{filePath:t,fileExists:m,contentLength:n.length,lines:n.split(`
`).length}}}catch(m){return(f=e.logger)==null||f.error(`Failed to write file: ${m instanceof Error?m.message:String(m)}`),{success:!1,error:`Failed to write file: ${m instanceof Error?m.message:String(m)}`}}}).renderResult(({isExecuting:r,result:e,arguments:t})=>{if(r)return Ve.default.createElement(J,null,Ve.default.createElement(at.Text,{color:"cyan"}," Writing file..."));if(!e||!e.success)return Ve.default.createElement(J,null,Ve.default.createElement(at.Text,{color:"red"}," ",(e==null?void 0:e.error)||"Failed to write file"));let n=e.data,s=(n==null?void 0:n.filePath)||t.path,o=n!=null&&n.fileExists?"Overwrote":"Created";return Ve.default.createElement(Te,null,Ve.default.createElement(at.Box,{flexDirection:"column"},Ve.default.createElement(at.Box,null,Ve.default.createElement(at.Text,{color:"green"},"\u2713 ",o," "),Ve.default.createElement(at.Text,{color:"cyan",bold:!0},Qs.basename(s)),Ve.default.createElement(at.Text,{color:"gray"}," in "),Ve.default.createElement(at.Text,{color:"gray",dimColor:!0},Qs.dirname(s),"/")),(n==null?void 0:n.lines)&&Ve.default.createElement(at.Text,{color:"gray",dimColor:!0},n.lines," lines \u2022 ",n.contentLength," bytes")))}).build(),Sf=Eg});var Ql={};hs(Ql,{builtInTools:()=>Ef,builtInToolsMap:()=>$g});var Ef,$g,ec=x(()=>{Ud();mi();Gd();Kd();Xd();of();lf();ff();mf();xf();Tf();Af();$f();Cf();Ef=[jd,Wd,Vd,Zd,Jd,sf,af,df,pf,bf,vf,kf,tc,Sf],$g=new Map(Ef.map(r=>[r.id,r]))});async function Rf(){let r=[];try{let e;if(typeof __dirname<"u")e=__dirname;else if(typeof If.url<"u"){let o=(0,Pf.fileURLToPath)(If.url);e=jt.dirname(o)}else e=process.cwd();let t=jt.join(e,"tool-manifest.json");if(eo.existsSync(t)||(t=jt.join(e,"..","..","dist","tool-manifest.json")),D.log(`[ManifestLoader] Looking for manifest at: ${t}`),!eo.existsSync(t)){D.warn("[ManifestLoader] No tool manifest found, falling back to static imports");let{builtInTools:o}=await Promise.resolve().then(()=>(ec(),Ql));return o}let n=eo.readFileSync(t,"utf-8"),s=JSON.parse(n);D.log(`[ManifestLoader] Found manifest with ${s.tools.length} tools`);for(let o of s.tools)try{let i=jt.isAbsolute(o.module)?o.module:jt.join(jt.dirname(t),o.module);D.log(`[ManifestLoader] Loading tool ${o.id} from ${i}`);let a=await import(i),l=a.default||a;Ig(l)?(r.push(l),D.log(`[ManifestLoader] Successfully loaded tool: ${l.id}`)):D.warn(`[ManifestLoader] Invalid tool in ${i}`)}catch(i){D.error(`[ManifestLoader] Failed to load tool ${o.id}:`,i)}return D.log(`[ManifestLoader] Loaded ${r.length} tools from manifest`),r}catch(e){D.error("[ManifestLoader] Error loading manifest:",e);let{builtInTools:t}=await Promise.resolve().then(()=>(ec(),Ql));return t}}function Ig(r){return r&&typeof r=="object"&&typeof r.id=="string"&&typeof r.description=="string"&&typeof r.execute=="function"}var eo,jt,Pf,If,Of=x(()=>{eo=j(require("fs"),1),jt=j(require("path"),1),Pf=require("url");hr();If={}});function td(r,e){return new nc(r,e)}var lt,Tt,Ff,ki,rc,nc,Mf=x(()=>{lt=j(require("fs/promises"),1),Tt=j(require("path"),1),Ff=j(require("os"),1),ki=require("url");hr();Of();rc={},nc=class{constructor(r,e={}){this.registry=r;this.loadedTools=new Map;this.watcherCleanup=[];let t=Ff.homedir(),n=Tt.join(t,".clanker");this.options={directories:e.directories||[process.cwd(),n],recursive:e.recursive??!0,extensions:e.extensions||[".ts",".tsx",".js",".jsx"],watch:e.watch??!1,loadBuiltins:e.loadBuiltins??!0},D.log("[ToolLoader] Configured directories:",this.options.directories)}async loadTools(){this.options.loadBuiltins&&await this.loadBuiltinTools();for(let r of this.options.directories){let e=Tt.join(r,r.endsWith("tools")?"":"tools");D.log(`[ToolLoader] Loading from directory: ${r} -> ${e}`),await this.loadFromDirectory(e)}this.options.watch&&await this.setupWatchers()}async loadBuiltinTools(){try{let r=await Rf();D.log(`[ToolLoader] Loading ${r.length} built-in tools`);for(let e of r)this.isValidTool(e)?(this.registry.register(e),this.loadedTools.set(e.id,`builtin:${e.id}`),D.log(`[ToolLoader] Loaded built-in tool: ${e.id}`)):D.warn("[ToolLoader] Invalid built-in tool");D.log(`[ToolLoader] Successfully loaded ${r.length} built-in tools`)}catch(r){D.warn("[ToolLoader] Failed to load built-in tools:",r)}}async loadFromDirectory(r){if(!await this.exists(r)){D.log(`[ToolLoader] Directory does not exist: ${r}`);return}D.log(`[ToolLoader] Scanning directory: ${r}`);try{await this.scanDirectory(r,this.options.recursive)}catch(e){D.error(`[ToolLoader] Error scanning directory ${r}:`,e)}}async scanDirectory(r,e){let t;try{t=await lt.readdir(r,{withFileTypes:!0})}catch{return}if(t.find(i=>i.name==="current"&&i.isSymbolicLink())){let i=Tt.join(r,"current","index.js");if(await this.exists(i)){D.log(`[ToolLoader] Found package-managed tool at ${i}`),await this.loadToolFile(i);return}}let s=t.filter(i=>i.isFile()&&this.isToolFile(i.name)).map(i=>Tt.join(r,i.name));D.log(`[ToolLoader] Found ${s.length} tool files in ${r}`);for(let i of s)await this.loadToolFile(i);if(!e)return;let o=t.filter(i=>i.isDirectory()).map(i=>Tt.join(r,i.name));for(let i of o)await this.scanDirectory(i,!0)}async loadToolFile(r){try{D.log(`[ToolLoader] Attempting to load: ${r}`);let e=await this.importModule(r);D.log(`[ToolLoader] Module exports for ${r}:`,Object.keys(e));let t=await this.extractTool(e);if(!t){D.warn(`[ToolLoader] No valid tool found in ${r}`);return}if(D.log("[ToolLoader] Extracted tool:",{id:t.id,name:t.name}),!this.isValidTool(t)){D.warn(`[ToolLoader] Invalid tool in ${r}`);return}this.loadedTools.has(t.id)&&await this.registry.unregister(t.id),this.registry.register(t),this.loadedTools.set(t.id,r),D.log(`[ToolLoader] Loaded tool: ${t.id} from ${r}`)}catch(e){D.error(`[ToolLoader] Failed to load ${r}:`,e)}}async importModule(filePath){try{if(filePath.endsWith(".js")){try{let{createRequire:r}=await import("module"),e=typeof rc<"u"&&rc.url?rc.url:(0,ki.pathToFileURL)(process.cwd()+"/").href,t=r(e);delete t.cache[filePath];let n=t(filePath);return D.log(`[ToolLoader] Loaded ${filePath} using createRequire`),n}catch(r){D.log(`[ToolLoader] createRequire failed for ${filePath}:`,r)}try{let requireFunc=eval("require");delete requireFunc.cache[filePath];let module=requireFunc(filePath);return D.log(`[ToolLoader] Loaded ${filePath} using direct require`),module}catch(r){D.log(`[ToolLoader] Direct require failed for ${filePath}:`,r)}try{let e=await import((0,ki.pathToFileURL)(filePath).href);return D.log(`[ToolLoader] Loaded ${filePath} using dynamic import`),e}catch(r){D.log(`[ToolLoader] Dynamic import failed for ${filePath}:`,r)}}let fileUrl=(0,ki.pathToFileURL)(filePath).href,module=await import(fileUrl);return module}catch(r){throw D.error(`[ToolLoader] Import error for ${filePath}:`,r),r}}async extractTool(r){if(r.default){let t=r.default;if(typeof t=="function")try{let n=await t();if(this.isValidTool(n))return n}catch{if(this.isValidTool(t))return t}if(this.isValidTool(t))return t;if(Array.isArray(t)&&t.length>0){let n=t[0];if(this.isValidTool(n))return n}}let e=["tool","createTool"];for(let t of e)if(t in r){let n=r[t];if(typeof n=="function")try{let s=await n();if(this.isValidTool(s))return s}catch{}if(this.isValidTool(n))return n}return this.isValidTool(r)?r:null}isValidTool(r){return r&&typeof r=="object"&&typeof r.id=="string"&&typeof r.description=="string"&&typeof r.execute=="function"}isToolFile(r){return this.options.extensions.some(e=>r.endsWith(e))}async exists(r){try{return await lt.access(r),!0}catch{return!1}}async setupWatchers(){let{watch:r}=await import("fs");for(let e of this.options.directories){let t=Tt.join(e,e.endsWith("tools")?"":"tools");if(!await this.exists(t))continue;let n=r(t,{recursive:!0},async(s,o)=>{if(!o||!this.isToolFile(o))return;let i=Tt.join(t,o);try{(await lt.stat(i)).isFile()&&(D.log(`[ToolLoader] Reloading ${o}...`),await this.loadToolFile(i))}catch{let a=this.findToolByPath(i);a&&(await this.registry.unregister(a),this.loadedTools.delete(a),D.log(`[ToolLoader] Unregistered ${a}`))}});this.watcherCleanup.push(()=>n.close())}}findToolByPath(r){for(let[e,t]of this.loadedTools.entries())if(t===r)return e}getLoadedTools(){return Array.from(this.loadedTools.entries()).map(([r,e])=>({toolId:r,filePath:e}))}async reloadTools(){D.log("[ToolLoader] Reloading all tools...");let r=new Map(this.loadedTools);this.loadedTools.clear();for(let[e,t]of r)await this.loadToolFile(t)}async cleanup(){for(let r of this.watcherCleanup)r();this.watcherCleanup=[],this.loadedTools.clear()}static async createToolTemplate(r,e=process.cwd()){let t=Tt.join(e,".clank","tools");await lt.mkdir(t,{recursive:!0});let n=`${r}.ts`,s=Tt.join(t,n);try{throw await lt.access(s),new Error(`Tool file already exists: ${s}`)}catch(i){if(i.code!=="ENOENT")throw i}let o=`/**
 * ${r} tool
 * 
 * This is a template for creating a custom tool.
 * Edit this file to implement your tool's functionality.
 */

import { createTool, ToolCategory, ToolCapability } from '@ziggle/clanker';

// Using the builder API
export default createTool()
  .id('${r}')
  .name('${r.charAt(0).toUpperCase()+r.slice(1)} Tool')
  .description('Description of what this tool does')
  .category(ToolCategory.Utility)
  .capabilities(ToolCapability.FileRead)
  .tags('custom', 'example')
  
  // Define arguments
  .stringArg('input', 'Input value', { required: true })
  .booleanArg('verbose', 'Enable verbose output', { default: false })
  
  // Define the execution logic
  .execute(async (args, context) => {
    const { input, verbose } = args;
    
    if (verbose) {
      context.logger?.debug('Processing input:', input);
    }
    
    // Your tool logic here
    const result = \`Processed: \${input}\`;
    
    return {
      success: true,
      output: result,
      data: { processed: result }
    };
  })
  .build();
`;await lt.writeFile(s,o,"utf-8"),D.log(`Created tool template: ${s}`)}}});var Ee=x(()=>{ao();vd();Td();Ii();kd();lo();Mf();jl()});var Rg={};hs(Rg,{default:()=>tc});module.exports=Hf(Rg);var ue,Pe,ds,fs,Qe,Ai,Df,Lf,Pg,tc,$f=x(()=>{ue=j(require("react"),1),Pe=require("ink"),ds=j(require("fs/promises"),1),fs=j(require("path"),1);Ee();vt();Hl();os();Qe=100,Ai=25e3,Df=4,Lf=Ai*Df,Pg=ee().id("view_file").name("View File or Directory").description(`View contents of a file or list directory contents (max ${Ai.toLocaleString()} tokens)`).category("filesystem").capabilities("file:read").tags("file","read","view","directory","list").stringArg("path","Path to file or directory to view",{required:!0}).numberArg("start_line",`Starting line number (1-based). If provided without end_line, shows from this line to end of file or max ${Qe} lines`,{required:!1,validate:r=>r>=1||"Start line must be at least 1"}).numberArg("end_line",`Ending line number (inclusive). If provided, shows lines from start_line to end_line, max ${Qe} lines total`,{required:!1,validate:r=>r>=1||"End line must be at least 1"}).examples([{description:`View entire file (up to ${Qe} lines and ${Ai.toLocaleString()} tokens)`,arguments:{path:"src/index.ts"},result:"Shows the file content with syntax highlighting"},{description:"View specific line range",arguments:{path:"src/app.tsx",start_line:50,end_line:100},result:"Shows lines 50-100 of the file"},{description:"View from a line to end of file",arguments:{path:"package.json",start_line:20},result:`Shows from line 20 to end (max ${Qe} lines)`}]).execute(async(r,e)=>{var o,i,a,l,u,c,f;let{path:t,start_line:n,end_line:s}=r;(o=e.logger)==null||o.debug(`Viewing path: ${t}`),n&&s&&((i=e.logger)==null||i.debug(`Line range: ${n}-${s}`));try{if((await ds.stat(t)).isDirectory()){let h=await ds.readdir(t,{withFileTypes:!0}),v=h.sort((d,p)=>d.isDirectory()&&!p.isDirectory()?-1:!d.isDirectory()&&p.isDirectory()?1:d.name.localeCompare(p.name)).map(d=>`[${d.isDirectory()?"DIR":"FILE"}] ${d.name}`).join(`
`);return(a=e.logger)==null||a.info(`Listed directory: ${t} (${h.length} entries)`),{success:!0,output:`Contents of ${t}:
${v}`,data:{type:"directory",files:h.map(d=>d.name+(d.isDirectory()?"/":""))}}}else{let h=await ds.readFile(t,"utf8"),v=h.split(`
`),d=v.length,p=0,_=d;n&&s?(p=Math.max(0,Math.min(n-1,d-1)),_=Math.max(p+1,Math.min(s,d)),_-p>Qe&&(_=p+Qe,(l=e.logger)==null||l.warn(`Requested ${s-n+1} lines, limiting to ${Qe}`))):n?(p=Math.max(0,Math.min(n-1,d-1)),_=Math.min(d,p+Qe)):d>Qe&&(_=Qe);let g=v.slice(p,_),y=g.join(`
`),b=Math.ceil(y.length/Df);if(y.length>Lf)return(u=e.logger)==null||u.error(`Selected content too large: ${b} tokens`),{success:!1,error:`Selected content too large: ${b.toLocaleString()} tokens (max: ${Ai.toLocaleString()} tokens). Please use a smaller line range. Requested lines ${p+1}-${_} would return ${g.length} lines.`};let C=g.map((I,K)=>`${p+K+1}: ${I}`).join(`
`),E="";return p>0||_<d?E=` (lines ${p+1}-${_} of ${d})`:d>Qe&&(E=` (showing first ${Qe} of ${d} lines)`),(c=e.logger)==null||c.info(`Read file: ${t}${E} (~${b} tokens)`),h.length<=Lf&&it.updateFile(t,h),{success:!0,output:`File: ${t}${E}:
${C}`,data:{type:"file",totalLines:d,displayedLines:g.length,startLine:p+1,endLine:_,truncated:_<d,estimatedTokens:b}}}}catch(m){return(f=e.logger)==null||f.error(`Failed to read ${t}: ${m instanceof Error?m.message:String(m)}`),{success:!1,error:`Failed to read ${t}: ${m instanceof Error?m.message:String(m)}`}}}).renderResult(({isExecuting:r,result:e,arguments:t})=>{var p;if(r)return ue.default.createElement(J,null,ue.default.createElement(Pe.Text,{color:"cyan"}," Reading file..."));if(!e||!e.success)return ue.default.createElement(J,null,ue.default.createElement(Pe.Text,{color:"red"}," ",(e==null?void 0:e.error)||"Failed to read file"));let n=t.path,s=e.output||"";if(((p=e.data)==null?void 0:p.type)==="directory"){let g=e.data.files||[];return g.length===0?ue.default.createElement(J,null,ue.default.createElement(Pe.Text,{color:"gray"}," Empty directory")):ue.default.createElement(Te,null,ue.default.createElement(Pe.Box,{flexDirection:"column"},g.map((y,b)=>ue.default.createElement(Pe.Text,{key:b,color:y.endsWith("/")?"cyan":"white"},y))))}let i=s.split(`
`);i[0]&&i[0].startsWith("File: ")&&(i=i.slice(1));let a=1;if(i.length>0&&/^\d+:\s/.test(i[0])){let _=i[0].match(/^(\d+):\s/);_&&(a=parseInt(_[1],10)),i=i.map(g=>{let y=g.match(/^\d+:\s(.*)$/);return y?y[1]:g})}let u=e.data,c=(u==null?void 0:u.totalLines)||i.length,f=(u==null?void 0:u.startLine)||a,m=(u==null?void 0:u.endLine)||f+i.length-1,h=(u==null?void 0:u.startLine)&&u.startLine>1,v=(u==null?void 0:u.truncated)||!1,d=fs.extname(n).slice(1)||"text";return ue.default.createElement(Te,null,ue.default.createElement(Pe.Box,{flexDirection:"column"},ue.default.createElement(Pe.Box,{marginBottom:1,flexDirection:"column"},ue.default.createElement(Pe.Box,null,ue.default.createElement(Pe.Text,{color:"cyan",bold:!0},fs.basename(n)),ue.default.createElement(Pe.Text,{color:"gray"}," \u2022 "),ue.default.createElement(Pe.Text,{color:"gray",dimColor:!0},fs.dirname(n),"/")),ue.default.createElement(Pe.Text,{color:"gray",dimColor:!0},c," lines",h?` (showing lines ${f}-${m})`:v?` (showing first ${i.length} lines)`:""," \u2022 ",d||"plain text")),ue.default.createElement(pi,{content:i.join(`
`),language:d,showLineNumbers:!0,startLineNumber:f}),v&&ue.default.createElement(Pe.Box,{marginTop:1},ue.default.createElement(Pe.Text,{color:"yellow",dimColor:!0},"... ",c-m," more lines"))))}).build(),tc=Pg});$f();
/*! Bundled license information:

prismjs/prism.js:
  (**
   * Prism: Lightweight, robust, elegant syntax highlighting
   *
   * @license MIT <https://opensource.org/licenses/MIT>
   * @author Lea Verou <https://lea.verou.me>
   * @namespace
   * @public
   *)
*/


// Ensure the tool is exported
if (typeof module !== 'undefined' && module.exports && module.exports.default) {
  module.exports = module.exports.default;
}
